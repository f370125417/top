!function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){r(2),function(e){try{window.console=r(3)}catch(t){}try{e.sohu_mp={env:r(4),article_column:r(5)}}catch(t){throw console.log("初始化代码错误"),t}}(window)},,function(e,t){},function(e,t){for(var r=function(){},i=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],n=i.length,a={};n--;)method=i[n],a[method]||(a[method]=r);e.exports=a},function(e,t){e.exports="prod"},function(e,t,r){function i(){var e=/\/\/www.sohu.com/g,t=/pre.beta.www.sohu.com/g;return!e.test(window.location.href)&&!t.test(window.location.href)}var n=r(6),a=r(12),s=r(15),o=r(18),l=r(20),d=r(23),c=r(24),u=r(34),h=r(35),f=r(36),p=r(37),g=r(8),m=r(38);e.exports=function(e){p(e.channel_id),e.test=i();new a({el:$("#kuaixun"),test:e.test,sceneId:e.channel_id,model:new n({scene:"CHANNEL",test:e.test,sceneId:e.channel_id,channel_id:e.channel_id})});new s({el:$("#search"),scene:"ARTICLE",channel_id:e.channel_id,d_val:$("#news-recommend-nav").find("ul li").eq(1).text()});var t=(new l({el:$("#hot-new-lists"),test:e.test,fresh:".recommend-fresh",code:null,recommendNum:".recommend-num",model:new o({regionId:g.recommendAd,test:e.test,scene:"CHANNEL",channel_id:e.channel_id,sceneId:e.channel_id})}),new f);new c({el:$("#relate-recommend"),test:e.test,model:new d({scene:"CHANNEL",channel_id:$("article").attr("data-channel"),test:e.test,mainEl:$("#article-region")})});new m({el:"#mp-editor",LazyLoad:t,data:{newsId:e.news_id,mediaId:e.media_id}}),$("iframe").each(function(){/v\.qq\.com\/iframe\/preview/gi.test(this.src)&&(this.src=this.src.replace(/preview/gi,"player"),this.width="500",this.height="375"),$(this).addClass("center-iframe")}),new u({el:$("#news-recommend-nav"),activeClass:"column-each-active",feedEl:$("#hot-new-lists"),test:e.test,callBackFun:function(t,r){new l({el:$("#hot-new-lists"),fresh:".recommend-fresh",code:r,recommendNum:".recommend-num",model:new o({regionId:t,test:e.test,scene:"CHANNEL",sceneId:e.channel_id})})}}).init(),new h({el:$("article")})}},function(e,t,r){var i=r(7),n=r(8),a=r(9),s=r(10),o=r(11),l=a.get("SUV")||"",d=l+"_"+(new Date).getTime(),c=window.encodeURIComponent(document.referrer.substring(0,250))||"";e.exports=i.extend({init:function(e){this.test=e.test||!1,this.scene=e&&e.scene||"HOMEPAGE",this.sceneId=e&&e.sceneId||0,this.news_id=e&&e.news_id,this.channel_id=e&&e.channel_id||0,this.regionId=n.kuaixunAd},fetch:function(){var e=this;this.url="//v2.sohu.com/integration-api/mix/region/"+this.regionId,this.test&&(this.url="//d1.m.sohu.com/integration-api/mix/region/"+this.regionId);var t=s(),r=o("spm"),n={SUV:l,pvId:t,page:1,size:5,mpId:this.news_id,adapter:"pcArticleNew",requestId:d,refer:c,spm:r,channel:this.channel_id};i.prototype.fetch.call(this,{data:n,success:function(t,r){try{t.length<1?e.trigger("empty"):e.trigger("sync",t)}catch(i){e.trigger("error")}}})}})},function(e,t){var r=function(){this.url="",this._ev_callback={},this.init.apply(this,arguments)};r.prototype={init:function(){},fetch:function(e){var t=e&&e.data,r=e&&e.success||function(e){this.attrs=e,n.trigger("sync",this.attrs)},i=/\/\//g.test(this.url)?this.url:"//v2.sohu.com/public-api/"+this.url,n=this;$.ajax({url:i,data:t,method:e.method||"GET",dataType:e.dataType||"jsonp",success:r,error:function(){n.trigger("error",arguments)}})},on:function(e,t){this._ev_callback[e]=this._ev_callback[e]||[],this._ev_callback[e].push({fn:t})},one:function(e,t){this._ev_callback[e]=this._ev_callback[e]||[],this._ev_callback[e].push({fn:t,one:!0})},trigger:function(e,t){var r=this,i=[];this._ev_callback[e]&&this._ev_callback[e].forEach(function(e){e.one&&i.push(e.fn),e.fn&&e.fn.call(r,t)}),i&&i.forEach(function(t){r.off(e,t)})},off:function(e,t){this._ev_callback[e]=this._ev_callback[e]||[];var r=-1;this._ev_callback[e].forEach(function(e,i){e.fn===t&&(r=i)}),r>=0&&this._ev_callback[e].splice(r,1)}},r.extend=function(e){var t=this,r=function(){return t.apply(this,arguments)};return $.extend(r,t),r.prototype=new t,$.extend(r.prototype,e),r.__super__=t.prototype,r},e.exports=r},function(e,t){var r={kuaixunAd:10450,recommendAd:10443};e.exports=r},function(e,t){try{e.exports=function(){var e={},t=function(t,r,i){var n;if("undefined"!=typeof document){if(arguments.length>1){if(i=$.extend({path:"/"},e,i),"number"==typeof i.expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i.expires),i.expires=a}try{n=JSON.stringify(r),/^[\{\[]/.test(n)&&(r=n)}catch(u){}return r=encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",r,i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}t||(n={});for(var s=document.cookie?document.cookie.split("; "):[],o=0;o<s.length;o++){var l=s[o].split("="),d=l.slice(1).join("=");'"'===d.charAt(0)&&(d=d.slice(1,-1));try{var c=l[0].replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent);if(d=d.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(u){}if(t===c){n=d;break}t||(n[c]=d)}catch(u){}}return n}};return t.set=t,t.get=function(e){return t.call(t,e)},t.getJSON=function(){return t.apply({json:!0},[].slice.call(arguments))},t.defaults=e,t.remove=function(e,r){t(e,"",$.extend(r,{expires:-1}))},t}()}catch(r){console.log(r),e.exports={}}},function(e,t){e.exports=function(){var e=null;if(window.sohuSpm&&"function"==typeof window.sohuSpm.getCodes)e=window.sohuSpm.getCodes().e;else{for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=new Array(7),i=0;i<r.length;i++)r[i]=t[parseInt(Math.random()*t.length)];e=(new Date).getTime()+r.join("")}return e}},function(e,t){function r(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(t);return null!=r?unescape(r[2]):""}e.exports=r},function(e,t,r){var i=r(13);e.exports=Backbone.View.extend({template:_.template(r(14)),data:{items:[]},model:null,initialize:function(e){var t=this;this.sceneId=e.sceneId,this.model=e.model,this.test=e.test||!1,this.model.one("sync",function(e){e.data&&e.data.length>0&&t.render(e.data)}),this.model.one("empty",function(){}),this.model.one("error",function(){}),this.model.fetch()},render:function(e){this.data.items=e,this.$el.html(this.template(this.data)),this.scroll(),window.sohuSpm&&"function"==typeof window.sohuSpm.domDidChange&&setTimeout(function(){window.sohuSpm.domDidChange()},100)},scroll:function(){new i({el:".column-slider",operateEl:"#copy-slider",speed:1e3,interval:4e3})}})},function(e,t){var r=function(e){this.el=e.el,this.operateEl=e.operateEl,this.supportTransform=this.isSupportTransform(),this.interval=e.interval||4e3,this.speed=e.speed||1e3,this.first=!0,this.translateY=0,this.initLocation=0,this.init()};r.prototype={init:function(){$(this.operateEl).html($(this.el).eq(0).html()),this.autoPlay()},isSupportTransform:function(){return"transform"in document.createElement("div").style},autoPlay:function(){var e=this,t=$(e.el).children().eq(0).height();if(this.supportTransform){var r=this.speed/1e3+"s";setInterval(function(){e.translateY-=t,$(e.el).css("transition",r),$(e.el).css("transform","translateY("+e.translateY+"px)"),e.initLocation+=1,e.initLocation===$(e.el).eq(0).children().length+1&&(e.initLocation=0,setTimeout(function(){e.translateY=0,$(e.el).css("transition",""),$(e.el).css("transform","translateY("+e.translateY+"px)"),$(e.el).eq(0).after($(e.el).eq(1))},e.interval)),window.sohuSpm&&"function"==typeof window.sohuSpm.reScan&&window.sohuSpm.reScan()},e.interval)}else setInterval(function(){e.translateY-=t,e.initLocation+=1,$(e.el).animate({top:e.translateY+"px"},e.speed,function(){var t=e.first?$(e.el).eq(0).children().length+1:$(e.el).eq(0).children().length;e.initLocation===t&&(e.first=!1,e.initLocation=0,setTimeout(function(){e.translateY=0,$(e.el).css("top",0),$(e.el).eq(0).after($(e.el).eq(1))},e.interval))}),window.sohuSpm&&"function"==typeof window.sohuSpm.reScan&&window.sohuSpm.reScan()},e.interval)}},e.exports=r},function(e,t){e.exports='<div class="column-kuaixun"></div>\n<div class="column-news-wrap" >\n    <div class="column-slider" id="origin-focus" >\n        <% for( var a = 0 ; a < items.length ; a++) { %>\n        <%\n        var item = items[a];\n        %>\n        <div class="column-news-title">\n            <a href="<%=item.url%>" target="_blank" data-spm-strict="true">\n                <%=item.title%>\n            </a>\n        </div>\n        <%}%>\n    </div>\n    <div class="column-slider" id="copy-slider"  data-spm-type=\'resource\'>\n    </div>\n</div>'},function(e,t,r){var i=r(16);e.exports=Backbone.View.extend({template:_.template(r(17)),events:{"click .search-btn":"onSearch","keydown [data-val='key']":"keydown","focus [data-val='key']":"focus","blur [data-val='key']":"blur"},data:{d_val:""},p_id_map:{HOMEPAGE:"0001",CHANNEL:"0002",TAG:"0003",ARTICLE:"0004"},search_host:"//search.sohu.com/",queryType:"edit",render:function(){this.$el.html(this.template(this.data))},initialize:function(e){var t=this,r=new i;r.on("sync",function(e){t.randomWord=e[Math.floor(Math.random()*e.length)],t.randomWord&&(t.data.d_val="大家都在搜："+t.randomWord),t.render()}),r.on("error",function(){t.render()}),r.fetch()},onSearch:function(e){var t="",r="";window.sohuSpm&&(t=window.sohuSpm.getCodes(),r=t.a+"."+t.b+".search-box.1."+t.e);var i,n=$(this.$el).find('[data-val="key"]').val();n==this.data.d_val&&(this.queryType="hot-query",n=n.replace("大家都在搜：","")),i=""==n?this.search_host:[this.search_host,"?keyword=",window.encodeURIComponent(n),"&source=article&queryType=",this.queryType,"&ie=utf8","&spm=",r].join(""),window.open(i)},keydown:function(e){var t=window.encodeURIComponent($(this.$el).find('[data-val="key"]').val());navigator.userAgent,this.search_host;13==e.keyCode&&this.onSearch()},focus:function(e){window.sohuSpm&&"function"==typeof window.sohuSpm.sendAction&&window.sohuSpm.sendAction({acode:8386}),$(e.currentTarget).val()==this.data.d_val&&(e.currentTarget.value="")},blur:function(){var e=this;setTimeout(function(){e.$el.find('[data-val="key"]').val(e.data.d_val)},200)}})},function(e,t,r){var i=r(7),n=window.localStorage||!1;e.exports=i.extend({init:function(e){this.url="//search.sohu.com/search/hot"},fetch:function(){var e=this;if(n&&n.getItem("search_words")){var t=JSON.parse(n.getItem("search_words")),r=(new Date).getTime();if(t&&t.words&&t.outtime&&r<t.outtime)return void e.trigger("sync",t.words)}$.ajax({url:this.url,type:"GET",success:function(t){var r={outtime:(new Date).getTime()+6e5,words:t.data};n.setItem("search_words",JSON.stringify(r)),e.trigger("sync",t.data)},error:function(t){e.trigger("error",t)},timeout:3e3})}})},function(e,t){e.exports='<input type="text" class="search-input search-left" value="<%=d_val%>"  data-val="key">\n<span class="search-btn">\n    <i class="search-icon"></i>\n</span>\n<form target=""  style="display:none;width:0;height:0"></form>\n'},function(e,t,r){var i=r(7),n=r(9),a=r(10),s=r(11),o=r(19),l=n.get("SUV")||"",d=l+"_"+(new Date).getTime(),c=window.encodeURIComponent(document.referrer.substring(0,250))||"";e.exports=i.extend({init:function(e){this.test=e.test||!1,this.regionId=e.regionId,this.scene=e&&e.scene||"HOMEPAGE",this.sceneId=e&&e.sceneId||0,this.news_id=e&&e.news_id,this.channel_id=e&&e.channel_id||0,this.page=1,this.size=15},fetch:function(){var e=this;this.url="//v2.sohu.com/integration-api/mix/region/"+this.regionId,this.test&&(this.url="//d1.m.sohu.com/integration-api/mix/region/"+this.regionId);var t=1===e.page?2*e.size:e.size,r=a(),n=s("spm"),u={SUV:l,pvId:r,page:this.page,size:t,refer:c,spm:n,adapter:"pcArticleNew",requestId:d},h=(new Date).getTime();i.prototype.fetch.call(this,{data:u,success:function(t,r){t.data&&t.data.length>0?(t.page=e.page,t.size=e.size,e.trigger("sync",t),o({id:e.regionId,startTime:h,type:"SUCCESS"}),e.page+=1):o({id:e.regionId,startTime:h,type:"EMPTY"})},error:function(t){SspReport({id:e.regionId,startTime:h,type:"ERROR"})}})}})},function(e,t){var r=function(e){var t=(new Date).getTime(),r={regionId:e.id,type:e.type};switch(e.type){case"TIMEOUT":break;case"ERROR":e.data&&e.data.error&&(r.data=e.data.error.substr(0,50));break;default:r.duration=t-e.startTime}var i=e.acode||8464,n="";for(var a in r)n+=a+":"+r[a]+";";n=n.substr(0,n.length-1),window.sohuSpm&&"function"==typeof window.sohuSpm.sendAction&&window.sohuSpm.sendAction({acode:i,clkParam:n})};e.exports=r},function(e,t,r){var i=r(21),n=r(22),a=r(25),s=r(30),o=r(31);e.exports=Backbone.View.extend({template:_.template(r(32)),singleTemplate:_.template(r(33)),data:{items:[]},model:null,initialize:function(e){var t=this;this.opts=e,this.code=e.code||null,this.news_id=0,this.bottomY=15,this.time=500,this.interval=2e3,this.throttleTime=80,this.model=e.model,this.model.one("sync",function(e){t.render(e),t.getDetail(),t.inlineRefresh()}),this.model.fetch(),this.refresh()},dataHandler:function(e){var t={contentArr:[],sspAdArr:[]};return e.data.forEach(function(r,i){r.currentId=1===e.page?i+1:e.page*e.size+i+1,1===r.type||2===r.type||3===r.type||4===r.type||5===r.type?t.contentArr.push(r):100===r.type&&r.adType&&t.sspAdArr.push(r)}),t},renderSspAd:function(e){var t=this;e.forEach(function(e){var r=Math.random().toString(30).slice(6)+"_",i="#"+r,n=e.currentId-1;$(t.$el).eq(0).find("a[data-current='"+n+"']").after('<div style="border-bottom: 1px solid #F0F0F0;padding: 13px 0" id="'+r+'"></div>'),a(e,$(i))})},getDetail:function(){var e=this,t=$(".recommend-expand");t.off("click");for(var r=0;r<t.length;r++)t.eq(r).on("click",function(t){t.preventDefault(),e.getPassage(t)})},render:function(e){this.data.items=this.dataHandler(e).contentArr,this.$el.html(this.template(this.data)),this.$el.children("#recommend-content").attr("data-spm",window.currentSpm),this.dataHandler(e).sspAdArr.length>0&&this.renderSspAd(this.dataHandler(e).sspAdArr),this.lazyLoad(),window.sohuSpm&&"function"==typeof window.sohuSpm.domDidChange&&setTimeout(function(){window.sohuSpm.domDidChange()},100),this.nextPage(),this.scroll()},scroll:function(){var e,t=this;$(t.opts.el).children().on("scroll",function(r){e&&clearTimeout(e),e=setTimeout(function(){var e=$(t.opts.el).height(),r=$(t.opts.el).children().eq(1).children().height();Math.round($(t.opts.el).children().eq(1).scrollTop())+e+t.bottomY>=r&&(t.model.one("sync",function(e){t.renderAsync(e)}),t.model.fetch()),t.lazyLoad()},t.throttleTime)})},lazyLoad:function(){this.opts.el.find($("img[data-src]")).each(function(){if(o($(this))){var e=$(this).attr("data-src");$(this).attr("src",e).removeAttr("data-src")}})},renderAsync:function(e,t){var r=this;this.data.items=this.dataHandler(e).contentArr,t?($(this.opts.el).children().eq(1).children().prepend(this.singleTemplate(this.data)),this.opts.el.children().eq(1).children().children().eq(this.data.length-1).after($(this.opts.fresh)),$(this.opts.fresh).show(),$(this.opts.el).children().eq(1).animate({scrollTop:0},this.time),$(r.opts.el).children(r.opts.recommendNum).addClass("recommend-active"),setTimeout(function(){$(r.opts.el).children(r.opts.recommendNum).removeClass("recommend-active")},r.interval)):$(this.opts.el).children().eq(1).children().append(this.singleTemplate(this.data)),this.dataHandler(e).sspAdArr.length>0&&this.renderSspAd(this.dataHandler(e).sspAdArr),this.lazyLoad(),window.sohuSpm&&"function"==typeof window.sohuSpm.domDidChange&&setTimeout(function(){window.sohuSpm.domDidChange()},100),this.nextFresh()},nextFresh:function(){var e=this,t=$(".recommend-expand");t.off("click");for(var r=0;r<t.length;r++)t.eq(r).on("click",function(t){t.preventDefault(),e.getPassage(t)})},nextPage:function(){var e=this,t=$(this.opts.el).next().children("div:last-child");t.off("click"),t.on("click",function(){var t=$(e.opts.el).children(".recommend-content").height();$(e.opts.el).children(".recommend-content").animate({scrollTop:t+$(e.opts.el).children(".recommend-content").scrollTop()},300),s(8396)})},refresh:function(){var e=this;$(this.opts.el).next().children("div:first-child").off("click"),$(this.opts.el).next().children("div:first-child").on("click",function(){e.reloadList(),s(8395)})},inlineRefresh:function(){var e=this;$(".recommend-fresh").off("click"),$(".recommend-fresh").on("click",function(){e.reloadList(),s(8397)})},reloadList:function(){var e=this;e.model.one("sync",function(t){e.renderAsync(t,!0)}),e.model.fetch()},getPassage:function(e){var t=this;$(".recommend-expand").children().removeClass("focus"),$(e.currentTarget).children().addClass("focus"),$(e.currentTarget).addClass("clicked");var r=$(e.currentTarget).attr("data-id");if(new n({el:$("#content-part"),test:t.opts.test,model:new i({id:r,test:t.opts.test})}),$(window).scrollTop(0),s(8393),window.history&&window.history.pushState&&"function"==typeof window.history.pushState){var a=/\/na\/.+/g,o=0;o=a.test($(e.currentTarget).attr("href"))?$(e.currentTarget).attr("href").match(a)[0]:"/na/"+$(e.currentTarget).attr("data-id"),t.code&&(o=o+"&"+t.code,t.code=null),window.history.pushState({id:$(e.currentTarget).attr("data-id")},document.title,o)}window.sohuSpm&&"function"==typeof sohuSpm.sendPv&&window.sohuSpm.sendPv({forceUpdate:!0,extData:"cuspvf:1"})}})},function(e,t,r){var i=r(7);e.exports=i.extend({init:function(e){this.test=e.test||!1,this.id=e.id},fetch:function(){var e=this;this.url="//v2.sohu.com/article-service-api/article/"+this.id,i.prototype.fetch.call(this,{success:function(t,r){try{t.length<1?e.trigger("empty"):(e.page+=1,e.trigger("sync",t))}catch(i){e.trigger("error")}}})}})},function(e,t,r){var i=r(23),n=r(24),a=r(28);e.exports=Backbone.View.extend({template:_.template(r(29)),data:{article:{},author:{}},model:null,initialize:function(e){var t=this;this.el=e.el,this.model=e.model,this.opts=e,this.model.fetch(),this.model.one("sync",function(e){e.code&&200===e.code&&t.render(e.data)})},render:function(e){this.data=e,this.data.article&&this.data.article.publicTime&&(this.data.article.publicTime=a(this.data.article.publicTime)),this.passageInfo(e),this.el.html(this.template(this.data)),this.rechangeList()},passageInfo:function(e){this.el.parent().parent().parent().attr("data-region",e.pcRegionIdV2),this.el.parent().parent().parent().attr("data-articleid",e.article.id),e.article&&e.article.title&&(document.title=e.article.title)},rechangeList:function(){var e=this;new n({el:$("#relate-recommend"),test:e.opts.test,model:new i({scene:"CHANNEL",channel_id:$("article").attr("data-channel"),mainEl:$("#article-region"),test:e.opts.test})})}})},function(e,t,r){var i=r(7),n=r(9),a=r(10),s=r(11),o=r(19),l=n.get("SUV")||"",d=l+"_"+(new Date).getTime(),c=window.encodeURIComponent(document.referrer.substring(0,250))||"";e.exports=i.extend({init:function(e){this.test=e.test||!1,this.scene=e&&e.scene||"HOMEPAGE",this.sceneId=e&&e.sceneId||0,this.news_id=e&&e.mainEl.attr("data-articleid"),this.channel_id=e&&e.channel_id||0,this.regionId=e&&e.mainEl.attr("data-region")},fetch:function(){var e=this;this.url="//v2.sohu.com/integration-api/mix/region/"+this.regionId,this.test&&(this.url="//d1.m.sohu.com/integration-api/mix/region/"+this.regionId);var t=a(),r=s("spm"),n={SUV:l,pvId:t,page:1,size:12,mpId:this.news_id,adapter:"pcArticleNew",requestId:d,refer:c,spm:r,channel:this.channel_id},u=(new Date).getTime();i.prototype.fetch.call(this,{data:n,success:function(t,r){t.data&&t.data.length>0?(e.trigger("sync",t),o({id:e.regionId,startTime:u,type:"SUCCESS"})):o({id:e.regionId,startTime:u,type:"EMPTY"})},error:function(t){SspReport({id:e.regionId,startTime:u,type:"ERROR"})}})}})},function(e,t,r){var i=r(25);e.exports=Backbone.View.extend({template:_.template(r(27)),data:{items:[]},model:null,initialize:function(e){var t=this;this.model=e.model,this.test=e.test||!1;var r=[],i=[];this.model.one("sync",function(e){e.data.forEach(function(e,t){e.index=t+1,1===e.type||2===e.type||3===e.type||4===e.type||5===e.type?r.push(e):100===e.type&&e.adType&&i.push(e)}),r.length>0&&t.renderFeed(r),i.length>0&&t.renderSspAd(i),t.extraHandle()}),this.model.fetch()},renderSspAd:function(e){var t=this;e.forEach(function(e){var r=Math.random().toString(30).slice(6)+"_",n="#"+r,a=e.index-1;$(t.$el).eq(0).find("a[data-position='"+a+"']").after('<div class="newlist-single bd-wrap" id="'+r+'"></div>'),i(e,$(n))})},renderFeed:function(e){this.data.items=e,this.$el.html(this.template(this.data))},extraHandle:function(){window.sohuSpm&&"function"==typeof window.sohuSpm.domDidChange&&setTimeout(function(){window.sohuSpm.domDidChange({target:"fd-d"})},100)}})},function(e,t,r){var i=r(26),n=function(e,t,r){switch(e.adType){case"BAIDUUNION":i(e,t,r)}};e.exports=n},function(e,t){var r=function(e,t,r){var s=n(),o="#"+s,l=document.createElement("a");l.setAttribute("href","javascript:void(0);"),l.setAttribute("id",s);var d={id:e.adData.id,name:s};e.adData.qpbUrl&&(d.qpbUrl=e.adData.qpbUrl),l=i(e,l),t.append(l),a(o,d),window.sohuSpm&&"function"==typeof window.sohuSpm.domDidChange&&r&&setTimeout(function(){window.sohuSpm.domDidChange({target:r})},100)},i=function(e,t){var r=e.resourceType||"",i=e.authorId||"",n=e.id||"",a=e.pcm||"",s=e.type||"",o=e.adInfo||"",l=r+"|"+i+"|"+n+"|"+a+"|"+s+"|"+o;return t.setAttribute("data-spm-content",l),t},n=function(){return Math.random().toString(36).substr(2,8)},a=function(e,t){if($(e).size()>0){var r="_"+Math.random().toString(36).slice(2),i={id:t.id,isAsync:!0};if(t.qpbUrl){var n=document.createElement("div"),a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src",t.qpbUrl),n.appendChild(a),document.getElementById(t.name).appendChild(n)}else $(e).append('<div style="" id="'+r+'"></div>'),i.container=r,(window.slotbydup=window.slotbydup||[]).push(i)}};e.exports=r},function(e,t){e.exports='<% for( var a = 0 ; a < items.length ; a++) { %>\n<%\nvar item = items[a];\n%>\n<a class="newlist-single" href="<%=item.url%>" target="_blank" data-position="<%=item.index%>">\n    <div class="newlist-single-main">\n        <img class="newlist-single-img" src="//statics.itc.cn/web/static/images/pic/preload.png" data-src="<%=item.images[0]%>" />\n        <div class="newlist-single-title">\n            <span><%=item.title%></span>\n        </div>\n    </div>\n</a>\n<%}%>'},function(e,t){var r=function(e,t,r){if(!e)return"";var i=new Date(e),n=i.getFullYear(),a=i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1,s=i.getDate()<10?"0"+i.getDate():i.getDate(),o=i.getHours()<10?"0"+i.getHours():i.getHours(),l=i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes(),d=i.getSeconds()<10?"0"+i.getSeconds():i.getSeconds(),c=n+"-"+a+"-"+s,u=o+":"+l+":"+d,h=o+":"+l;switch(r!==undefined&&(c=n+r+a+r+s),t){case"date":return c;case"time":return u;case"hour":return h;case"datetime":default:return c+" "+h}};e.exports=r},function(e,t){e.exports='<% if (article.header) { %>\n    <div class="text-focus">\n        <div class="text-focus-pic">\n            <div class="pic"><img src="<%=article.cover%>" alt=""></div>\n            <div class="bg"></div>\n            <div class="txt">\n                <div class="article-tag">\n                    <% if (article.original==\'1\') { %>\n                    <em class="original-tag">原创</em></div>\n                    <% } %>\n                <h1><%=article.title%></h1>\n            </div>\n        </div>\n        <div class="article-info">\n            <span class="time" id="news-time"><%= article.publicTime %></span>\n        </div>\n    </div>\n<% } else { %>\n    <div class="text-title">\n        <h1>\n            <% if (article.originalStatus == 1) { %>\n                <span class="original-logo">原创</span>\n                <span class="title-info-title"><%=article.title%></span>\n            <% } else { %>\n                <%=article.title%>\n            <% } %>\n            <span class="article-tag">\n            <% if (article.original==\'1\') { %>\n                <em class="original-tag">原创</em>\n            <% } %>\n            </span>\n        </h1>\n        <% if (!article.originalSource) { %>\n            <% var originalSource="" %>\n        <% } else { %>  \n            <% var originalSource=article.originalSource %>\n        <% } %>\n        <% if (author.name) { %>\n        <div class="article-info">\n            <span data-role="original-link">\n                <%=author.name%>\n            </span>\n            <span class="time" id="news-time"><%= article.publicTime %></span>\n        </div>\n        <% } %>\n    </div>\n<% } %>\n<article class="article" id="mp-editor" data-channel="<%=article.channelId%>">\n    <p data-role="original-title" style="display:none">原标题：<%=article.title%></p>\n    <% if(article.headVideo) { %>\n        <div id="sohuplayer">\n            <script type="text/javascript" src="//tv.sohu.com/upload/swf/showVrsPlayer.js"><\/script>\n            <script type="text/javascript">\n                if (!article.headVideo.site == 1) {\n                    showVrsPlayer({\n                        vid: article.headVideo.videoId,\n                        width: \'500\',\n                        height: \'375\',\n                        autoplay: false,\n                        vars: {"enforceHTML5": false}\n                    });\n                } else {\n                    showVrsPlayer({\n                        bid: article.headVideo.videoId,\n                        width: \'500\',\n                        height: \'375\',\n                        autoplay: false,\n                        vars: {"enforceHTML5": false}\n                    });\n                }\n            <\/script>\n        </div>\n        <p class="video-title" style="text-align: center;">\n            <span class="video-ionc"></span>\n            <%= article.headVideo.title %>\n        </p>\n    <% } %>\n    <%=article.content.replace(/^( |[\\s])+|( |[\\s])+$/g, "")%>\n</article>\n<div class="statement">声明：本文由入驻搜狐公众平台的作者撰写，除搜狐官方账号外，观点仅代表作者本人，不代表搜狐立场。</div>'},function(e,t){var r=function(e){window.sohuSpm&&"function"==typeof window.sohuSpm.sendAction&&window.sohuSpm.sendAction({acode:e})};e.exports=r},function(e,t){var r=function(e){if(!e.is(":visible"))return!1;var t=$(window),r={top:t.scrollTop(),left:t.scrollLeft()};r.right=r.left+t.width(),r.bottom=r.top+t.height();var i=e.outerHeight(),n=e.outerWidth();if(!n||!i)return!1;var a=e.offset();return a.right=a.left+n,a.bottom=a.top+i,!(r.right<a.left||r.left>a.right||r.bottom<a.top||r.top>a.bottom)};e.exports=r},function(e,t){e.exports='<div class="recommend-remind recommend-num">\n    为您推荐了<%=parseInt(items.length / 2)%>条文章\n</div>\n<div class="recommend-content" id="recommend-content" data-spm="recommend-tj">\n    <div class="recommend-auto-content">\n        <% for( var a = 0 ; a < items.length ; a++) { %>\n        <%\n        var item = items[a];\n        %>\n        <a class="recommend-expand" data-id="<%=item.id%>_<%=item.authorId%>" href="<%=item.url%>" data-current="<%=item.currentId%>">\n            <div class="recommend-single-content">\n                <img class="recommend-single-img" src="//statics.itc.cn/web/static/images/pic/preload.png" data-src="<%=item.images[0]%>" />\n                <div class="recommend-single-title">\n                    <div class="recommmend-title-wrap">\n                        <span><%=item.title%></span>\n                    </div>\n                </div>\n            </div>\n        </a>\n        <%}%>\n    </div>\n</div>\n<div class="recommend-remind recommend-fresh">\n    刚刚看到这里，点击刷新\n    <i class="recommend-fresh-icon"></i>\n</div>'},function(e,t){e.exports='\n<% for( var a = 0 ; a < items.length ; a++) { %>\n<%\nvar item = items[a];\n%>\n<a class="recommend-expand" data-id="<%=item.id%>_<%=item.authorId%>" href="<%=item.url%>" data-current="<%=item.currentId%>">\n    <div class="recommend-single-content">\n        <img class="recommend-single-img" src="//statics.itc.cn/web/static/images/pic/preload.png" data-src="<%=item.images[0]%>" />\n        <div class="recommend-single-title">\n            <div class="recommmend-title-wrap">\n                <span><%=item.title%></span>\n            </div>\n        </div>\n    </div>\n</a>\n<%}%>\n'},function(e,t){var r=function(e){this.el=e.el,this.feedEl=e.feedEl,this.activeClass=e.activeClass,this.callBackFun=e.callBackFun};r.prototype={init:function(){this.clickNav()},clickNav:function(){var e=this;this.el.children().children("li").on("click",function(t){t.preventDefault(),window.currentSpm=$(this).attr("data-single"),e.el.children().children("li").removeClass(e.activeClass),$(this).addClass(e.activeClass);var r=/spm=.+/g,i=null;r.test($(this).children("a").attr("href"))&&(i=$(this).children("a").attr("href").match(r)[0]),e.callBackFun($(this).attr("data-region"),i)})}},e.exports=r},function(e,t){e.exports=function(e){function t(){var e=r.offset().top,t=r.height(),i=$(".statement").offset().top;n&&e+.5*t>=$(window).scrollTop()&&e+.5*t<=$(window).scrollTop()+$(window).height()&&window.sohuSpm&&"function"==typeof window.sohuSpm.sendAction&&(window.sohuSpm.sendAction({acode:8399}),n=!1),a&&i>=$(window).scrollTop()&&i<=$(window).scrollTop()+$(window).height()&&(window.sohuSpm.sendAction({acode:8400}),a=!1)}var r=$(e.el),i=!0,n=!0,a=!0;r.mouseenter(function(){i&&window.sohuSpm&&"function"==typeof window.sohuSpm.sendAction&&(window.sohuSpm.sendAction({acode:8398}),i=!1)}),$(window).scroll(function(){t()})}},function(e,t,r){function i(e){this._replaceImg(e),this.init()}var n=r(31);i.prototype={constructor:i,init:function(){$(window).on("scroll",_.throttle(this._replaceImg.bind(this),100))},scanImg:function(){this._replaceImg()},_replaceImg:function(e){$("img[data-src]").each(function(){if(n($(this))){var e=$(this).attr("data-src");$(this).attr("src",e).removeAttr("data-src")}})}},e.exports=i},function(e,t){var r={8:"UA-sohu-000011",17:"UA-sohu-000012",19:"UA-sohu-000013",30:"UA-sohu-000014",42:"UA-sohu-000014",41:"UA-sohu-000014",23:"UA-sohu-000015",other:"UA-sohu-000016"},i=function(e){var t=r[e]||r.other;window._iwtUa=t};e.exports=i},function(module,exports,__webpack_require__){var SymbolConfig=__webpack_require__(39),RecModule=__webpack_require__(40),ShopCard=__webpack_require__(47),apiModel=__webpack_require__(50);module.exports=Backbone.View.extend({model:null,LazyLoad:null,data:{newsId:"",typeMap:{}},initialize:function(opts){var that=this;this.data.newsId=opts.data.newsId,this.data.mediaId=opts.data.mediaId,this.model=new apiModel,this.LazyLoad=opts.LazyLoad;for(var shopInfoObj={ids:[],cMap:{}},$mpPlugin=this.$el.find("mp-plugin"),i=0;i<$mpPlugin.length;i++){var $item=$($mpPlugin[i]),type=$($item).attr("data-type");if(type)try{var info=eval($item.attr("data-info"));if(SymbolConfig.shopCard.indexOf(+type)>-1&&info&&info[0]){var key=info[0].cardUuid;shopInfoObj.ids.push(key),shopInfoObj.cMap[key]={type:type,$el:$item}}else new RecModule({el:$item,LazyLoad:that.LazyLoad,data:{spm:that.getSpm(type),newsId:opts.newsId,mediaId:opts.mediaId}})}catch(error){console.log(error)}}this.renderShopCard(shopInfoObj)},renderShopCard:function(e){var t=this;e.ids&&e.ids.length&&this.model.getCardData({data:{ids:e.ids.join(","),_t:(new Date).getTime()},success:function(r){if(r.data&&2e6===r.code){r.data.forEach(function(r){new ShopCard(_.extend({},{el:e.cMap[r.uuid].$el,newsId:t.data.newsId,mediaId:t.data.mediaId,contentData:r,type:+e.cMap[r.uuid].type,LazyLoad:t.LazyLoad}))})}},error:function(e){console.log(e)}})},getSpm:function(e){var t="";return e==SymbolConfig.articleNoPic||e==SymbolConfig.articleOnePic?t="r":e==SymbolConfig.atlas?t="i":e==SymbolConfig.list&&(t="c"),
this.data.typeMap[t]=this.data.typeMap[t]?++this.data.typeMap[t]:1,t+"-"+this.data.typeMap[t]}})},function(e,t){e.exports={articleNoPic:11,articleOnePic:10,list:1,atlas:20,shopCardHouseEnroll:30,shopCardHousePhone:31,normalEnroll:32,normalPhone:33,shopCardEnroll:[30,32],shopCardPhone:[31,33],shopCardPoster:[35,36],shopCardImgText:[34],shopCardVideo:[37,38,39],shopCard:[31,30,32,33,34,35,36,37,38,39]}},function(e,t,r){var i=r(41),n=r(42),a=r(39);e.exports=Backbone.View.extend({articleNoPicTemplate:_.template(r(43)),articleOnePicTemplate:_.template(r(44)),atlasTemplate:_.template(r(45)),listTemplate:_.template(r(46)),model:null,LazyLoad:null,data:{spm:"",newsId:""},render:function(){try{var e=this.$el.attr("data-type"),t=this.$el.attr("data-content");this.$el.attr("hidden",!1);var r=t&&JSON.parse(t),i=this.getTmplateName(e,r);r.spm=this.data.spm,this.formatData(e,r),this.$el.html(this[i](r)),this.LazyLoad.scanImg()}catch(n){console.log(n)}},initialize:function(e){this.data.spm=e.data.spm,this.data.newsId=e.data.newsId,this.LazyLoad=e.LazyLoad,this.render()},getTmplateName:function(e,t){var r="";switch(+e){case a.articleNoPic:r="articleNoPicTemplate";break;case a.articleOnePic:r="articleOnePicTemplate";break;case a.list:r="listTemplate";break;case a.atlas:r="atlasTemplate"}return r},formatData:function(e,t){if(+e===a.articleNoPic){var r=82;t.brief=t.brief&&t.brief.length>r?i.subString(t.brief,r)+"..":t.brief}if(+e===a.articleOnePic){var r=60;t.brief=t.brief&&t.brief.length>r?i.subString(t.brief,r)+"..":t.brief,t.cover=this.fitImg(t.cover)}if(+e===a.atlas)for(var n=0;n<3;n++)t.images[n]=this.fitImg(t.images[n])},fitImg:function(e){return n.cutPicUrl(e,"c_fill,w_225,h_150,g_faces,q_100")}})},function(e,t){e.exports={subString:function(e,t){if(!e)return e;var r=e.replace(/[\u4e00-\u9fa5]/g,"**"),i=2*t;if(r.length<=i)return e;for(var n=[],a=0,s=0;a<i&&s<e.length;){var o=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;n.push(e[s]),s++,/[\u4e00-\u9fa5]/.test(e[s])?a+=2:o.test(e[s])?a+=2:a++}return n.join("")+"..."}}},function(e,t){var r=["5b0988e595225.cdn.sohucs.com","29e5534ea20a8.cdn.sohucs.com","img.mp.itc.cn","img.mp.sohu.com"],i=r.length,n=function(e){return!!e&&(e.split("//")[1]&&("images"===e.split("//")[1].split("/")[1]||"upload"===e.split("//")[1].split("/")[1]))};e.exports={cutPicUrl:function(e,t,a){if(!e)return"";for(var s=t,o=e,l=0;l<i;l++)n(o)&&(o=o.replace(r[l],r[l]+"/"+s));return o.replace(/^http:/,"")}}},function(e,t){e.exports='<div class="insert-rec insert-article article-nopic">  \n    <a href="<%=url%>" target="_blank" class="insert-box insert-article__box" data-spm-data="<%=spm%>">\n        <div class="insert-article__content">\n            <h5 class="insert-rec__title insert-article__title"><%=title%></h5>\n            <p class="insert-article__des">\n                <%=brief%>\n            </p>\n            <p class="insert-article__footer">\n                <span class="auther"><span>作者：</span><%=author%></span>\n            </p>\n        </div>\n    </a>\n    <div style="clear: both"></div>\n</div>\n'},function(e,t){e.exports='<div class="insert-rec insert-article article-onepic">  \n    <a href="<%=url%>" target="_blank" class="insert-box insert-article__box" data-spm-data="<%=spm%>">\n        <div class="img-box img-do">\n            <img class="insert-article__img" data-src="<%=cover%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="配图">\n        </div>\n        <div class="insert-article__content">\n            <h5 class="insert-rec__title insert-article__title"><%=title%></h5>\n            <p class="insert-article__des"><%=brief%></p>\n            <p class="insert-article__footer">\n                <%if(author) { %>\n                    <span class="auther"><span>作者：</span><%=author%></span>\n                <%}%>\n                \x3c!-- <span class="tip">查看文章</span> --\x3e\n            </p>\n        </div>\n    </a>\n    <div style="clear: both"></div>\n</div>'},function(e,t){e.exports='<div class="insert-rec insert-atlas">  \n    <a href="<%=url%>" target="_blank" class="insert-box insert-atlas__box" data-spm-data="<%=spm%>">\n        <div class="insert-atlas__gallery img-do">\n            <div class="img-left">\n                <img data-src="<%=images[0]%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="">\n            </div>\n            <div class="img-right">\n                <div class="img-right__item1">\n                    <img data-src="<%=images[1]%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="">\n                </div>\n                \n                <div class="img-right__item2">\n                    <img data-src="<%=images[2]%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="">\n                    <span class="img-right__cover"> <%=images.length%> 图</span>\n                </div>\n            </div>\n        </div>\n\n        <div class="insert-atlas__content">\n            <p class="atlas-flag">\n                <span><i class="atlas-icon"></i> 图集</span>\n            </p>\n            <h5 class="insert-rec__title insert-atlas__title">\n                <%=title%>\n            </h5>\n            <p class="auther"><span>作者：</span><%=author%></p>\n        </div>\n    </a>\n    <div style="clear: both"></div>\n</div>'},function(e,t){e.exports='<div class="insert-rec insert-list">\n    <p class="insert-list__title"><%=title%></p>\n    <ul class="insert-list__ul">\n        <% for( var i = 0 ; i < list.length ; i++) { %>\n            <%\n                var item = list[i];\n                var isPic = item.type === 3;\n            %>\n            <% if (item.title) {%>\n            <li class="insert-list__li">\n                <i class="dot"></i>\n                <a href="<%=item.url%>" target="_blank" data-spm-data="<%=spm%>-<%=i+1%>">\n                    <% if (isPic) {%>\n                    <span class="atlas-font">图集</span>\n                    <% } %>\n                    <%=item.title%></a>\n            </li>\n            <% } %>\n        <%}%>\n    </ul>\n</div>\n\n'},function(e,t,r){var i=r(41),n=r(42),a=r(48),s=r(50),o=r(39),l=r(52).MptcfePalyer,d=r(51),c=!0,u=Backbone.View.extend({enrollTemplate:_.template(r(53)),phoneTemplate:_.template(r(54)),imgTextTemplate:_.template(r(55)),externalPoster:_.template(r(56)),erternalVideo:_.template(r(57)),events:{"click .show-enroll-btn":"showEnrollBox","click .retract-tip":"hideEnrollBox","click .enroll-btn-submit":"submitEnroll","click .name-input-box .col-input":"hideError","click .telephone-input-box .col-input":"hideError","click .code-input-box .col-input":"hideError","click .get-code-btn":"getMsgCode","click .play-video":"playVideo","click .sendAction":"sendAcode"},LazyLoad:null,render:function(e){var t=e.fields;if(t.image=n.cutPicUrl(t.image,"c_fill,w_225,h_150,g_faces,q_100"),t.title=i.subString(t.title,26),t.spm=this.data.spm,t.dataSpmContent="||"+e.uuid+"|||",t.accountName=e.accountName||"",t.avatar=e.avatar||"",t.status=e.status||1,4!==t.status&&3!==t.status||(c=!1),t.expiredClass=4===t.status||3===t.status?"expired":"",o.shopCardEnroll.indexOf(+this.data.type)>-1)t.p1=t.assemblyAddress||t.desc,t.p2=t.deadlineString,t.p3=t.remark,t.p2?t.p1=i.subString(t.p1,22):t.p1=i.subString(t.p1,50),t.isOverdue=!1,t.applicationDeadline&&(t.time=new d(+t.applicationDeadline).format("MM月dd日"),t.isOverdue=+t.applicationDeadline<(new Date).getTime()),this.$el.html(this.enrollTemplate(t));else if(o.shopCardPhone.indexOf(+this.data.type)>-1&&t.phoneNum)t.p1=t.address||t.desc,t.p2=t.area,t.price=t.price,t.extPhoneNum=t.extPhoneNum,12===t.phoneNum.length?t.phoneNum=t.phoneNum.slice(0,4)+"-"+t.phoneNum.slice(4,8)+"-"+t.phoneNum.slice(8,t.phoneNum.length):11===t.phoneNum.length?t.phoneNum=t.phoneNum.slice(0,3)+"-"+t.phoneNum.slice(3,7)+"-"+t.phoneNum.slice(7,t.phoneNum.length):t.phoneNum=t.phoneNum.slice(0,3)+"-"+t.phoneNum.slice(3,6)+"-"+t.phoneNum.slice(6,t.phoneNum.length),t.p2?t.p1=i.subString(t.p1,22):t.p1=i.subString(t.p1,50),this.$el.html(this.phoneTemplate(t));else if(o.shopCardPoster.indexOf(+this.data.type)>-1){var t=e.fields;t.image=n.cutPicUrl(t.image,"c_fill,w_225,h_150,g_faces,q_100"),t.title=i.subString(t.title,26)||"",t.desc=i.subString(t.desc,26)||"",t.btnText=t.btnText||"",t.spm=this.data.spm,t.dataSpmContent="||"+e.uuid+"|||",t.type=this.data.type,this.$el.html(this.externalPoster(t))}else if(o.shopCardImgText.indexOf(+this.data.type)>-1){var t=e.fields;t.btnText=t.btnText||"",t.desc=t.desc||"",this.$el.html(this.imgTextTemplate(t))}else if(o.shopCardVideo.indexOf(+this.data.type)>-1){var t=e.fields,r=t.video.sofaPlayInfo[0];t.image=t.video.cover,t.videoUrl=r.videoUrl,t.type=this.data.type,t.title=t.title||"",t.btnText=t.btnText||"",t.desc=t.desc||"",this.$el.html(this.erternalVideo(t))}this.LazyLoad.scanImg()},initialize:function(e){this.LazyLoad=e.LazyLoad,this.data={spm:"",codeTime:60,codeInterval:null,newsId:e.newsId,mediaId:e.mediaId,id:e.contentData.uuid,opareBox:null,contentData:e.dataContent,MsgCodeApiF:!1,submitApiF:!1,dialogTimer:null,type:e.type,clkParam:"accountId:"+e.mediaId+";articleId:"+e.newsId+";cardId:"+e.contentData.uuid},this.domData={opareBox:null,nameInput:null,telephoneInput:null,codeInput:null,errorTip:null,codeText:null,enrollBtn:null,dialogTip:null},this.model=new s,this.render(e.contentData),this.initPage(e)},initPage:function(e){if(this.domData.opareBox=this.$el.find(".shop-house-opare"),this.domData.nameInput=this.$el.find(".name-input-box .col-input"),this.domData.telephoneInput=this.$el.find(".telephone-input-box .col-input"),this.domData.codeInput=this.$el.find(".code-input-box .col-input"),this.domData.enrollBtn=this.$el.find(".enroll-btn"),this.domData.dialogTip=this.$el.find(".dialog-tip"),this.domData.errorTip=this.$el.find(".error-tip"),this.domData.codeText=this.$el.find(".get-code-btn .btn-text"),!window.palyerIns&&$(".play-video").length>0&&c){var t=$(".play-logo")[0];$(t).click()}},showEnrollBox:function(){this.domData.opareBox.show(),this.domData.enrollBtn.removeClass("show-enroll-btn"),this.domData.enrollBtn.addClass("enroll-btn-submit"),this.sendAction(8616)},hideEnrollBox:function(){this.domData.opareBox.hide(),this.domData.enrollBtn.addClass("show-enroll-btn"),this.domData.enrollBtn.removeClass("enroll-btn-submit"),this.hideError()},getMsgCode:function(){var e=this;if(this.data.MsgCodeApiF)return!1;this.checkTelePhone()&&60==this.data.codeTime&&(this.data.MsgCodeApiF=!0,this.model.putMsgCode({data:{phoneNum:this.domData.telephoneInput.val(),id:this.data.id},success:function(t){2e6===t.code?(e.setCodeTime(),e.sendAction(8617)):e.showDialog("验证码获取失败"),e.data.MsgCodeApiF=!1},error:function(){e.data.MsgCodeApiF=!1,e.showDialog("验证码获取失败")}}))},setCodeTime:function(){var e=this;e.domData.codeText.text(e.data.codeTime+"秒后重发"),e.data.codeInterval=setInterval(function(){--e.data.codeTime,0===e.data.codeTime?(clearInterval(e.data.codeInterval),e.data.codeTime=60,e.domData.codeText.text("获取验证码")):e.domData.codeText.text(e.data.codeTime+"秒后重发")},1e3)},submitEnroll:function(){console.log("111");var e=this;if(e.data.MsgCodeApiF)return!1;if(this.checkValue()){e.data.MsgCodeApiF=!0;var t={id:this.data.id,articleId:this.data.newsId,name:this.domData.nameInput.val(),phoneNum:this.domData.telephoneInput.val(),captcha:this.domData.codeInput.val()};this.model.submitCardInfo({data:t,success:function(t){2e6===t.code?(e.enrollOk(),e.sendAction(8618)):e.showError(t.msg),e.data.MsgCodeApiF=!1},error:function(){e.showError("异常，报名失败"),e.data.MsgCodeApiF=!1}})}},enrollOk:function(){this.showDialog("报名成功"),this.domData.opareBox.hide(),this.domData.enrollBtn.addClass("enroll-btn-done"),this.domData.enrollBtn.removeClass("enroll-btn-submit"),this.domData.enrollBtn.removeClass("fixPosition"),this.domData.enrollBtn.text("已报名")},showDialog:function(e){var t=this;this.domData.dialogTip.text(e),this.domData.dialogTip.show(),clearTimeout(this.data.dialogTimer),this.data.dialogTimer=setTimeout(function(){t.domData.dialogTip.hide()},3e3)},checkValue:function(){var e=/^([\u4e00-\u9fa5]){2,5}$/,t=/^\d{6}$/;return e.test(this.domData.nameInput.val().trim())?!!this.checkTelePhone()&&(!!t.test(this.domData.codeInput.val().trim())||(this.showError("验证码输入有误，请重新输入"),!1)):(this.showError("名字输入有误，请重新输入"),!1)},checkTelePhone:function(){return!!/^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/.test(this.domData.telephoneInput.val().trim())||(this.showError("手机号输入有误，请重新输入"),!1)},showError:function(e){this.domData.errorTip.show().text(e)},hideError:function(){this.domData.errorTip.hide().text("")},sendAction:function(e){a.sendAction(e,this.data.clkParam)},sendAcode:function(e){var t=$(e.currentTarget).data("acode");this.sendAction(t)},playVideo:function(e){e.preventDefault();var t=$(e.target).parent().offset(),r=$("#sohu-play-content");if(!r.length>0)return!1;r=r[0],r.style.display="block",r.style.left=t.left+"px",r.style.top=t.top+"px";var i={el:"sohu-play-content",url:e.target.getAttribute("data-videoUrl"),autoplay:!0,loop:!1};window.palyerIns?window.palyerIns.play(i):window.palyerIns=new l(i)}});e.exports=u},function(e,t,r){var i=r(49);e.exports={getPvId:function(){var e,t=0;return window.sohuSpm&&"function"==typeof window.sohuSpm.getCodes&&(e=window.sohuSpm.getCodes(),t=e.e),t},getSpmCode:function(e){return e=e||document.location.href,i.getParams(e).spm||""},sendAction:function(e,t){window.sohuSpm&&"function"==typeof window.sohuSpm.sendAction&&window.sohuSpm.sendAction({acode:e,clkParam:t})}}},function(e,t){e.exports={getParams:function(e){if("string"!=typeof e)return{};e=e.substring(e.indexOf("?")+1);for(var t=e.split(/&|=/),r={},i=0;i<t.length;i+=2)r[t[i]]=t[i+1];return r},isUrlParamExist:function(e,t){var r=this.getParams(window.location.href);return!(!r[e]||r[e]!=t)},addParams:function(e,t){}}},function(e,t,r){var i=r(7),n=r(9);r(51),n.get("SUV");e.exports=i.extend({init:function(){this.baseUrl="//v2.sohu.com/mpfe"},getCardData:function(e){$.ajax({url:this.baseUrl+"/card/get",type:"get",data:{ids:e.data.ids},dataType:"jsonp",success:function(t){e.success(t)},error:function(t){console.log(t),e.error(t)}})},putMsgCode:function(e){$.ajax({type:"post",url:this.baseUrl+"/card/getCaptcha",dataType:"jsonp",data:e.data,timeout:3e3,success:function(t){e.success(t)},error:function(t){e.error(t)}})},submitCardInfo:function(e){$.ajax({type:"post",url:this.baseUrl+"/card/apply",data:e.data,dataType:"jsonp",timeout:3e3,success:function(t){e.success(t)},error:function(t){e.error(t)}})}})},function(e,t){var r=function(e){this.time=new Date(e)},i=function(e){return e.toString().length<2?"0"+e:e};r.prototype={fromNow:function(){var e=new Date;return e-this.time<=6e5?"刚刚":e-this.time<=36e5?Math.round((e-this.time)/60/1e3)+"分钟前":e-this.time<=864e5?Math.round((e-this.time)/60/60/1e3)+"小时前":e.getFullYear()==this.time.getFullYear()?i(this.time.getMonth()+1)+"-"+i(this.time.getDate())+" "+i(this.time.getHours())+":"+i(this.time.getMinutes()):this.time.getFullYear()+"-"+i(this.time.getMonth()+1)+"-"+i(this.time.getDate())},format:function(e){return e.replace("yyyy",this.time.getFullYear()).replace("MM",i(this.time.getMonth()+1)).replace("dd",i(this.time.getDate())).replace("HH",i(this.time.getHours())).replace("mm",i(this.time.getMinutes()))},fixTime:function(){var e=new Date;if(e.getFullYear()==this.time.getFullYear()){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(this.time.getFullYear(),this.time.getMonth(),this.time.getDate());return t-r==0?"今天 "+i(this.time.getHours())+":"+i(this.time.getMinutes()):t-r<=864e5?"昨天 "+i(this.time.getHours())+":"+i(this.time.getMinutes()):this.fromNow()}return this.fromNow()}},e.exports=r},function(e,t,r){!function(t,r){e.exports=r()}(window,function(){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return r={},e.m=t=[function(e,t,r){"use strict";function i(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function n(e,t){return i(t),e.classList?e.classList.contains(t):function(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}(t).test(e.className)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(23);t.createEl=function(e,t,r){var i=document.createElement(e);if(t)for(var n in t)t[n]!==undefined&&i.setAttribute(n,t[n]);return r&&(i.innerHTML=r),i},t.appendChildren=function(e,t){t.forEach(function(t){e.appendChild(t)})},t.getBoundingClientRect=function(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),r={height:undefined,width:undefined};return["bottom","height","left","right","top","width"].forEach(function(e){t[e]!==undefined&&(r[e]=t[e])}),r.height||(r.height=parseFloat(a.computedStyle(e,"height"))),r.width||(r.width=parseFloat(a.computedStyle(e,"width"))),r}},t.getPointerPosition=function(e,t){var r={x:"",y:""},i=function(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var r=document.documentElement,i=document.body,n=r.clientLeft||i.clientLeft||0,a=window.pageXOffset||i.scrollLeft,s=t.left+a-n,o=r.clientTop||i.clientTop||0,l=window.pageYOffset||i.scrollTop,d=t.top+l-o;return{left:Math.round(s),top:Math.round(d)}}(e),n=e.offsetWidth,a=e.offsetHeight,s=i.top,o=i.left,l=t.pageY,d=t.pageX;return t.changedTouches&&(d=t.changedTouches[0].pageX,l=t.changedTouches[0].pageY),r.y=Math.max(0,Math.min(1,(s-l+a)/a)),r.x=Math.max(0,Math.min(1,(d-o)/n)),r},t.hasClass=n,t.addClass=function(e,t){return e.classList?e.classList.add(t):n(e,t)||(e.className=(e.className+" "+t).trim()),e},t.removeClass=function(e,t){return e.classList?e.classList.remove(t):(i(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}},function(e,t,r){"use strict";function i(){this.el=n.createEl("div"),this.eventEmitter=a.eventEmitter,this.VIDEO_EVENT_MAP=a.VIDEO_EVENT_MAP,this.ACTION_EVENT_MAP=a.ACTION_EVENT_MAP,this.EXPOSE_EVENT_MAP=a.EXPOSE_EVENT_MAP}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=r(2),s=(i.prototype.setText=function(e){this.el.innerHTML=e},i.prototype.on=function(e,t){this.eventEmitter.on(e,t)},i.prototype.emit=function(e,t){void 0===t&&(t=undefined),this.eventEmitter.emit(e,t)},i.prototype.off=function(e,t){this.eventEmitter.off(e,t)},i.prototype.once=function(e,t){this.eventEmitter.once(e,t)},i.prototype.show=function(e){void 0===e&&(e=this.el),e.style.display="block"},i.prototype.hide=function(e){void 0===e&&(e=this.el),e.style.display="none"},i);t.Component=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=new(r(24).EventEmitter);t.eventEmitter=i;var n={LOADED:"data.loaded",PLAY:"play",PAUSE:"pause",ENDED:"ended",TIMEUPDATE:"timeupdate",BUFFERUPDATE:"bufferupdate",CHANGE_VOLUME:"changevolume",SEEKING:"seeking",SEEKED:"seeked",FULLSCREEN:"fullscreen",EXITFULLSCREEN:"exitfullscreen",VIDEO_CHANGE:"changevideo",DESTROY:"destroy",ERROR:"video-error",NOT_SUPPORT_VIDEO:"not-support-video",NINETY_PERCENTY:"ninety-percenty"};t.VIDEO_EVENT_MAP=n,t.ACTION_EVENT_MAP={PLAY:"PLAY_ACTION",PLAY_REPEAT:"PLAY_REPEAT_ACTION",PAUSE:"PAUSE_ACTION",CHANGE_PROGRESS:"CHANGE_PROGRESS_ACTION",CHANGE_VOLUME:"CHANGE_VOLUME_ACTION",TOGGLE_FULLSCREEN:"TOGGLE_FULLSCREEN_ACTION"};var a={play:n.PLAY,pause:n.PAUSE,ended:n.ENDED,timeupdate:n.TIMEUPDATE,fullscreen:n.FULLSCREEN,exitfullscreen:n.EXITFULLSCREEN};t.EXPOSE_EVENT_MAP=a},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;t.hiddenControlClass="mptcfe-player__hidden-control",t.fullScreenClass="mptcfe-player__full-mode",t.delayTime=2500,t.mousemoveTimeCount=0,t.options=t._initOptions(e);var r=document.querySelector("#"+e.el);r.style.minWidth="200px",r.style.minHeight="100px",t.el=p.createEl("div",{"class":"mptcfe-player"}),t.spmActionsIns=new h.SpmActions(t.options);var i=e.videoType&&"m3u8"===e.videoType.toLowerCase()||/.*\.(m3u8)$/i.test(e.url);return g.isSupportVideoType(t.options)||i?(t.videoIns=new o.VideoHtml5(t.options),t.options.Video=t.videoIns,t.controlBarIns=new l.ControlBar(t.options),t.layerConatinerIns=new d.LayerConatiner(t.options),t.KeyBoardIns=new u.KeyBoard(t.options),p.appendChildren(t.el,[t.videoIns.el,t.layerConatinerIns.el,t.controlBarIns.el]),r.appendChild(t.el),setTimeout(function(){t.bindEvent()},200),t.onEvent()):(t.noSupportIns=new c.NoSupport(t.options),p.appendChildren(t.el,[t.noSupportIns.el]),r.appendChild(t.el),t.emit(t.VIDEO_EVENT_MAP.NOT_SUPPORT_VIDEO)),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),r(4);var s,o=r(22),l=r(26),d=r(33),c=r(37),u=r(38),h=r(39),f=r(1),p=r(0),g=r(40),m=(s=f.Component,a(i,s),i.prototype._initOptions=function(e){return{el:e.el,title:e.title,url:e.url,videoType:e.videoType,poster:e.poster,autoplay:e.autoplay||!1,spmParams:e.spmParams||{spm:"",clkParam:""},isHiddenReplayButton:e.isHiddenReplayButton||!1}},i.prototype.play=function(e){for(var t in e)this.options[t]=e[t];this.videoIns.play(e)},i.prototype.pause=function(){this.videoIns.pause()},i.prototype.dispose=function(){this.eventEmitter.clear()},i.prototype.$on=function(e,t){this.on(this.EXPOSE_EVENT_MAP[e],t)},i.prototype.onEvent=function(){var e=this;this.on(this.VIDEO_EVENT_MAP.PLAY,function(){e.hiddenControlFn()}),this.on(this.VIDEO_EVENT_MAP.FULLSCREEN,function(){p.addClass(e.el,e.fullScreenClass)}),this.on(this.VIDEO_EVENT_MAP.EXITFULLSCREEN,function(){p.removeClass(e.el,e.fullScreenClass)})},i.prototype.bindEvent=function(){this.el.addEventListener("mousemove",this.hiddenControlFn.bind(this))},i.prototype.hiddenControlFn=function(){var e=this;p.removeClass(this.el,this.hiddenControlClass),this.mousemoveTimeCount=1,clearTimeout(this.delayTimeout),this.delayTimeout=setTimeout(function(){e.mousemoveTimeCount--,0==e.mousemoveTimeCount?1==window.SOHU_MPTCFE_PLAYER.state&&p.addClass(e.el,e.hiddenControlClass):1!=e.mousemoveTimeCount||p.hasClass(e.el,e.hiddenControlClass)||p.removeClass(e.el,e.hiddenControlClass)},this.delayTime)},i);t.MptcfePalyer=m},function(e,t,r){var i=r(5);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0};n.insertInto=undefined,r(20)(i,n),i.locals&&(e.exports=i.locals)},function(e,t,r){var i=r(6)
;(e.exports=r(7)(!1)).push([e.i,".mptcfe-player .mptcfe-player__control {\n  position: absolute;\n  bottom: 6px;\n  left: 0;\n  right: 0;\n  width: 100%;\n  height: 50px;\n  z-index: 10;\n}\n.mptcfe-player .mptcfe-player__control .progress-bar {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 6px;\n  cursor: pointer;\n  z-index: 1;\n}\n.mptcfe-player .mptcfe-player__control .progress-bar .progress-bar__line {\n  position: absolute;\n  bottom: 0;\n  height: 4px;\n}\n.mptcfe-player .mptcfe-player__control .progress-bar .progress-bar__default {\n  width: 100%;\n  background: rgba(255, 255, 255, 0.5);\n}\n.mptcfe-player .mptcfe-player__control .progress-bar .progress-bar__loaded {\n  width: 0;\n  background: #F5F6F7;\n  z-index: 1;\n}\n.mptcfe-player .mptcfe-player__control .progress-bar .progress-bar__ing {\n  width: 0;\n  background: #FDD000;\n  z-index: 2;\n}\n.mptcfe-player .mptcfe-player__control .progress-bar .progress-bar__ball {\n  display: none;\n}\n.mptcfe-player .mptcfe-player__control .progress-bar:hover .progress-bar__line {\n  height: 6px;\n}\n.mptcfe-player .mptcfe-player__control .progress-bar:hover .progress-bar__ing .progress-bar__ball {\n  position: absolute;\n  display: block;\n  right: -4px;\n  top: -4px;\n  width: 14px;\n  height: 14px;\n  border-radius: 50%;\n  text-align: center;\n  line-height: 22px;\n  z-index: 1;\n  background: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n}\n.mptcfe-player .mptcfe-player__control .progress-bar:hover .progress-bar__ing .progress-bar__ball .dot {\n  display: inline-block;\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: #fff;\n}\n.mptcfe-player .mptcfe-player__control .mptcfe-player__opare {\n  height: 100%;\n  padding: 0 30px 0 30px;\n  margin-top: 6px;\n  color: #fff;\n  font-size: 16px;\n  background: #00000066;\n}\n.mptcfe-player .mptcfe-player__control .control-play-btn {\n  display: inline-block;\n  width: 12px;\n  height: 15px;\n  margin-right: 20px;\n  padding-top: 16px;\n  vertical-align: middle;\n}\n.mptcfe-player .mptcfe-player__control .control-play-btn .control-play-tip {\n  display: none;\n  position: absolute;\n  top: -46px;\n  left: -10px;\n  width: 32px;\n  height: 19px;\n  line-height: 19px;\n  font-size: 12px;\n  border-radius: 2px;\n  text-align: center;\n  color: #F0F1F2;\n  background: #000000;\n}\n.mptcfe-player .mptcfe-player__control .control-play-btn .play-icon {\n  position: relative;\n  display: block;\n  width: 12px;\n  height: 16px;\n  background-image: url("+i(r(8))+");\n  background-repeat: no-repeat;\n  background-size: 100%;\n  cursor: pointer;\n}\n.mptcfe-player .mptcfe-player__control .control-play-btn .play-icon:hover {\n  background-image: url("+i(r(9))+");\n}\n.mptcfe-player .mptcfe-player__control .control-play-btn .play-icon:hover .control-play-tip {\n  display: block;\n}\n.mptcfe-player .mptcfe-player__control .control-play-btn .pause-icon {\n  position: relative;\n  display: none;\n  width: 12px;\n  height: 17px;\n  background-image: url("+i(r(10))+");\n  background-repeat: no-repeat;\n  background-size: 100%;\n  cursor: pointer;\n}\n.mptcfe-player .mptcfe-player__control .control-play-btn .pause-icon:hover {\n  background-image: url("+i(r(11))+");\n}\n.mptcfe-player .mptcfe-player__control .control-play-btn .pause-icon:hover .control-play-tip {\n  display: block;\n}\n.mptcfe-player .mptcfe-player__control .control-time {\n  display: inline-block;\n  font-size: 13px;\n  vertical-align: middle;\n  padding-top: 16px;\n}\n.mptcfe-player .mptcfe-player__control .control-time .control-time-current {\n  color: #DCDDDE;\n}\n.mptcfe-player .mptcfe-player__control .control-time .control-time-split {\n  padding: 0 4px;\n  color: #9ea0a2;\n}\n.mptcfe-player .mptcfe-player__control .control-time .control-time-duration {\n  color: #9ea0a2;\n}\n.mptcfe-player .mptcfe-player__control .control-fullscreen-btn {\n  padding-top: 17px;\n  float: right;\n  cursor: pointer;\n}\n.mptcfe-player .mptcfe-player__control .control-fullscreen-btn .full-icon {\n  display: block;\n  width: 15px;\n  height: 15px;\n  background-image: url("+i(r(12))+");\n  background-size: 100%;\n  cursor: pointer;\n}\n.mptcfe-player .mptcfe-player__control .control-fullscreen-btn .full-icon:hover {\n  background-image: url("+i(r(13))+");\n}\n.mptcfe-player .mptcfe-player__control .control-fullscreen-btn .shrinkl-icon {\n  display: none;\n  width: 15px;\n  height: 15px;\n  background-image: url("+i(r(14))+");\n  background-size: 100%;\n  cursor: pointer;\n}\n.mptcfe-player .mptcfe-player__control .control-fullscreen-btn .shrinkl-icon:hover {\n  background-image: url("+i(r(15))+");\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn {\n  position: relative;\n  margin-right: 25px;\n  padding-top: 17px;\n  float: right;\n  cursor: pointer;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-icon {\n  display: block;\n  width: 18px;\n  height: 16px;\n  cursor: pointer;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-icon .volume-icon-default {\n  display: block;\n  width: 18px;\n  height: 16px;\n  background-image: url("+i(r(16))+");\n  background-size: 100%;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-icon .volume-icon-default:hover {\n  background-image: url("+i(r(17))+");\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-icon .volume-icon-mute {\n  display: none;\n  width: 18px;\n  height: 16px;\n  background-image: url("+i(r(18))+");\n  background-size: 100%;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-icon .volume-icon-mute:hover {\n  background-image: url("+i(r(19))+");\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-box {\n  position: absolute;\n  display: none;\n  top: -110px;\n  left: -14px;\n  height: 130px;\n  z-index: 10;\n  background: rgba(0, 0, 0, 0);\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-main-box {\n  position: relative;\n  width: 41px;\n  height: 72px;\n  padding: 15px 0;\n  border-radius: 3px;\n  background: rgba(0, 0, 0, 0.7);\n  text-align: center;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn:hover .volume-box {\n  display: block;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-line {\n  display: inline-block;\n  height: 100%;\n  width: 3px;\n  background: #656566;\n  border-radius: 2px;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-line-wrapper {\n  position: relative;\n  height: 100%;\n  width: 14px;\n  margin: auto;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-line__ing {\n  position: absolute;\n  bottom: 0;\n  left: 50%;\n  height: 0%;\n  width: 3px;\n  margin-left: -1.5px;\n  background: #FDD000;\n  border-radius: 2px;\n  z-index: 1;\n}\n.mptcfe-player .mptcfe-player__control .control-volume-btn .volume-line__ball {\n  position: absolute;\n  display: inline-block;\n  top: -4px;\n  left: -2px;\n  width: 7px;\n  height: 7px;\n  border-radius: 50%;\n  background: #FFFFFF;\n  box-shadow: 0 0 4px 0 rgba(253, 208, 0, 0.8);\n}\n.mptcfe-player__hidden-control .mptcfe-player__control {\n  display: none;\n}\n.mptcfe-player {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  background-color: #000000;\n  font-size: 0;\n}\n.mptcfe-player .mptcfe-player__video {\n  width: 100%;\n  height: 100%;\n}\n.mptcfe-player__full-mode {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  z-index: 99;\n}\n.mptcfe-player__full-mode .mptcfe-player__video {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n.mptcfe-layer-conatiner {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  cursor: pointer;\n  background: rgba(255, 255, 255, 0);\n  z-index: 1;\n}\n.mptcfe-layer-conatiner .mptcfe-poster-logo {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  background-repeat: no-repeat;\n  background-size: cover;\n  text-align: center;\n}\n.mptcfe-layer-conatiner .mptcfe-poster-logo .mptcfe-repeat-btn {\n  display: none;\n  position: relative;\n  top: 40%;\n  width: 50px;\n  margin: 0 auto;\n  padding: 20px 30px;\n  font-size: 18px;\n  text-align: center;\n  color: #fff;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 10px;\n}\n.mptcfe-layer-conatiner .endedClass {\n  position: absolute;\n  top: -10%;\n  left: -10%;\n  width: 120%;\n  height: 120%;\n  background-size: cover;\n  background-repeat: no-repeat;\n  filter: blur(16px);\n}\n.mptcfe-layer-conatiner .endedClass::before {\n  content: '';\n  display: block;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.4);\n}\n.mptcfe-layer-conatiner .removeFilter {\n  filter: blur(0px);\n}\n.mptcfe-layer-conatiner .mptcfe-loading-layer {\n  display: none;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.2);\n  color: #fff;\n  z-index: 1;\n  pointer-events: none;\n}\n.mptcfe-layer-conatiner .mptcfe-loading-layer .loading-container {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 150px;\n  height: 75px;\n  margin-left: -75px;\n  margin-top: -40px;\n}\n.mptcfe-layer-conatiner .mptcfe-loading-layer .loading-container p {\n  margin: 0;\n  text-align: center;\n  font-size: 14px;\n}\n.mptcfe-layer-conatiner .mptcfe-loading-layer .loading-tip {\n  position: relative;\n  width: 150px;\n  margin: 0 auto;\n}\n.mptcfe-layer-conatiner .mptcfe-loading-layer .loading-tip .spinner1 {\n  margin: 15px auto 0;\n  width: 150px;\n  text-align: center;\n}\n.mptcfe-layer-conatiner .mptcfe-loading-layer .loading-tip .spinner1 div {\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  margin: 0 5px;\n  background-color: #FDD000;\n  border-radius: 100%;\n  animation: bouncedelay 1.4s infinite ease-in-out;\n  animation-fill-mode: both;\n}\n.mptcfe-layer-conatiner .mptcfe-loading-layer .loading-tip .spinner1 .bounce1 {\n  animation-delay: -0.32s;\n}\n.mptcfe-layer-conatiner .mptcfe-loading-layer .loading-tip .spinner1 .bounce2 {\n  animation-delay: -0.16s;\n}\n.mptcfe-layer-conatiner .mptcfe-warn-layer__box {\n  position: absolute;\n  display: none;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  background-color: #333333;\n  color: #fff;\n  z-index: 11;\n}\n.mptcfe-layer-conatiner .mptcfe-warn-layer__box p {\n  position: absolute;\n  top: 40%;\n  width: 100%;\n  font-size: 16px;\n  color: #DCDDDE;\n  text-align: center;\n}\n.mptcfe-layer-conatiner .mptcfe-warn-layer__box a {\n  color: #FDD000;\n}\n.mptcfe-layer-conatiner .mptcfe-warn-layer__box .mptcfe-error-layer {\n  display: none;\n}\n@keyframes bouncedelay {\n  0%,\n  80%,\n  100% {\n    transform: scale(0);\n  }\n  40% {\n    transform: scale(1);\n  }\n}\n.mptcfe-nosupport__box {\n  display: none;\n  width: 100%;\n  height: 100%;\n  background-color: #333333;\n  color: #fff;\n  z-index: 11;\n}\n.mptcfe-nosupport__box p {\n  position: absolute;\n  top: 40%;\n  width: 100%;\n  font-size: 16px;\n  color: #DCDDDE;\n  text-align: center;\n}\n.mptcfe-nosupport__box a {\n  color: #FDD000;\n}\n",""])},function(e,t){e.exports=function(e){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=function(e,t){var r=e[1]||"",i=e[3];if(!i)return r;if(t&&"function"==typeof btoa){var n=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(i);return[r].concat(i.sources.map(function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"})).concat([n]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r}).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},n=0;n<this.length;n++){var a=this[n][0];"number"==typeof a&&(i[a]=!0)}for(n=0;n<e.length;n++){var s=e[n];"number"==typeof s[0]&&i[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),t.push(s))}},t}},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAeCAYAAAA2Lt7lAAAAAXNSR0IArs4c6QAAAXVJREFUSA21lj1Lw1AUhhN1KFKcxF2cnASXTsXVwb/gIu4ujoIgCC7FSTdBXcRf4CAIIjgJOuoi+DEKRSsiWIzPHQpNc+6559Yk8NLkPec8b5LmK8mybBwdow56Ri00lZS1ANtCg0sbY7WUDEBXg/S+7QvWZ/4VBOCjDyitfmGuo9GhgiSix7vBn4sO8cB89g+FbVQzB/lIAf+eetMUEgBp5V+K+2hCDdIIxtoLfUveECPE0nZCU/EGtUxG9LzRu5w7mojhmNYzmiddUOqmconlbTyCalQZ4Hb1sOqA9kh5Z0QkdasOOK3yFN1yTAtVHcER8Gaapp0k5uI29D7Rs5j7NwxDlhb34NtD9RzcbVimAz0P1P2P7sCwVu5S3EH6y0cjKLU7avOF0yEZCkQqfWNuoDGJJXoSxeNd48+KEM1k6N0D7NmfrKyh4e4ZBi97JOH3HG9a28FgDcCmAHafjivBYUsDoBo6QO4L7xXtouK71QITev4A+o7/hUt8Zh8AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAeCAYAAAA2Lt7lAAAAAXNSR0IArs4c6QAAAh9JREFUSA21lj9oFEEUxr+3OTBYBCsrO4sIel5hYRUkhZ2NhWCTxghir41iI4qmFDEIWmglYmmTQgJiYeOfPYMKCgYsLFRIuKAg3O7zN+Lqsuzl9vZuF+5m5u3M73vfzNzNmH/RzvSbbpt0XNKGmx5FriXr6CvtsR9L3uiyUl3KkxDbNNN5RO7m43XqkbnmiwNd2pW67qSxVn1Ne4vvR2lHdO4MGoDQvCda867OuWtqUL/t4pbEgjP8Ycpe2pQW7YC6w3v/7xEcVHpwcMj7epF0ddXXNV1pEJ0qCwQgVlt8XfCeYqZtrorISAIZEDeziD3FzbJ/1EwWLytrCQQQIoabs/5Tbz3WsTJ4iNUWyIAI7Umlx7h5wLTtzuJZObZABsLNSabtHW4W/sWoVN6m+UHD6mzpFZvWgs3qeyMCIQFEPiFyuDGBvy7vNSqAi43JLXLZwrj6jQqwqx42NkVMz2vboSPNODDd59Cas33aapVNXd0YWX8GfIaTcCVjTMQB4PDPtGwt7c/Dg8jYDoB/IOvTUUfPsqzzZW0HQBNASzajDlmXwoNQLQfAu2R+iqxf5bMtq48kAPQXnytq6zplvwxYjFUWAPjcIg79tt4XIdu1W9jt8YsbeOwB/kGfizqom9Q5W0Z7IrZXPGgIwCfA2yzijTrwwI0ArBYFiG2yvRZZxKPA14vvR2lbuOOkW7rFFfIEP5fen8uvdA3wRC6/vwEyNJf0zpw3DQAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAeCAYAAAAo5+5WAAAAAXNSR0IArs4c6QAAAHJJREFUSA3tlkEKwDAIBE1/l/8/wfzDakkX015soLcVJGuISxg8KGbWPXVml814+UxDP67QTV/x7vjcHdpCZbPmkeuqfvoc1cav72gMYkRBFCAAwakgChCA4FQQBQhAcCoWFAOVSNbpuiRz74id65el8ARf7WRiu5esPwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAeCAYAAAAo5+5WAAAAAXNSR0IArs4c6QAAAI1JREFUSA3tlsENgCAMRQtz6Ao6h4swlIs4h66gc4itkdrAhd5/E+AX2nf46YGQD1pyppU4QqAUJtpEe6Ph3DudDB4ExOArzjR6oVLfcApUHq2W3BO2V3T0NHtqAVa3YAWsUAdUYCpghTqgAlMBK9QBFZiK3wr5VpXM6nLXe9re96vGWxLxrdQLqutqzgOJlig/I4LzWAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAnpJREFUSA3tlrtrVGEQxXd9osQgBDSFgmgjpDDx0VtbGpNCsBAEX434B9iJf4CFb6OpFOztrExiY5LGd6mV+BYCGnD9nbt39o5zv/0224iFA4eZOXPmO/du9t5No9VqXQQ/QC7mGQ41EgE/Ct7mlpl9A0eLdYpeZnbWRMKvwfCSCXrkOe2vAutSBwVugf5R4Ky9T/HOmkxeX8y6XNVteF1M38HeJvA4ce58cVhiYNQURV+m6GU2A1KRNLwRlHfoV2SKbhDMhv2brk8aNhFE07twWVPmMpsDPs7SjDmibqjPGIFMrzuhymmQNIWPZr/gzpRn9TZ0ptdY9DGlmQ+GG8ATJ5LZadNQe8OnBQ+ph1rRvuVSTa87vaqBixE7TBn+mJvJ7FSYb4b7UmpuFTOaITCh7MWq4WR6GSg+gEGvod8LfpY46WdWM9sJDoP2c2iDXEa8CwykNPBbhdTsP/dvfAL8fUbAPXAhXhHcALhSYkucJ3vE58Ab5SiA03P0EVjs8RrI4zYgPwO1Lw+cHq2X4FCxS7EEFEvhMH3lvdl7+o1Bo7tfBhbPKTqm1LttQJ4xww5nh0HI7FNn0DYes7nPaPQMR9NhaeD9m6bru3QfwhWZmTH6I8H0Bf0wyBsi2A8+Awu9XUbt4FxGNw78nRZ/NzuIXL9DyGj2x5ckZ6gZ+9HUn5c0tAvSnfVlZhfDnt6ber/GKAzXmDDkWfpJNiZLfqHZbD4ImqJFs5biBNjm5ovUB1xflfEyMv3Baquq0J/P7PhRcYf6FX9drWer5S7TbnyUvxKh37sd5HHQ7feqxWyRj/QhuRbsr4bUf9Xba8OK+E45zRlfK+ovVb8B8dwQykw6byEAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAA6dJREFUSA3tVktIFVEY/s6ohZG9Fr0oMFykWHq1ooerXgRBq0JLqBSkLBVatI0gaBUte2dGUBDVKsJelCu33muZlosWtqm4UgiWqHP6/nPnjGeud9RNrTowc/7H9//fef0zR02mcFEBZ7XGPMQ0pdCj5mGvKkM6G6L7kNATeMr4Ndk+qzN+hE+zqsADbzYyCWKyKoxjl03g9v4k6mYiC+KLiGkT2aMQOzObWGaIAryxutt7eXhI/xfXFiPPF3t+jLPDq0QTE/kx/tCsypGkstYa9ACK9G90aqDG2tzecxVHbvRTaOfs4/wOdEoMyJ7HkQkymlDh9lQ4Gvxe3JkrqR7EIj2GFyTbEeZQaA/lQIgQehU4AZdU4zhJO2YjNWSjJNPYbgk8D62exhWr2z5CyD3TAektC4DGMZLejSN1yLZJjMmh0MISmEYm/ghhGFCBk5Rvim6axlHZU6vaXg+hUI/iJQcTkrHMWlQlrlqM03O1ScgR9Yhg+0DWPKXNlG+IHrQGFnm5VUyfxiGSbRVZZqY0TpPsWohZjM8cwE/RtTKnGfnmCyJFnVVnkoDJTnFm48S3Uk+zYofCZCIo9JFE/ELYRjJ3gFDr8EP3olr5SKAQzwQ3p6bfoYSzW5gLTN8KeXL5/tv+yQrwEM3c5GT6EzjHIv6gErjgomVf6bskNtbXeR6ab64/p6xTOOMnMSh9NkAnUcVTmp5MQsuj36PSxfAENlofc/TlOjz0X2eOAWL3S6wicJQVWcip/vISWGATcgDVtL9iaSwzQOC7Wo5itRqjIYaz1+NIEmf+OiyNfuVhp9qIr4IhSanvoz+I72b+Gq4UK0ScQW/kDNnrkExhmAPa55KZJOWsQw/19E2YOI0y7eMtl3ql6Py5mdxGVhl52qeNo9pEciFbKkCOepjFvYf7Z75IJth58Zv5iJgjEdIJh9TBihgh5B5s5ghdsrTKx+44MpuLh+UxSQ87pKW853Qx+yqLsX2UcJJ7BiwRJxOkVR7JMn90i4/tSfoki3Q9B38/OyBKmE22AansgJl0QwrUcabm+2oH78bE3Wm6eRur5RWyVsAcVY8smxtoZe51AXrRxMuPuSbKJYh7LvecLRbj9jkJmeQAQfKYJkm4v3LcuzIW551CG/2XHYuc+Ngm/8NPsV7XoTLL5JoC2SxfDnvExEF8FIPS/SjGGA7y32bujRFURtH0JXn8O3P45JKcx52uJya8Kk7DaYygCPdUSeZnPM3/Nw1/AMssY+e/g91QAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAv1JREFUSA3tlktsTVEUhu+tIqGkDDxmIp6TihLBqAmJRERqQIlHOyEoAx1iIAzEXEgTNDEwEDUx8UoqolIjdECEiSAhVCOSCq1e33/sdbLOds/tbdKhlfx3Pff6z9777H1PoVQqHQMfwFlQLJQR4tNBTZlUgfhUISdXR+4aeAu2JDUYIjO5gpFpjL8dDIM3oN43xl8BBgMaotwM4r3A5JYRamZeunBSUuxul9wcNT3pcicsRywmU9kO5dX4OLgsJ0gb2s+01hJobyvs/ckKiAx1B6yXH+RosVi8LrsGo4TeDy4pEKQV3cXgdKaWqKSpn0n+Lljn6o7Acd785AlFihwgaOTK7wN6iSbJqUJEppmtdbXt9L7g/KwJqZg7xe5kxNlb/Qjip1zO140SP+Rrzc4sWVjegyQ7rQBd7QytTqt0mF4XXY/UTJaUp2khshfYS6AHGXE+ZtXyjcpmejaHET/Q53iAPvm1JHRor4IpCowho1E+9pXWWd0U1S3AX6mY3tKf6FdyxpDv5J9GNY/wy5FGZYV+CyRXGbOsI7AGJGfJkk5rX/p5uI8ulpiMXYyxMI47fwj7MWN/u9h/c+JWwPZQZ68N2LGIGbSHvaCDvUhfEvZvFjGdt0UgT7SHZxh3LynQsQD+lsDNlSbflaqO3MpsIn1L7Vg88Y0q2LovvcS+z3n7oTm2hE0ElgM7FjqkWirLY1Ytg1TuAZ/CiCGW82XuaFaiEQxkVyT1Kl3eaRHGCzC3HInuzFQoasS5D2aH4Fd0/tOFoqC0Lbp/JVqtHvrNSzz3kxKSXEVcZHrzJCLbCF7LqUJuU7MLVCRNCCFbTaEnG8DfwNrHdyfhfKH+BtmdwEiXYT+g/3wbVRPIdEbsi8zInlnReDSk3dS3ACNdit1jpJphJzCyL9ia2XO0yXsz0N5W+J3LpTbjbxIX6XDIi/R0YsPcBySfQUMoSBWxeqBPCe1PRojp/1Qf0sI/R4jYNvALSP5+22DMAa3SmW4T5NB3CdgNpk1Qy/G1+QPxSmPdXx1lPgAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAA9FJREFUSA3tVklsjVEU/u7tQ0xNWQgWImaptqYIVoTEhsRGSswLQxSJxkLYsZAm7EQjMQSJhGBtSoggbOhg7kLEEGLWtFRf/+M797379/7P62s1lu7L/8490/3OPfec+/+QBuyI6vCmowH7RWCQZ0g9BlJn86ggTeinT17dIwzqqMeZqB4vpQ6L1cZKhJ0CjESEXVQcy12YAS2j7Cvpc3mBknBheYgKacE79zSiPKF7isHSjssQrKD/KDHYlAG0OBUYrs8FpfFyBpQiHYtmzA1swSCXUFeij869ThTsJy5RHtsbi9MO0JZhNxN5zBuTrosacJwAPoWpWCfonFMYBXwE9FE7B9aGyyGYtdhmynBO9dYYiC3HBoIeVYEbgrUEPRGAek1ByrMsljZcod8cb0iwraYchzzvIlZQGm0kiPC3wSkFa8gbIyjyxgWpEKyVOxPM9nbWoIpghz2vNE5RFnQTz5DZwEZnJFhN2uHm3fyxvLcTzAWna5GvMhWozXXz5+TkLr0V2EzmiDckeo926O0cmGBLPjBd0+2QPVJJh9U8xxTLX5tRA0lTFmfAB9AtFXzj9pYyU0udreAHg6hhAHeVT7nGbcUppqOvS2ahFYXFHwxLPiGgjkGW8G9RYKbC0eSnqcya8WgjfaZMocEom9EfDxI2Brcoz8VMmCjDHTNvmcHsUcArCGnMYiSul7K6TlJEjUWDKcW7TmFmJo8xHr8wJlce8watvIPuMLAeFV/s93/S0wxkzrAOm3mw6+jUVRuwiHGbV2B1WCRsoSG8T2u5yLgCgK28uPfxLr2qNsa1RQtauGC3DW6LMJ+ON/zi7N9qluhBz3dFGWSjrci8vnxb3OvKOCGPUBzykUnyoS6cMz03Pe9SyFtgnnmIyXFbCKbRqLY3Nw1384XPKgK8dyBsC2blSRLQoJ0C15z8nJhOoJregOmiDHQIyQGem6Y/A6qK7Ehc3lmwa3QaqnpG+plPHJ13ykdpd4/Fk1Yd/Sfz0+U6L5ThubYxICtuBnelYBphBkywkNOmXKd8PH0vEXRFAjT9J6gDlEbMZEQh2CeTwgIzNefuzIcUyFgL5wm6PACdJGnc4PU3wptZB9aBq4zQfZHR4ZMpIlgp6rzR31CCXiBgZQA6kV9v1z2ofiYeicGAjw5sCuo9CHWv/Zw0nOtL85XXhXNm5mIWVItRz3Ri1I69Ote2cEIaeLD4VaIGthh7ou/4wAWfMfr7KotHOU7axmwvluFkLOdEQZm9Sr4jzjJofQs5HLAyh/FZqzR0+Fdz3kYTWJAr5S0G/Ks1/2qd36WLguks7/dvAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAeCAYAAABJ/8wUAAAAAXNSR0IArs4c6QAAAmpJREFUWAnFl89LVFEUx+epFC6EclUGunJhizZBEbRwmUqBItImkhR3QWB/gMukIqtV0aKFYLQxUMaVoITSOkGEVgraRpRo1c/X5zvdOxwezzdvlDf3wNdz7rnnx3fevTOeF5VOKHEcR5S4CYaA7Pkoij6gGyeQ6ATLICnPGsaCzvfAtyQDs75SKBkanQMLpqHM32AalLVw8rAwIjQYAfu+k9Nb6Ktqip4ye1OWCP4IDIB+2XYvt01iO5gDVv6yeA5afSHsLCIi4eWJz/G6RQa7Z1DTQLf/PKgl2wSM8u1YqRV4xP4kPXfIf1Hdx9EMPoG88obAtmoBY+DPeiI6mnemyS/sHp/ehHEDVM7YO1P0H3yrYIBPMQ6+p8RkusiJCbgL1lygTuOxs0sicskv0C9JSJMWnL2gbGLrNsn/QdIE0AeT6N5ckyEip2U4OfBGURoym9R+a+qPyBaREDJrmg7KDkXkI70PHZkujudCECIcj+7IF0dEKgwRR2DPEOkI8kQMgaoZkkhHlUWptBeECJezGRLdhshuECIQuA7OOiLbXN5gRO6Yp1EZK/VE9LPrpd0bRWmO5SK1R03997JF5LNx3icwTTSBrYB+E1u3Sf4pkl4B3RFJmWNZr1hsNmQMUDN62eFKH05PpyJN7ldOo8Br8PW/O/PvGLsbFOnNjEpsEt+H67ZxT9Jb/wDzC0U0KtqhhmWsUXEG5B0V+5Tk5Gn+7imRFDn28Kxy5Gtw1gxyvOHZcqLIUa8Tj9hbAl4e2LzCbLrVesG6XFjzZGHIdIG0V86ZZGyt9YnPCiKqMQxugZ9gkW/DPLou+QcQx8om7sBclQAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAeCAYAAABJ/8wUAAAAAXNSR0IArs4c6QAAA4xJREFUWAnFV0tPFEEQ/rp3xUeUKF4Qo8YD8QULBxNiJGo8IQ8TjUEuRqIGT2gIGv0LoihIPPjAR+JFL5iIwIlofEUTIyxoJB6MGvEkvg6K7E779YQeZnF2mQHJdDLb1dXV1V9XVVfXCsywKQWBOKosYDdVCSnQIWK4E1StCLrALa9eYaVK4BrBbHfzCa0lUoSGFN4Ug2kDUX04oIBz/LK99pBzUCI24LnXnBdPejEz8WiFXKsfd+mKdgOCp0lyTZMQ6HbWJrDFoX0QgYCoAVTTFYN0RaXRzc2H+G2OFOMEgTkWINCFRkb3Opa4vkLFUW7HlXuSdHTS2HNIK+RYCVywkqgxAtyc+tAmcnBSrMAvw0/bD6Kc6zvt+Tia2R9zy9pA1Dsstr7jFE1cReXL3AKatsZSOZR7LyRqZSHup874HCk0qn58EEU4b1ZIHiuifqCHjDovEEbQ6QXaxTwUiqAgCtDF23TL6OG+zXTVOjOWGEQZmSWG4dXrYKQrHkiJCl7LQ2ItfnrJZeJpV8oF2E9dj7UcDx1VSZw2a6KwEDMDSLRFYjjijP8zIfIxynirwxjiBBLhp4N3ExPgU8nonuvspzDi0LNEMLe8VgLXjXpLoVrTga6vWTzTni6+aXQIhV2aDgUICvCQMfNVA6B7VqkhLA8FCEEkieCtBmK3REhAxrcfHu/1A5EXikUcAC4iTCB5Do4IhkMBorM5s2y+AySKT6EAwQBKCWaJBmK/W2tCAsIkts9Yg8nNLiuZWzBqmISX49CzRDDFr2cSqzXqCeC2pqNMaXG7vtIjC/XJPtRr0t30o0eQj3j/m/gudLnngtAEkcXC6qJ+Z/Q66uviK/5E05JZroeMZ3qQrtkPlMJWy8K9ZD+uqDdYlE42E5/F1Q3GRqmWsV/0KI4beamznMhGGRmXOPnZTKTtFQ6q3xhgLbEtrYzHBF/ZHcym7gqvUT+ARtS+NWI1vrHmPCyLkcdeTP5YkS/lESaKGv0+WOildVrUR8w3ynz3EmdZnbW65X1dXyIfYUFUIyPYSwt+0QpoYpY6OKpG8JJlX8bCSssztrp1YUUdlSwxU+pVe17/BGkMuFwG3GUCmajkGcyMozMEWUS+djP4j6+Bp27xq5thMb025R8siY20wgu/2n25xkuZKMZVkYUYrdD7z7xAaxAQev20LWI2t2NlAHt4tXcyGfyhSzqZGzrMvN/+LzQVCc9MATOXAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAeCAYAAABJ/8wUAAAAAXNSR0IArs4c6QAAAu9JREFUWAmtlztoFUEUhhN8gIUgQUQRLQQbGxV8dQYL8YGIlWBnII0Q0MZKEAtR8IFYWAUbRQKmEBSx8AViISgEtEghWPkWRIyFoq7f2Ttn+HfY2bv3egf+O2fO+ec//53s3t0MDckoimIcvAWXwXwpZUN4q8EZMA3O2jpLbltA5BXwcZMga4baMJgAP4COTyzWte1Zy0PguCoS15ohb6fwIOHq8l5tg16SqJ1XReKKGdaHwbeEM8N6THJzvfTMchGsNUN+O/gLfPwmOA0WmpgnbU7FSa0ER0D3awjSPEMQvUCsozwZEvbNzcws2KoNWceh+aD3IhQ/M69N6+WawgFgx2vf8CvYFDbnTmYHnEWpGLk4amrPYrEoXhMvq3BI7BeCh13NVETCwjfbnNZJbQTfrRbGVIVD8rlXmP+AXwEfmTcYmbn2ZCpCHR7UzkhrtqayG+g1ti3yKFhjH0tiIQkg1F4zSnMRmzWvMaXrwrsfa5LMbnYy3EYzbbTg2G+QXYs2bF5a6pfL8OENm2aoWTPU4rF30Xgofcf6MmKbcmbI+63deLrwjoqRyb6NtDFTimc+MLFLjNz9LyPdzGQ8eM/1YmTGkzHXtDlXY3P2mmnYszk2LYqXAzFiIr2agX9IjDwamJFezWDipBi5OlAjvZjBxGMx0v/tW36DzAcNGq8Z6lvEhD1SVvmJ/JTCcuIFNRjO9K2k2edP7awZONPAx50oQEYfz05IZ3sPvQJG4saagLo+tWvNwIk/esSjUYaF/riwbBzvqO6Jm5Mg7Gxr5lqyvbz9diLyFMwBfw3QOfSI0yTR4lQoVjkZr5HLnUz5Jui8VjNie8F7aWThGzCqApb0keRrzSindUyDETDljcJsT9tLoHxt1FoqTG1wZkwcwYPgizYlthfpCcnFP40aoj5wM3ab35bGaXhLDWgM8WJCPqf1vmIE7VZM/9n6QG5NkyB1NdN56DVtaFNDdAU4BW6AE6Dz6tdlM7xj4AnYZ9R/anQpJSLUA+EAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAeCAYAAABJ/8wUAAAAAXNSR0IArs4c6QAABHhJREFUWAmtl12IVVUUx9c+dyYpofKjMCUpYjAw504QJhH4gYUQFYUkIgp+gUUvTtFDIPVUIlkRKD6oDyKEpD7k14MVJb0ERfeOJgqCkQ+T6IOUEM3MPbvfOveuc7d3zjn33MYN+6y919f+77XX/jhOguJHZKuP5UMfybFokQw7JxOBOLPpf5P5cUPedF4GvJcrUb/sdQvlj0zlAqYLZXFNLniRhcoDxFE3KGvzwDCok7q8jf5O6n3mB4c3XL8sA8xF45WhUajkIjlkfQZaTYS+hPYZz6hGAdk3scgXIQiV03/IT8inpluW3glkUHYxz91mnAUGABv9uJxHtsL0iEIdR5utD30+aJdq3gFELSpVeTcPDCCWAuAAs75fdQHQ4PMRS7HYDclB5WlBZ3qz1f76yzLP1+UtjWabm9PCQUWrihsjsrtRE281rstXyPp8TTbRjqmXcPxs6Mp0lYZ8baP/i/LJwxv+ogx0ypOI+PPyGgo1HP9LvUn/mcqgvJMVGanKISKx0s2Up11Vfup0mNv3zR0Iwtks7RnGeTjUjQj3q2y/4yhUqRXqg74hZxMwOcskg3LOPSr/hI66tQG/jR14W/WI7BOa6KFNBHOHMVCMMRinP53z5BTrOVSUM2ZXhpJDv+L/DSpzpXhZQ1SWmK1jScaQ9CsjekBmuMfllglDqjkjsQwbD4eTzpkwNypDmsuTCzqH4a5TCT6+jaqyUtuRgUgEOSBUluRM1D4fiGTuOaP6eYWT930QNhK5l2XsptnanrR98xwovxuYNOwFTlrH/zlVIQgVMu0VbfcERA2KwHDfbCkFxsnX6ksLSfmc0knHtzK7FQVDzuClmTO6TEKf7bzW1eE72d/FxyWTs0xztf2/gKhhVzCqlFcqMpre636KQHSMIjB5GFr8e1K5a57kPedI6qDVKMqZTt20HwdHvJebyp8yEHXSMxgeUWqnhZ1zVeldAaKOegHD4MvVRgsAfmzRpH9XPmXAcG0sZpct1QHZ6jEZclbbEZ0xbWhBaQ5K/Rk187huWrW/6a1dcALzensvtfByxi2Sa9qPWKSaCeJxGeXdMNZZuZyuN+qyF6AzTTeLpre2PiFywHDonbZDz1XkE/PjGGRVDDJjFFHCMsq7dguP6tNZenrpoXOLAV5gpj/nXZQ8ujfwDFjOxbje/CQhJ6QvMpsPOBGrRKi9x1taJFdyO5sRegeiabLdPSl/pzwadvsqmGhIZqgsFwyZQGSalx96CRA1KCoAfYn3yX5yZ47pYfg7M9/IzL83ngHRfvgMyAMDkPS/qdT2ZbBTro//HSdHbFCi9BjgviN3PvfX5F7jZ9Eyu6lURELnPJ7XkAh7iM4s4zOzyyThHnv+hUtjOkqLIlMqIqEznnxHiM5TDH7S+IBaYCASnpMfTBbSJDIinxkPu9XxiHys/Z6BqBGPmz954r2M8WZm/5fyrADwOnXY+p2U3FFZCgb7VaoDnVrhH+WReEK2sdsGIsf/7jTZ5xY0L7Iiz/w9bCcirwNgF++YE/8BE1oh5WGcno8AAAAASUVORK5CYII="},function(e,t,r){function i(e,t){for(var r=0;r<e.length;r++){var i=e[r],n=p[i.id];if(n){n.refs++;for(var a=0;a<n.parts.length;a++)n.parts[a](i.parts[a]);for(;a<i.parts.length;a++)n.parts.push(d(i.parts[a],t))}else{var s=[];for(a=0;a<i.parts.length;a++)s.push(d(i.parts[a],t));p[i.id]={id:i.id,refs:1,parts:s}}}}function n(e,t){for(var r=[],i={},n=0;n<e.length;n++){var a=e[n],s=t.base?a[0]+t.base:a[0],o={css:a[1],media:a[2],sourceMap:a[3]};i[s]?i[s].parts.push(o):r.push(i[s]={id:s,parts:[o]})}return r}function a(e,t){var r=m(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=E[E.length-1];if("top"===e.insertAt)i?i.nextSibling?r.insertBefore(t,i.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),E.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=m(e.insertAt.before,r);r.insertBefore(t,n)}}function s(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=E.indexOf(e);0<=t&&E.splice(t,1)}function o(e){var t=document.createElement("style");if(e.attrs.type===undefined&&(e.attrs.type="text/css"),e.attrs.nonce===undefined){var i=function(){return r.nc}();i&&(e.attrs.nonce=i)}return l(t,e.attrs),a(e,t),t}function l(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function d(e,t){var r,i,n,d;if(t.transform&&e.css){if(!(d="function"==typeof t.transform?t.transform(e.css):t.transform["default"](e.css)))return function(){};e.css=d}if(t.singleton){var u=y++;r=v=v||o(t),i=c.bind(null,r,u,!1),n=c.bind(null,r,u,!0)}else n=e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return e.attrs.type===undefined&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",l(t,e.attrs),a(e,t),t}(t),i=function(e,t,r){var i=r.css,n=r.sourceMap,a=t.convertToAbsoluteUrls===undefined&&n;(t.convertToAbsoluteUrls||a)&&(i=b(i)),n&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var s=new Blob([i],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(s),o&&URL.revokeObjectURL(o)}.bind(null,r,t),function(){s(r),r.href&&URL.revokeObjectURL(r.href)}):(r=o(t),i=function(e,t){var r=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),function(){s(r)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}function c(e,t,r,i){var n=r?"":i.css;if(e.styleSheet)e.styleSheet.cssText=A(t,n);else{var a=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(a,s[t]):e.appendChild(a)}}var u,h,f,p={},g=(u=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===h&&(h=u.apply(this,arguments)),h}),m=(f={},function(e,t){if("function"==typeof e)return e();if("undefined"==typeof f[e]){var r=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(h){r=null}f[e]=r}return f[e]}),v=null,y=0,E=[],b=r(21);e.exports=function(e,t){(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=g()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=n(e,t);return i(r,t),function(e){for(var a=[],s=0;s<r.length;s++){var o=r[s];(l=p[o.id]).refs--,a.push(l)}for(e&&i(n(e,t),t),s=0;s<a.length;s++){var l;if(0===(l=a[s]).refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete p[l.id]}}}};var T,A=(T=[],function(e,t){return T[e]=t,T.filter(Boolean).join("\n")})},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,i=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n,a=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(n=0===a.indexOf("//")?a:0===a.indexOf("/")?r+a:i+a.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(e,t,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){var t=o.call(this)||this;t.delayTime=300,t.options=e;var r=t._getAttribute(t.options),i=t._getVideoUrl(t.options);if(t.el=l.createEl("video",r),e.videoType&&"m3u8"===e.videoType.toLowerCase()||/.*\.(m3u8)$/i.test(e.url)){var n=new c;n.loadSource(i),n.attachMedia(t.el)}else t.el.setAttribute("src",i);return t._initPlayerStatus(),t.bindEvent(),t.onEvent(),t.bufferMonitor(),t.options.autoplay&&t.play(),t.flag=!0,t}var a,s=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o,l=r(0),d=r(1),c=r(25),u=(o=d.Component,s(n,o),n.prototype.onEvent=function(){var e=this;this.on(this.ACTION_EVENT_MAP.PLAY,function(){0===window.SOHU_MPTCFE_PLAYER.state&&e.play()}),this.on(this.ACTION_EVENT_MAP.PAUSE,function(){1===window.SOHU_MPTCFE_PLAYER.state&&e.pause()}),this.on(this.ACTION_EVENT_MAP.CHANGE_PROGRESS,function(t){var r=l.getPointerPosition(t.el,t.event);"object"===i(t)&&(e.el.currentTime=r.x*e.el.duration),e.play()}),this.on(this.ACTION_EVENT_MAP.CHANGE_VOLUME,function(t){e.setVolume(t)})},n.prototype.bindEvent=function(){var e=this;this.el.addEventListener("play",function(t){window.SOHU_MPTCFE_PLAYER.state=1,e.emit(e.VIDEO_EVENT_MAP.PLAY,e.el)}),this.el.addEventListener("pause",function(){1==window.SOHU_MPTCFE_PLAYER.state&&(window.SOHU_MPTCFE_PLAYER.state=0),e.emit(e.VIDEO_EVENT_MAP.PAUSE,e.el)}),this.el.addEventListener("ended",function(){1==window.SOHU_MPTCFE_PLAYER.state&&(window.SOHU_MPTCFE_PLAYER.state=0),e.flag=!0,e.emit(e.VIDEO_EVENT_MAP.ENDED,e.el)}),this.el.addEventListener("loadeddata",function(){e.emit(e.VIDEO_EVENT_MAP.LOADED,e.el)}),this.el.addEventListener("timeupdate",this.timeupdateFn.bind(this)),this.el.addEventListener("seeked",function(){e.emit(e.VIDEO_EVENT_MAP.SEEKED,e.el)}),this.el.addEventListener("seeking",function(){e.emit(e.VIDEO_EVENT_MAP.SEEKING,e.el)}),this.el.addEventListener("error",function(){window.SOHU_MPTCFE_PLAYER.state=-1,e.emit(e.VIDEO_EVENT_MAP.ERROR,e.el)})},n.prototype._getAttribute=function(e){return{"class":"mptcfe-player__video",poster:e.poster,autoplay:e.autoplay?"autoplay":undefined,autostart:e.autoplay?"autostart":undefined,muted:e.autoplay?"muted":undefined}},n.prototype._getVideoUrl=function(e){return e.url},n.prototype._initPlayerStatus=function(){window.SOHU_MPTCFE_PLAYER={state:0,
fullScreen:0,muted:0},this.options.autoplay&&this.setVolume(0),this.options.autoplay||this.setVolume(.5)},n.prototype.play=function(e){e&&e.url&&this.el.setAttribute("src",e.url),this.el.play()},n.prototype.pause=function(){this.el.pause()},n.prototype.setVolume=function(e){this.el.volume=e,window.SOHU_MPTCFE_PLAYER.muted=0==e?1:0},n.prototype.dispose=function(){},n.prototype.timeupdateFn=function(){this.VideoInfo={el:this.el,currentRatio:this.proccessMonitor(this.el),bufferedRatio:this.bufferMonitor(this.el)},.9<this.VideoInfo.currentRatio&&this.flag&&(this.flag=!1,this.emit(this.VIDEO_EVENT_MAP.NINETY_PERCENTY)),this.emit(this.VIDEO_EVENT_MAP.BUFFERUPDATE,this.VideoInfo),this.emit(this.VIDEO_EVENT_MAP.TIMEUPDATE,this.VideoInfo)},n.prototype.proccessMonitor=function(e){void 0===e&&(e=this.el);var t=e.currentTime,r=e.duration;return.9<t/r&&this.flag&&(this.flag=!1,this.emit(this.VIDEO_EVENT_MAP.NINETY_PERCENTY)),t/r},n.prototype.bufferMonitor=function(e){void 0===e&&(e=this.el);var t=e.duration;if(0<t)for(var r=0;r<e.buffered.length;r++)if(e.buffered.start(e.buffered.length-1-r)<e.currentTime)return e.buffered.end(e.buffered.length-1-r)/t},n);t.VideoHtml5=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computedStyle=function(e,t){if(!e||!t)return"";if("function"!=typeof window.getComputedStyle)return"";var r=window.getComputedStyle(e);return r?r[t]:""}},function(e,t,r){"use strict";function i(){this.event={}}Object.defineProperty(t,"__esModule",{value:!0});var n=(i.prototype.on=function(e,t){this.event[e]!==undefined?this.event[e].push(t):this.event[e]=[t]},i.prototype.once=function(e,t){var r="ONCE"+e;this.event[r]?this.event[r].push(t):this.event[r]=[t]},i.prototype.emit=function(e,t){this.event[e]!==undefined&&0<this.event[e].length&&this.event[e].forEach(function(e){"function"==typeof e&&e(t)}),this.event["ONCE"+e]!==undefined&&0<this.event["ONCE"+e].length&&(this.event["ONCE"+e].map(function(e){"function"==typeof e&&e(t)}),delete this.event["ONCE"+e])},i.prototype.off=function(e,t){var r=this;this.event[e]!==undefined&&0<this.event[e].length&&(t!==undefined?this.event[e].forEach(function(i,n){i===t&&r.event[e].splice(n,1)}):delete this.event[e])},i.prototype.clear=function(){this.event={}},i);t.EventEmitter=n},function(e,t,r){var i;"undefined"!=typeof window&&(i=function(){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return(r={},e.m=t={"./node_modules/eventemitter3/index.js":function(e,t,r){"use strict";function i(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new n(r,i||e,a),o=d?d+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],s]:e._events[o].push(s):(e._events[o]=s,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}var l=Object.prototype.hasOwnProperty,d="~";Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(d=!1)),o.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)l.call(e,t)&&r.push(d?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=d?d+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,a=new Array(n);i<n;i++)a[i]=r[i].fn;return a},o.prototype.listenerCount=function(e){var t=d?d+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,i,n,a){var s=d?d+e:e;if(!this._events[s])return!1;var o,l,c=this._events[s],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,undefined,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,n),!0;case 6:return c.fn.call(c.context,t,r,i,n,a),!0}for(l=1,o=new Array(u-1);l<u;l++)o[l-1]=arguments[l];c.fn.apply(c.context,o)}else{var h,f=c.length;for(l=0;l<f;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,undefined,!0),u){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,r);break;case 4:c[l].fn.call(c[l].context,t,r,i);break;default:if(!o)for(h=1,o=new Array(u-1);h<u;h++)o[h-1]=arguments[h];c[l].fn.apply(c[l].context,o)}}return!0},o.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,r,i){var n=d?d+e:e;if(!this._events[n])return this;if(!t)return s(this,n),this;var a=this._events[n];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,n);else{for(var o=0,l=[],c=a.length;o<c;o++)(a[o].fn!==t||i&&!a[o].once||r&&a[o].context!==r)&&l.push(a[o]);l.length?this._events[n]=1===l.length?l[0]:l:s(this,n)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=d?d+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=d,o.EventEmitter=o,e.exports=o},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){var i,n,a,s,o;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,n=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=o.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=o.normalizePath(i.path),o.buildURLFromParts(i)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=n.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var d={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(d.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,u=c.substring(0,c.lastIndexOf("/")+1)+a.path;d.path=o.normalizePath(u)}else d.path=s.path,a.params||(d.params=s.params,a.query||(d.query=s.query));return null===d.path&&(d.path=r.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(d)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},"./node_modules/webworkify-webpack/index.js":function(e,t,r){function i(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t.oe=function(e){throw console.error(e),e};var i=t(t.s=ENTRY_MODULE);return i["default"]||i}function n(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,i){var a={};a[i]=[];var s=t.toString(),d=s.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!d)return a;for(var c,u=d[1],h=new RegExp("(\\\\n|\\W)"+n(u)+l,"g");c=h.exec(s);)"dll-reference"!==c[3]&&a[i].push(c[3]);for(h=new RegExp("\\("+n(u)+'\\("(dll-reference\\s('+o+'))"\\)\\)'+l,"g");c=h.exec(s);)e[c[2]]||(a[i].push(c[1]),e[c[2]]=r(c[1]).m),a[c[2]]=a[c[2]]||[],a[c[2]].push(c[4]);for(var f,p=Object.keys(a),g=0;g<p.length;g++)for(var m=0;m<a[p[g]].length;m++)f=a[p[g]][m],isNaN(1*f)||(a[p[g]][m]=1*a[p[g]][m]);return a}function s(e){return Object.keys(e).reduce(function(t,r){return t||0<e[r].length},!1)}var o="[\\.|\\-|\\+|\\w|/|@]+",l="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+o+").*?\\)";e.exports=function(e,t){t=t||{};var n={main:r.m},o=t.all?{main:Object.keys(n.main)}:function(e,t){for(var r={main:[t]},i={main:[]},n={main:{}};s(r);)for(var o=Object.keys(r),l=0;l<o.length;l++){var d=o[l],c=r[d].pop();if(n[d]=n[d]||{},!n[d][c]&&e[d][c]){n[d][c]=!0,i[d]=i[d]||[],i[d].push(c);for(var u=a(e,e[d][c],d),h=Object.keys(u),f=0;f<h.length;f++)r[h[f]]=r[h[f]]||[],r[h[f]]=r[h[f]].concat(u[h[f]])}}return i}(n,e),l="";Object.keys(o).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;o[e][t];)t++;o[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map(function(t){return JSON.stringify(t)+": "+n[e][t].toString()}).join(",")+"});\n"}),l=l+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map(function(e){return JSON.stringify(e)+": "+n.main[e].toString()}).join(",")+"}))(self);";var d=new window.Blob([l],{type:"text/javascript"});if(t.bare)return d;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(d),u=new window.Worker(c);return u.objectURL=c,u}},"./src/crypt/decrypter.js":function(e,t,r){"use strict";r.r(t);var i=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),n=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),i=0;i<4;i++)r[i]=t.getUint32(4*i);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],n=r[1],a=r[2],s=r[3],o=this.invSubMix,l=o[0],d=o[1],c=o[2],u=o[3],h=new Uint32Array(256),f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4;m=m>>>8^255&m^99;var v=h[t[e[f]=m]=f],y=h[v],E=h[y],b=257*h[m]^16843008*m;i[f]=b<<24|b>>>8,n[f]=b<<16|b>>>16,a[f]=b<<8|b>>>24,s[f]=b,b=16843009*E^65537*y^257*v^16843008*f,l[m]=b<<24|b>>>8,d[m]=b<<16|b>>>16,c[m]=b<<8|b>>>24,u[m]=b,f?(f=v^h[h[h[E^v]]],p^=h[h[p]]):f=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,i=0;i<t.length&&r;)r=t[i]===this.key[i],i++;if(!r){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var a,s,o,l,d=this.ksRows=4*(n+6+1),c=this.keySchedule=new Uint32Array(d),u=this.invKeySchedule=new Uint32Array(d),h=this.sBox,f=this.rcon,p=this.invSubMix,g=p[0],m=p[1],v=p[2],y=p[3];for(a=0;a<d;a++)a<n?o=c[a]=t[a]:(l=o,a%n==0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=f[a/n|0]<<24):6<n&&a%n==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),c[a]=o=(c[a-n]^l)>>>0);for(s=0;s<d;s++)a=d-s,l=3&s?c[a]:c[a-4],u[s]=s<4||a<=4?l:g[h[l>>>24]]^m[h[l>>>16&255]]^v[h[l>>>8&255]]^y[h[255&l]],u[s]=u[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r,i){for(var n,a,s,o,l,d,c,u,h,f,p,g,m,v,y=this.keySize+6,E=this.invKeySchedule,b=this.invSBox,T=this.invSubMix,A=T[0],_=T[1],S=T[2],w=T[3],R=this.uint8ArrayToUint32Array_(r),k=R[0],L=R[1],D=R[2],C=R[3],x=new Int32Array(e),I=new Int32Array(x.length),O=this.networkToHostOrderSwap;t<x.length;){for(h=O(x[t]),f=O(x[t+1]),p=O(x[t+2]),g=O(x[t+3]),l=h^E[0],d=g^E[1],c=p^E[2],u=f^E[3],m=4,v=1;v<y;v++)n=A[l>>>24]^_[d>>16&255]^S[c>>8&255]^w[255&u]^E[m],a=A[d>>>24]^_[c>>16&255]^S[u>>8&255]^w[255&l]^E[m+1],s=A[c>>>24]^_[u>>16&255]^S[l>>8&255]^w[255&d]^E[m+2],o=A[u>>>24]^_[l>>16&255]^S[d>>8&255]^w[255&c]^E[m+3],l=n,d=a,c=s,u=o,m+=4;n=b[l>>>24]<<24^b[d>>16&255]<<16^b[c>>8&255]<<8^b[255&u]^E[m],a=b[d>>>24]<<24^b[c>>16&255]<<16^b[u>>8&255]<<8^b[255&l]^E[m+1],s=b[c>>>24]<<24^b[u>>16&255]<<16^b[l>>8&255]<<8^b[255&d]^E[m+2],o=b[u>>>24]<<24^b[l>>16&255]<<16^b[d>>8&255]<<8^b[255&c]^E[m+3],m+=3,I[t]=O(n^k),I[t+1]=O(o^L),I[t+2]=O(s^D),I[t+3]=O(a^C),k=h,L=f,D=p,C=g,t+=4}return i?function(e){var t=e.byteLength,r=t&&new DataView(e).getUint8(t-1);return r?e.slice(0,t-r):e}(I.buffer):I.buffer},t.destroy=function(){this.key=undefined,this.keySize=undefined,this.ksRows=undefined,this.sBox=undefined,this.invSBox=undefined,this.subMix=undefined,this.invSubMix=undefined,this.keySchedule=undefined,this.invKeySchedule=undefined,this.rcon=undefined},e}(),s=r("./src/errors.ts"),o=r("./src/utils/logger.js"),l=r("./src/events.js"),d=r("./src/utils/get-self-scope.js"),c=Object(d.getSelfScope)(),u=function(){function e(e,t,r){var i=(void 0===r?{}:r).removePKCS7Padding,n=void 0===i||i;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=n)try{var a=c.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(l){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,r,s){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.logger.log("JS AES decrypt"),this.logEnabled=!1);var d=this.decryptor;d||(this.decryptor=d=new a),d.expandKey(t),s(d.decrypt(e,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(o.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var c=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new n(c,t)),this.fastAesKey.expandKey().then(function(n){new i(c,r).decrypt(e,n)["catch"](function(i){l.onWebCryptoError(i,e,t,r,s)}).then(function(e){s(e)})})["catch"](function(i){l.onWebCryptoError(i,e,t,r,s)})}},t.onWebCryptoError=function(e,t,r,i,n){this.config.enableSoftwareAES?(o.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,i,n)):(o.logger.error("decrypting error : "+e.message),this.observer.trigger(l["default"].ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=undefined)},e}();t["default"]=u},"./src/demux/demuxer-inline.js":function(e,t,r){"use strict";function i(e,t){return 255===e[t]&&240==(246&e[t+1])}function n(e,t){return 1&e[t+1]?7:9}function a(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function s(e,t){return!!(t+1<e.length&&i(e,t))}function o(e,t){if(s(e,t)){var r=n(e,t);if(t+r>=e.length)return!1;var o=a(e,t);if(o<=r)return!1;var l=t+o;if(l===e.length||l+1<e.length&&i(e,l))return!0}return!1}function l(e,t,r,i,n){if(!e.samplerate){var a=function(e,t,r,i){var n,a,s,o,l,d=navigator.userAgent.toLowerCase(),c=i,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(n=1+((192&t[r+2])>>>6),a=(60&t[r+2])>>>2,!(u.length-1<a))return o=(1&t[r+2])<<2,o|=(192&t[r+3])>>>6,b.logger.log("manifest codec:"+i+",ADTS data:type:"+n+",sampleingIndex:"+a+"["+u[a]+"Hz],channelConfig:"+o),s=/firefox/i.test(d)?6<=a?(n=5,l=new Array(4),a-3):(n=2,l=new Array(2),a):-1!==d.indexOf("android")?(n=2,l=new Array(2),a):(n=5,l=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&6<=a?a-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(6<=a&&1==o||/vivaldi/i.test(d))||!i&&1==o)&&(n=2,l=new Array(2)),a)),l[0]=n<<3,l[0]|=(14&a)>>1,l[1]|=(1&a)<<7,l[1]|=o<<3,5===n&&(l[1]|=(14&s)>>1,l[2]=(1&s)<<7,l[2]|=8,l[3]=0),{config:l,samplerate:u[a],channelCount:o,codec:"mp4a.40."+n,manifestCodec:c};e.trigger(m["default"].ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+a})}(t,r,i,n);e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,b.logger.log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function d(e,t,r,i,s){var o,l,d=e.length;return o=n(e,t),l=a(e,t),0<(l-=o)&&t+o+l<=d?{headerLength:o,frameLength:l,stamp:r+i*s}:undefined}function c(e,t,r,i,n){var a=d(t,r,i,n,function(e){return 9216e4/e}(e.samplerate));if(a){var s=a.stamp,o=a.headerLength,l=a.frameLength,c={unit:t.subarray(r+o,r+o+l),pts:s,dts:s};return e.samples.push(c),{sample:c,length:l+o}}return undefined}function u(e,t,r,i){void 0===r&&(r=1),void 0===i&&(i=!1);var n=e*t*r;return i?Math.round(n):n}function h(e,t){return void 0===t&&(t=!1),u(e,1e3,1/9e4,t)}function f(e,t){return void 0===t&&(t=1),u(e,9e4,1/t)}function p(e,t){var r;if(t===undefined)return e;for(r=t<e?-8589934592:8589934592;4294967296<Math.abs(e-t);)e+=r;return e}r.r(t);var g,m=r("./src/events.js"),v=r("./src/errors.ts"),y=r("./src/crypt/decrypter.js"),E=r("./src/polyfills/number.js"),b=r("./src/utils/logger.js"),T=r("./src/utils/get-self-scope.js"),A=r("./src/demux/id3.js"),_=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(A["default"].getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(o(e,t))return b.logger.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,r,i){for(var n=this._audioTrack,a=A["default"].getID3Data(e,0)||[],o=A["default"].getTimeStamp(a),d=Object(E.isFiniteNumber)(o)?90*o:9e4*t,u=0,h=d,f=e.length,p=a.length,g=[{pts:h,dts:h,data:a}];p<f-1;)if(s(e,p)&&p+5<f){l(n,this.observer,e,p,n.manifestCodec);var m=c(n,e,p,d,u);if(!m){b.logger.log("Unable to parse AAC frame");break}p+=m.length,h=m.sample.pts,u++}else A["default"].isHeader(e,p)?(a=A["default"].getID3Data(e,p),g.push({pts:h,dts:h,data:a}),p+=a.length):p++;this.remuxer.remux(n,{samples:[]},{samples:g,inputTimeScale:9e4},{samples:[]},t,r,i)},t.destroy=function(){},e}(),S=r("./src/demux/mp4demuxer.js"),w={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,i,n){if(r+24>t.length)return undefined;var a=this.parseHeader(t,r);if(a&&r+a.frameLength<=t.length){var s=i+n*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(r,r+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),{sample:o,length:a.frameLength}}return undefined},parseHeader:function(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,n=e[t+2]>>4&15,a=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1==r||0==n||15==n||3==a)return undefined;var o=3==r?3-i:3==i?3:4,l=1e3*w.BitratesMap[14*o+n-1],d=3==r?0:2==r?1:2,c=w.SamplingRateMap[3*d+a],u=e[t+3]>>6==3?1:2,h=w.SamplesCoefficients[r][i],f=w.BytesInSlot[i],p=8*h*f;return{sampleRate:c,channelCount:u,frameLength:parseInt(h*l/c+s,10)*f,samplesPerFrame:p}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),i=4;r&&r.frameLength&&(i=r.frameLength);var n=t+i;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1}},R=w,k=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");i.set(e.subarray(r,r+n)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},t.skipBits=function(e){var t;this.bitsAvailable>e||(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return 32<e&&b.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=e-t)&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,r=8,i=8;for(t=0;t<e;t++)0!==i&&(i=(r+this.readEG()+256)%256),r=0===i?r:i},t.readSPS=function(){var e,t,r,i,n,a,s,o=0,l=0,d=0,c=0,u=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),m=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(u(),e=u(),h(5),g(3),u(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var E=f();if(3===E&&g(1),v(),v(),g(1),p())for(a=3!==E?8:12,s=0;s<a;s++)p()&&y(s<6?16:64)}v();var b=f();if(0===b)f();else if(1===b)for(g(1),m(),m(),t=f(),s=0;s<t;s++)m();v(),g(1),r=f(),i=f(),0===(n=h(1))&&g(1),g(1),p()&&(o=f(),l=f(),d=f(),c=f());var T=[1,1];if(p()&&p())switch(u()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[u()<<8|u(),u()<<8|u()]}return{width:Math.ceil(16*(r+1)-2*o-2*l),height:(2-n)*(i+1)*16-(n?2:4)*(d+c),pixelRatio:T}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),L=function(){function e(e,t,r,i){this.decryptdata=r,this.discardEPB=i,this.decrypter=new y["default"](e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,r,i){var n=e[t].unit,a=n.subarray(16,n.length-n.length%16),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),o=this;this.decryptBuffer(s,function(a){a=new Uint8Array(a),n.set(a,16),i||o.decryptAacSamples(e,t+1,r)})},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,i),!i)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),i=0,n=32;n<=e.length-16;n+=160,i+=16)r.set(e.subarray(n,n+16),i);return r},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,i=32;i<=e.length-16;i+=160,r+=16)e.set(t.subarray(r,r+16),i);return e},t.decryptAvcSample=function(e,t,r,i,n,a){var s=this.discardEPB(n.data),o=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(o.buffer,function(o){n.data=l.getAvcDecryptedUnit(s,o),a||l.decryptAvcSamples(e,t,r+1,i)})},t.decryptAvcSamples=function(e,t,r,i){for(;;t++,r=0){if(t>=e.length)return void i();for(var n=e[t].units;!(r>=n.length);r++){var a=n[r];if(!(a.data.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,i,a,s),!s)return}}}},e}(),D={video:1,audio:2,id3:3,text:4},C=function(){function e(e,t,r,i){this.observer=e,this.config=r,this.typeSupported=i,this.remuxer=t,this.sampleAes=null,this.pmtUnknownTypes={}}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new L(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0||(r&&b.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":undefined,type:e,id:D[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:undefined,isAAC:"audio"===e||undefined,duration:"audio"===e?t:undefined}},t.resetInitSegment=function(t,r,i,n){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=e.createTrack("video",n),this._audioTrack=e.createTrack("audio",n),this._id3Track=e.createTrack("id3",n),this._txtTrack=e.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=i,this._duration=n},t.resetTimeStamp=function(){},t.append=function(t,r,i,n){var a,s,o,l,d,c=t.length,u=!1;this.pmtUnknownTypes={},this.contiguous=i;var h=this.pmtParsed,f=this._avcTrack,p=this._audioTrack,g=this._id3Track,y=f.pid,E=p.pid,T=g.pid,A=this._pmtId,_=f.pesData,S=p.pesData,w=g.pesData,R=this._parsePAT,k=this._parsePMT.bind(this),L=this._parsePES,D=this._parseAVCPES.bind(this),C=this._parseAACPES.bind(this),x=this._parseMPEGPES.bind(this),I=this._parseID3PES.bind(this),O=e._syncOffset(t);for(c-=(c+O)%188,a=O;a<c;a+=188)if(71===t[a]){if(s=!!(64&t[a+1]),o=((31&t[a+1])<<8)+t[a+2],1<(48&t[a+3])>>4){if((l=a+5+t[a+4])===a+188)continue}else l=a+4;switch(o){case y:s&&(_&&(d=L(_))&&D(d,!1),_={data:[],size:0}),_&&(_.data.push(t.subarray(l,a+188)),_.size+=a+188-l);break;case E:s&&(S&&(d=L(S))&&(p.isAAC?C(d):x(d)),S={data:[],size:0}),S&&(S.data.push(t.subarray(l,a+188)),S.size+=a+188-l);break;case T:s&&(w&&(d=L(w))&&I(d),w={data:[],size:0}),w&&(w.data.push(t.subarray(l,a+188)),w.size+=a+188-l);break;case 0:s&&(l+=t[l]+1),A=this._pmtId=R(t,l);break;case A:s&&(l+=t[l]+1);var P=k(t,l,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(y=P.avc)&&(f.pid=y),0<(E=P.audio)&&(p.pid=E,p.isAAC=P.isAAC),0<(T=P.id3)&&(g.pid=T),u&&!h&&(b.logger.log("reparse from beginning"),u=!1,a=O-188),h=this.pmtParsed=!0;break;case 17:case 8191:break;default:u=!0}}else this.observer.trigger(m["default"].ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});_&&(d=L(_))?(D(d,!0),f.pesData=null):f.pesData=_,S&&(d=L(S))?(p.isAAC?C(d):x(d),p.pesData=null):(S&&S.size&&b.logger.log("last AAC PES packet truncated,might overlap between fragments"),p.pesData=S),w&&(d=L(w))?(I(d),g.pesData=null):g.pesData=w,null==this.sampleAes?this.remuxer.remux(p,f,g,this._txtTrack,r,i,n):this.decryptAndRemux(p,f,g,this._txtTrack,r,i,n)},t.decryptAndRemux=function(e,t,r,i,n,a,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){o.decryptAndRemuxAvc(e,t,r,i,n,a,s)})}else this.decryptAndRemuxAvc(e,t,r,i,n,a,s)},t.decryptAndRemuxAvc=function(e,t,r,i,n,a,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(e,t,r,i,n,a,s)})}else this.remuxer.remux(e,t,r,i,n,a,s)},t.destroy=function(){this._initPTS=this._initDTS=undefined,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._trackUnknownPmt=function(e,t,r){var i=this.pmtUnknownTypes[e]||0;return 0===i&&(this.pmtUnknownTypes[e]=0,t.call(b.logger,r)),this.pmtUnknownTypes[e]++,i},t._parsePMT=function(e,t,r,i){var n,a,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<n;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!i){this._trackUnknownPmt(e[t],b.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===s.audio&&(s.audio=a);break;case 21:-1===s.id3&&(s.id3=a);break;case 219:if(!i){this._trackUnknownPmt(e[t],b.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===s.avc&&(s.avc=a);break;case 3:case 4:r?-1===s.audio&&(s.audio=a,s.isAAC=!1):this._trackUnknownPmt(e[t],b.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(e[t],b.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(e[t],b.logger.log,"Unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},t._parsePES=function(e){var t,r,i,n,a,s,o,l,d=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&1<c.length;){var u=new Uint8Array(c[0].length+c[1].length);u.set(c[0]),u.set(c[1],c[0].length),c[0]=u,c.splice(1,1)}if(1!==((t=c[0])[0]<<16)+(t[1]<<8)+t[2])return null;if((i=(t[4]<<8)+t[5])&&i>e.size-6)return null;if(192&(r=t[7])&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&r?54e5<s-(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)&&(b.logger.warn(Math.round((s-o)/9e4)+"s delta between PTS and DTS, align them"),s=o):o=s),l=(n=t[8])+9,e.size<=l)return null;e.size-=l,a=new Uint8Array(e.size);for(var h=0,f=c.length;h<f;h++){var p=(t=c[h]).byteLength;if(l){if(p<l){l-=p;continue}t=t.subarray(l),p-=l,l=0}a.set(t,d),d+=p}return i&&(i-=n+3),{data:a,pts:s,dts:o,len:i}},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,i=r.length;if(isNaN(e.pts)){if(!i)return void t.dropped++;var n=r[i-1];e.pts=n.pts,e.dts=n.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(i||this.contiguous)?(e.id=i,r.push(e)):t.dropped++}e.debug.length&&b.logger.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var r,i,n,a=this,s=this._avcTrack,o=this._parseAVCNALu(e.data),l=this.avcSample,d=!1,c=this.pushAccesUnit.bind(this),u=function(e,t,r,i){return{key:e,pts:t,dts:r,units:[],debug:i}};e.data=null,l&&o.length&&!s.audFound&&(c(l,s),l=this.avcSample=u(!1,e.pts,e.dts,"")),o.forEach(function(t){switch(t.type){case 1:i=!0,(l=l||(a.avcSample=u(!0,e.pts,e.dts,""))).frame=!0;var o=t.data;if(d&&4<o.length){var h=new k(o).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:i=!0,(l=l||(a.avcSample=u(!0,e.pts,e.dts,""))).key=!0,l.frame=!0;break;case 6:i=!0,(r=new k(a.discardEPB(t.data))).readUByte();for(var f=0,p=0,g=!1,m=0;!g&&1<r.bytesAvailable;){for(f=0;f+=m=r.readUByte(),255===m;);for(p=0;p+=m=r.readUByte(),255===m;);if(4===f&&0!==r.bytesAvailable){if(g=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var v=r.readUByte(),y=31&v,E=[v,r.readUByte()];for(n=0;n<y;n++)E.push(r.readUByte()),E.push(r.readUByte()),E.push(r.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:E})}}else if(5===f&&0!==r.bytesAvailable){if(g=!0,16<p){var b=[];for(n=0;n<16;n++)b.push(r.readUByte().toString(16)),
3!==n&&5!==n&&7!==n&&9!==n||b.push("-");var T=p-16,_=new Uint8Array(T);for(n=0;n<T;n++)_[n]=r.readUByte();a._insertSampleInOrder(a._txtTrack.samples,{pts:e.pts,payloadType:f,uuid:b.join(""),userDataBytes:_,userData:Object(A.utf8ArrayToStr)(_.buffer)})}}else if(p<r.bytesAvailable)for(n=0;n<p;n++)r.readUByte()}break;case 7:if(d=i=!0,!s.sps){var S=(r=new k(t.data)).readSPS();s.width=S.width,s.height=S.height,s.pixelRatio=S.pixelRatio,s.sps=[t.data],s.duration=a._duration;var w=t.data.subarray(1,4),R="avc1.";for(n=0;n<3;n++){var L=w[n].toString(16);L.length<2&&(L="0"+L),R+=L}s.codec=R}break;case 8:i=!0,s.pps||(s.pps=[t.data]);break;case 9:i=!1,s.audFound=!0,l&&c(l,s),l=a.avcSample=u(!1,e.pts,e.dts,"");break;case 12:i=!1;break;default:i=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}l&&i&&l.units.push(t)}),t&&l&&(c(l,s),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var r=e.length;if(0<r){if(t.pts>=e[r-1].pts)e.push(t);else for(var i=r-1;0<=i;i--)if(t.pts<e[i].pts){e.splice(i,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var i=t.units;e=i[i.length-1]}return e},t._parseAVCNALu=function(e){var t,r,i,n,a=0,s=e.byteLength,o=this._avcTrack,l=o.naluState||0,d=l,c=[],u=-1;for(-1===l&&(n=31&e[u=0],l=0,a=1);a<s;)if(t=e[a++],l)if(1!==l)if(t)if(1===t){if(0<=u)i={data:e.subarray(u,a-l-1),type:n},c.push(i);else{var h=this._getLastNalUnit();if(h&&(d&&a<=4-d&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-d)),0<(r=a-l-1))){var f=new Uint8Array(h.data.byteLength+r);f.set(h.data,0),f.set(e.subarray(0,r),h.data.byteLength),h.data=f}}l=a<s?(n=31&e[u=a],0):-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(0<=u&&0<=l&&(i={data:e.subarray(u,s),type:n,state:l},c.push(i)),0===c.length){var p=this._getLastNalUnit();if(p){var g=new Uint8Array(p.data.byteLength+e.byteLength);g.set(p.data,0),g.set(e,p.data.byteLength),p.data=g}}return o.naluState=l,c},t.discardEPB=function(e){for(var t,r,i=e.byteLength,n=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=i-n.length,r=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===n[0]&&(s++,n.shift()),r[a]=e[s];return r},t._parseAACPES=function(e){var t,r,i,n,a,o,d,u=this._audioTrack,h=e.data,f=e.pts,p=this.aacOverFlow,g=this.aacLastPTS;if(p){var y=new Uint8Array(p.byteLength+h.byteLength);y.set(p,0),y.set(h,p.byteLength),h=y}for(r=0,n=h.length;r<n-1&&!s(h,r);r++);if(!r||(o=r<n-1?(a="AAC PES did not start with ADTS header,offset:"+r,!1):(a="no ADTS header found in AAC PES",!0),b.logger.warn("parsing error:"+a),this.observer.trigger(m["default"].ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:o,reason:a}),!o)){if(l(u,this.observer,h,r,this.audioCodec),t=0,d=u.samplerate,p&&g){var E=g+9216e4/d;1<Math.abs(E-f)&&(b.logger.log("AAC: align PTS for overlapping frames by "+Math.round((E-f)/90)),f=E)}for(;r<n;){if(s(h,r)){if(r+5<n){var T=c(u,h,r,f,t);if(T){r+=T.length,i=T.sample.pts,t++;continue}}break}r++}p=r<n?h.subarray(r,n):null,this.aacOverFlow=p,this.aacLastPTS=i}},t._parseMPEGPES=function(e){for(var t=e.data,r=t.length,i=0,n=0,a=e.pts;n<r;)if(R.isHeader(t,n)){var s=R.appendFrame(this._audioTrack,t,n,a,i);if(!s)break;n+=s.length,i++}else n++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),x=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,r,i=A["default"].getID3Data(e,0);if(i&&A["default"].getTimeStamp(i)!==undefined)for(t=i.length,r=Math.min(e.length-1,t+100);t<r;t++)if(R.probe(e,t))return b.logger.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,r,i){for(var n=A["default"].getID3Data(e,0)||[],a=A["default"].getTimeStamp(n),s=a!==undefined?90*a:9e4*t,o=n.length,l=e.length,d=0,c=0,u=this._audioTrack,h=[{pts:s,dts:s,data:n}];o<l;)if(R.isHeader(e,o)){var f=R.appendFrame(u,e,o,s,d);if(!f)break;o+=f.length,c=f.sample.pts,d++}else A["default"].isHeader(e,o)?(n=A["default"].getID3Data(e,o),h.push({pts:c,dts:c,data:n}),o+=n.length):o++;this.remuxer.remux(u,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,i)},t.destroy=function(){},e}(),I=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),O=Math.pow(2,32)-1,P=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:i};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n))},e.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),i=8,n=r.length,a=n;n--;)i+=r[n].byteLength;for((t=new Uint8Array(i))[0]=i>>24&255,t[1]=i>>16&255,t[2]=i>>8&255,t[3]=255&i,t.set(e,4),n=0,i=8;n<a;n++)t.set(r[n],i),i+=r[n].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var i=Math.floor(r/(1+O)),n=Math.floor(r%(1+O));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,r))},e.moov=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(i))},e.mvhd=function(t,r){r*=t;var i=Math.floor(r/(1+O)),n=Math.floor(r%(1+O)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var r,i,n=t.samples||[],a=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)r=n[i].flags,a[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,i,n,a=[],s=[];for(r=0;r<t.sps.length;r++)n=(i=t.sps[r]).byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(i));for(r=0;r<t.pps.length;r++)n=(i=t.pps[r]).byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(i));var o=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(s))),l=t.width,d=t.height,c=t.pixelRatio[0],u=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,u>>24,u>>16&255,u>>8&255,255&u])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,i=t.duration*t.timescale,n=t.width,a=t.height,s=Math.floor(i/(1+O)),o=Math.floor(i%(1+O));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,r){var i=e.sdtp(t),n=t.id,a=Math.floor(r/(1+O)),s=Math.floor(r%(1+O));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,i.length+16+20+8+16+8+8),i)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var i,n,a,s,o,l,d=t.samples||[],c=d.length,u=12+16*c,h=new Uint8Array(u);for(r+=8+u,h.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),i=0;i<c;i++)a=(n=d[i]).duration,s=n.size,o=n.flags,l=n.cts,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*i);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var r,i=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+i.byteLength)).set(e.FTYP),r.set(i,e.FTYP.byteLength),r},e}(),M=f(10),F=f(.2),N=null,U=function(){function e(e,t,r,i){if(this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,null===N){var n=navigator.userAgent.match(/Chrome\/(\d+)/i);N=n?parseInt(n[1]):0}}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,r=e.reduce(function(e,r){var i=r.pts-e;return i<-4294967296?(t=!0,p(e,r.pts)):0<i?e:r.pts},e[0].pts);return t&&b.logger.debug("PTS rollover detected"),r},t.remux=function(e,t,r,i,n,a,s){if(this.ISGenerated||this.generateIS(e,t,n),this.ISGenerated){var o=e.samples.length,l=t.samples.length,d=n,c=n;if(o&&l){var u=this.getVideoStartPts(t.samples),h=(p(e.samples[0].pts,u)-u)/t.inputTimeScale;d+=Math.max(0,h),c+=Math.max(0,-h)}if(o){e.timescale||(b.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,n));var f,g=this.remuxAudio(e,d,a,s);l&&(g&&(f=g.endPTS-g.startPTS),t.timescale||(b.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,n)),this.remuxVideo(t,c,a,f))}else if(l){var v=this.remuxVideo(t,c,a,0,s);v&&e.codec&&this.remuxEmptyAudio(e,d,a,v)}}r.samples.length&&this.remuxID3(r,n),i.samples.length&&this.remuxText(i,n),this.observer.trigger(m["default"].FRAG_PARSED)},t.generateIS=function(e,t,r){var i,n,a=this.observer,s=e.samples,o=t.samples,l=this.typeSupported,d="audio/mp4",c={},u={tracks:c},h=this._initPTS===undefined;if(h&&(i=n=Infinity),e.config&&s.length&&(e.timescale=e.samplerate,b.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(l.mpeg?(d="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3")),c.audio={container:d,codec:e.codec,initSegment:!e.isAAC&&l.mpeg?new Uint8Array:P.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(i=n=s[0].pts-Math.round(e.inputTimeScale*r))),t.sps&&t.pps&&o.length){var f=t.inputTimeScale;if(t.timescale=f,c.video={container:"video/mp4",codec:t.codec,initSegment:P.initSegment([t]),metadata:{width:t.width,height:t.height}},h){var g=this.getVideoStartPts(o),y=Math.round(f*r);n=Math.min(n,p(o[0].dts,g)-y),i=Math.min(i,g-y),this.observer.trigger(m["default"].INIT_PTS_FOUND,{initPTS:i})}}else h&&c.audio&&this.observer.trigger(m["default"].INIT_PTS_FOUND,{initPTS:i});Object.keys(c).length?(a.trigger(m["default"].FRAG_PARSING_INIT_SEGMENT,u),this.ISGenerated=!0,h&&(this._initPTS=i,this._initDTS=n)):a.trigger(m["default"].ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,r,i){var n,a,s,o,l,d=e.timescale,c=e.samples,u=[],f=c.length,g=this._initPTS,y=8,E=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,A=0,_=!1,S=this.nextAvcDts;if(0!==f){r||(S=t*d-(c[0].pts-p(c[0].dts,c[0].pts)));for(var w=0;w<f;w++){var R=c[w];R.pts=p(R.pts-g,S),R.dts=p(R.dts-g,S),R.dts>R.pts&&(A=Math.max(Math.min(A,R.pts-R.dts),-1*F)),R.dts<c[0<w?w-1:w].dts&&(_=!0)}_&&c.sort(function(e,t){var r=e.dts-t.dts,i=e.pts-t.pts;return r||i||e.id-t.id}),o=c[0].dts,l=c[f-1].dts;var k=Math.round((l-o)/(f-1));if(A<0){if(A<-2*k){b.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+h(-k,!0)+" ms");for(var L=A,D=0;D<f;D++)c[D].dts=L=Math.max(L,c[D].pts-k),c[D].pts=Math.max(L,c[D].pts)}else{b.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+h(A,!0)+" ms to overcome this issue");for(var C=0;C<f;C++)c[C].dts=c[C].dts+A}o=c[0].dts,l=c[f-1].dts}if(r){var x=o-S,I=k<x;if(I||x<-1){I?b.logger.warn("AVC: "+h(x,!0)+" ms ("+x+"dts) hole between fragments detected, filling it"):b.logger.warn("AVC: "+h(-x,!0)+" ms ("+x+"dts) overlapping between fragments detected"),o=S;var O=c[0].pts-x;c[0].dts=o,c[0].pts=O,b.logger.log("Video: First PTS/DTS adjusted: "+h(O,!0)+"/"+h(o,!0)+", delta: "+h(x,!0)+" ms")}}N&&N<75&&(o=Math.max(0,o));for(var M=0,U=0,B=0;B<f;B++){for(var G=c[B],j=G.units,V=j.length,K=0,H=0;H<V;H++)K+=j[H].data.length;U+=K,M+=V,G.length=K,G.dts=Math.max(G.dts,o),G.pts=Math.max(G.pts,G.dts,0),E=Math.min(G.pts,E),T=Math.max(G.pts,T)}l=c[f-1].dts;var Y=U+4*M+8;try{a=new Uint8Array(Y)}catch(ue){return void this.observer.trigger(m["default"].ERROR,{type:v.ErrorTypes.MUX_ERROR,details:v.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Y,reason:"fail allocating video mdat "+Y})}var z=new DataView(a.buffer);z.setUint32(0,Y),a.set(P.types.mdat,4);for(var q=0;q<f;q++){for(var W,X=c[q],Q=X.units,J=0,$=0,Z=Q.length;$<Z;$++){var ee=Q[$],te=ee.data,re=ee.data.byteLength;z.setUint32(y,re),y+=4,a.set(te,y),y+=re,J+=4+re}if(q<f-1)n=c[q+1].dts-X.dts;else{var ie=this.config,ne=X.dts-c[0<q?q-1:q].dts;if(ie.stretchShortVideoTrack){var ae=ie.maxBufferHole,se=Math.floor(ae*d),oe=(i?E+i*d:this.nextAudioPts)-X.pts;se<oe?((n=oe-ne)<0&&(n=ne),b.logger.log("It is approximately "+h(oe,!1)+" ms to the next segment; using duration "+h(n,!1)+" ms for the last video frame.")):n=ne}else n=ne}W=Math.round(X.pts-X.dts),u.push({size:J,duration:n,cts:W,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:X.key?2:1,isNonSync:X.key?0:1}})}this.nextAvcDts=l+n;var le=e.dropped;if(e.nbNalu=0,e.dropped=0,u.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var de=u[0].flags;de.dependsOn=2,de.isNonSync=0}e.samples=u,s=P.moof(e.sequenceNumber++,o,e),e.samples=[];var ce={data1:s,data2:a,startPTS:E/d,endPTS:(T+n)/d,startDTS:o/d,endDTS:this.nextAvcDts/d,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:le};return this.observer.trigger(m["default"].FRAG_PARSING_DATA,ce),ce}},t.remuxAudio=function(e,t,r,i){var n,a,s,o,l,d,c=e.inputTimeScale,u=e.timescale,f=c/u,g=(e.isAAC?1024:1152)*f,y=this._initPTS,E=!e.isAAC&&this.typeSupported.mpeg,T=E?0:8,A=e.samples,_=[],S=this.nextAudioPts;if(r|=A.length&&S&&(i&&Math.abs(t-S/c)<.1||Math.abs(A[0].pts-S-y)<20*g),A.forEach(function(e){e.pts=e.dts=p(e.pts-y,t*c)}),0!==(A=A.filter(function(e){return 0<=e.pts})).length){if(r||(S=i?Math.max(0,t*c):A[0].pts),e.isAAC)for(var w=this.config.maxAudioFramesDrift,R=0,k=S;R<A.length;){var L=A[R],D=L.pts,C=D-k;if(C<=-w*g)r||0<R?(b.logger.warn("Dropping 1 audio frame @ "+h(k,!0)/1e3+"s due to "+h(C,!0)+" ms overlap."),A.splice(R,1)):(b.logger.warn("Audio frame @ "+h(D,!0)/1e3+"s overlaps nextAudioPts by "+h(C,!0)+" ms."),k=D+g,R++);else if(w*g<=C&&C<M&&k){var x=Math.round(C/g);b.logger.warn("Injecting "+x+" audio frames @ "+h(k,!0)/1e3+"s due to "+h(C,!0)+" ms gap.");for(var O=0;O<x;O++){var F=Math.max(k,0);(a=I.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(b.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),a=L.unit.subarray()),A.splice(R,0,{unit:a,pts:F,dts:F}),k+=g,R++}L.pts=L.dts=k,k+=g,R++}else Math.abs(C),L.pts=L.dts=k,k+=g,R++}for(var N=A.length,U=0;N--;)U+=A[N].unit.byteLength;for(var B=0,G=A.length;B<G;B++){var j=A[B],V=j.unit,K=j.pts;if(d!==undefined&&n)n.duration=Math.round((K-d)/f);else{var H=K-S,Y=0;if(r&&e.isAAC&&H){if(0<H&&H<M)Y=Math.round((K-S)/g),b.logger.log(h(H,!0)+" ms hole between AAC samples detected,filling it"),0<Y&&(U+=Y*(a=(a=I.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||V.subarray()).length);else if(H<-12){b.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+h(S,!0)+" ms / "+h(K,!0)+" ms / "+h(-H,!0)+" ms"),U-=V.byteLength;continue}K=S}if(l=K,!(0<U))return;U+=T;try{s=new Uint8Array(U)}catch($){return void this.observer.trigger(m["default"].ERROR,{type:v.ErrorTypes.MUX_ERROR,details:v.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:U,reason:"fail allocating audio mdat "+U})}E||(new DataView(s.buffer).setUint32(0,U),s.set(P.types.mdat,4));for(var z=0;z<Y;z++)(a=I.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(b.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),a=V.subarray()),s.set(a,T),T+=a.byteLength,n={size:a.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},_.push(n)}s.set(V,T);var q=V.byteLength;T+=q,n={size:q,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},_.push(n),d=K}var W=0;if(2<=(N=_.length)&&(W=_[N-2].duration,n.duration=W),N){this.nextAudioPts=S=d+f*W,e.samples=_,o=E?new Uint8Array:P.moof(e.sequenceNumber++,l/f,e),e.samples=[];var X=l/c,Q=S/c,J={data1:o,data2:s,startPTS:X,endPTS:Q,startDTS:X,endDTS:Q,type:"audio",hasAudio:!0,hasVideo:!1,nb:N};return this.observer.trigger(m["default"].FRAG_PARSING_DATA,J),J}return null}},t.remuxEmptyAudio=function(e,t,r,i){var n=e.inputTimeScale,a=n/(e.samplerate?e.samplerate:n),s=this.nextAudioPts,o=(s!==undefined?s:i.startDTS*n)+this._initDTS,l=i.endDTS*n+this._initDTS,d=1024*a,c=Math.ceil((l-o)/d),u=I.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(b.logger.warn("remux empty Audio"),u){for(var h=[],f=0;f<c;f++){var p=o+f*d;h.push({unit:u,pts:p,dts:p})}e.samples=h,this.remuxAudio(e,t,r)}else b.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e,t){var r=e.samples.length;if(r){for(var i=e.inputTimeScale,n=this._initPTS,a=this._initDTS,s=0;s<r;s++){var o=e.samples[s];o.pts=p(o.pts-n,t*i)/i,o.dts=p(o.dts-a,t*i)/i}this.observer.trigger(m["default"].FRAG_PARSING_METADATA,{samples:e.samples}),e.samples=[]}},t.remuxText=function(e,t){var r=e.samples.length,i=e.inputTimeScale,n=this._initPTS;if(r){for(var a=0;a<r;a++){var s=e.samples[a];s.pts=p(s.pts-n,t*i)/i}e.samples.sort(function(e,t){return e.pts-t.pts}),this.observer.trigger(m["default"].FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e}(),B=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,r,i,n,a,s,o){var l=this.observer,d="";e&&(d+="audio"),t&&(d+="video"),l.trigger(m["default"].FRAG_PARSING_DATA,{data1:o,startPTS:n,startDTS:n,type:d,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),l.trigger(m["default"].FRAG_PARSED)},e}(),G=Object(T.getSelfScope)();try{g=G.performance.now.bind(G.performance)}catch(V){b.logger.debug("Unable to use Performance API on this environment"),g=G.Date.now}var j=function(){function e(e,t,r,i){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=i}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,r,i,n,a,s,o,l,d,c,u){var h=this;if(0<e.byteLength&&null!=t&&null!=t.key&&"AES-128"===t.method){var f=this.decrypter;null==f&&(f=this.decrypter=new y["default"](this.observer,this.config));var p=g();f.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var f=g();h.observer.trigger(m["default"].FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:f}}),h.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),i,n,a,s,o,l,d,c,u)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),i,n,a,s,o,l,d,c,u)},t.pushDecrypted=function(e,t,r,i,n,a,s,o,l,d,c,u){var h=this.demuxer,f=this.remuxer;if(!h||s||o){for(var p,g=this.observer,y=this.typeSupported,E=this.config,b=[{demux:C,remux:U},{demux:S["default"],remux:B},{demux:_,remux:U},{demux:x,remux:U}],T=0,A=b.length;T<A&&!(p=b[T]).demux.probe(e);T++);if(!p)return void g.trigger(m["default"].ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});f&&f instanceof p.remux||(f=new p.remux(g,E,y,this.vendor)),h&&h instanceof p.demux||(h=new p.demux(g,f,E,y),this.probe=p.demux.probe),this.demuxer=h,this.remuxer=f}(s||o)&&(h.resetInitSegment(r,i,n,d),f.resetInitSegment()),s&&(h.resetTimeStamp(u),f.resetTimeStamp(u)),"function"==typeof h.setDecryptData&&h.setDecryptData(t),h.append(e,a,l,c)},e}();t["default"]=j},"./src/demux/demuxer-worker.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/demux/demuxer-inline.js"),n=r("./src/events.js"),a=r("./src/utils/logger.js"),s=r("./node_modules/eventemitter3/index.js"),o=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var r=arguments.length,i=new Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];t.emit.apply(t,[e,e].concat(i))},t.off=function(e){for(var r=arguments.length,i=new Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];t.removeListener.apply(t,[e].concat(i))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(n){var s=n.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new i["default"](t,s.typeSupported,o,s.vendor),Object(a.enableLogs)(o.debug),r("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}}),t.on(n["default"].FRAG_DECRYPTED,r),t.on(n["default"].FRAG_PARSING_INIT_SEGMENT,r),t.on(n["default"].FRAG_PARSED,r),t.on(n["default"].ERROR,r),t.on(n["default"].FRAG_PARSING_METADATA,r),t.on(n["default"].FRAG_PARSING_USERDATA,r),t.on(n["default"].INIT_PTS_FOUND,r),t.on(n["default"].FRAG_PARSING_DATA,function(t,r){var i=[],n={event:t,data:r};r.data1&&(n.data1=r.data1.buffer,i.push(r.data1.buffer),delete r.data1),r.data2&&(n.data2=r.data2.buffer,i.push(r.data2.buffer),delete r.data2),e.postMessage(n,i)})};t["default"]=o},"./src/demux/id3.js":function(e,t,r){"use strict";r.r(t),r.d(t,"utf8ArrayToStr",function(){return s});var i,n=r("./src/utils/get-self-scope.js"),a=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var i=r,n=0;e.isHeader(t,r);)n+=10,n+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(n+=10),r+=n;return 0<n?t.subarray(i,i+n):undefined},e._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),i=0;i<r.length;i++){var n=r[i];if(e.isTimeStampFrame(n))return e._readTimeStamp(n)}return undefined},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),i=e._readSize(t,4);return{type:r,size:i,data:t.subarray(10,10+i)}},e.getID3Frames=function(t){for(var r=0,i=[];e.isHeader(t,r);){for(var n=e._readSize(t,r+6),a=(r+=10)+n;r+8<a;){var s=e._getFrameData(t.subarray(r)),o=e._decodeFrame(s);o&&i.push(o),r+=s.size+10}e.isFooter(t,r)&&(r+=10)}return i},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):e._decodeTextFrame(t)},e._readTimeStamp=function(e){if(8!==e.data.byteLength)return undefined;var t=new Uint8Array(e.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)},e._decodePrivFrame=function(t){if(t.size<2)return undefined;var r=e._utf8ArrayToStr(t.data,!0),i=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:i.buffer}},e._decodeTextFrame=function(t){if(t.size<2)return undefined;if("TXXX"===t.type){var r=1,i=e._utf8ArrayToStr(t.data.subarray(r),!0);r+=i.length+1;var n=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:n}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return undefined;var r=1,i=e._utf8ArrayToStr(t.data.subarray(r),!0);r+=i.length+1;var n=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:n}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var r=function(){var e=Object(n.getSelfScope)();return i||"undefined"==typeof e.TextDecoder||(i=new e.TextDecoder("utf-8")),i}();if(r){var a=r.decode(e);if(t){var s=a.indexOf("\0");return-1!==s?a.substring(0,s):a}return a.replace(/\0/g,"")}for(var o,l,d,c=e.length,u="",h=0;h<c;){if(0===(o=e[h++])&&t)return u;if(0!==o&&3!==o)switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(o);break;case 12:case 13:l=e[h++],u+=String.fromCharCode((31&o)<<6|63&l);break;case 14:l=e[h++],d=e[h++],u+=String.fromCharCode((15&o)<<12|(63&l)<<6|(63&d)<<0)}}return u},e}(),s=a._utf8ArrayToStr;t["default"]=a},"./src/demux/mp4demuxer.js":function(e,t,r){"use strict";r.r(t);var i=r("./src/utils/logger.js"),n=r("./src/events.js"),a=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,r,i,a){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==r&&(r="mp4a.40.5"),null==i&&(i="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:r+","+i,initSegment:a?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:r,initSegment:a?t:null}),s.video&&(o.video={container:"video/mp4",codec:i,initSegment:a?t:null})),this.observer.trigger(n["default"].FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else r&&(this.audioCodec=r),i&&(this.videoCodec=i)},e.probe=function(t){return 0<e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var i,n,a,s,o,l,d=[];if(t.data?(o=t.start,a=t.end,t=t.data):(o=0,a=t.byteLength),!r.length)return null;for(i=o;i<a;)l=1<(n=e.readUint32(t,i))?i+n:a,e.bin2str(t.subarray(i+4,i+8))===r[0]&&(1===r.length?d.push({data:t,start:i+8,end:l}):(s=e.findBox({data:t,start:i+8,end:l},r.slice(1))).length&&(d=d.concat(s))),i=l;return d},e.parseSegmentIndex=function(t){var r,i=e.findBox(t,["moov"])[0],n=i?i.end:null,a=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;r=[];var o=(s=s[0]).data[0],l=e.readUint32(s,a=0===o?8:16);a+=4,a+=0===o?8:16,a+=2;var d=s.end+0,c=e.readUint16(s,a);a+=2;for(var u=0;u<c;u++){var h=a,f=e.readUint32(s,h);h+=4;var p=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=e.readUint32(s,h);h+=4,r.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/l,start:d,end:d+p-1}}),d+=p,a=h+=4}return{earliestPresentationTime:0,timescale:l,version:o,referencesCount:c,references:r,moovEndOffset:n}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach(function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var a=n.data[n.start],s=0===a?12:20,o=e.readUint32(n,s),l=e.findBox(t,["mdia","mdhd"])[0];if(l){a=l.data[l.start];var d=e.readUint32(l,s=0===a?12:20),c=e.findBox(t,["mdia","hdlr"])[0];if(c){var u={soun:"audio",vide:"video"}[e.bin2str(c.data.subarray(c.start+8,c.start+12))];if(u){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var f=e.bin2str(h.data.subarray(h.start+12,h.start+16));i.logger.log("MP4Demuxer:"+u+":"+f+" found")}r[o]={timescale:d,type:u},r[u]={timescale:d,id:o}}}}}}),r},e.getStartDTS=function(t,r){var i,n,a;return i=e.findBox(r,["moof","traf"]),n=[].concat.apply([],i.map(function(r){
return e.findBox(r,["tfhd"]).map(function(i){var n,a;return n=e.readUint32(i,4),a=t[n].timescale||9e4,e.findBox(r,["tfdt"]).map(function(t){var r,i;return r=t.data[t.start],i=e.readUint32(t,4),1===r&&(i*=Math.pow(2,32),i+=e.readUint32(t,8)),i})[0]/a})})),a=Math.min.apply(null,n),isFinite(a)?a:0},e.offsetStartDTS=function(t,r,i){e.findBox(r,["moof","traf"]).map(function(r){return e.findBox(r,["tfhd"]).map(function(n){var s=e.readUint32(n,4),o=t[s].timescale||9e4;e.findBox(r,["tfdt"]).map(function(t){var r=t.data[t.start],n=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,n-i*o);else{n*=Math.pow(2,32),n+=e.readUint32(t,8),n-=i*o,n=Math.max(n,0);var s=Math.floor(n/(1+a)),l=Math.floor(n%(1+a));e.writeUint32(t,4,s),e.writeUint32(t,8,l)}})})})},t.append=function(t,r,i,a){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,l=this.initPTS;if(l===undefined){var d=e.getStartDTS(s,t);this.initPTS=l=d-r,this.observer.trigger(n["default"].INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(s,t,l),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,i,a,t)},t.destroy=function(){},e}();t["default"]=s},"./src/errors.ts":function(e,t,r){"use strict";var i,n,a,s;r.r(t),r.d(t,"ErrorTypes",function(){return i}),r.d(t,"ErrorDetails",function(){return a}),(n=i=i||{}).NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",(s=a=a||{}).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.INTERNAL_EXCEPTION="internalException"},"./src/events.js":function(e,t,r){"use strict";r.r(t),t["default"]={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},"./src/hls.ts":function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}function o(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):(null==t?void 0:t.programDateTime)&&(e.programDateTime=t.endProgramDateTime),Object(ae.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function l(){return window.MediaSource||window.WebKitMediaSource}function d(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}}function c(e,t,r){var i=e[t],n=e[r],a=n.startPTS;if(Object(ae.isFiniteNumber)(a))t<r?(i.duration=a-i.start,i.duration<0&&oe.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(n.duration=i.start-a,n.duration<0&&oe.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!"));else if(t<r){var s=i.cc===n.cc;n.start=i.start+(s&&i.minEndPTS?i.minEndPTS-i.start:i.duration)}else n.start=Math.max(i.start-n.duration,0)}function u(e,t,r,i,n,a){var s=r,o=i;if(Object(ae.isFiniteNumber)(t.startPTS)){var l=Math.abs(t.startPTS-r);Object(ae.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(l,t.deltaPTS):t.deltaPTS=l,s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),o=Math.min(i,t.endPTS),i=Math.max(i,t.endPTS),n=Math.min(n,t.startDTS),a=Math.max(a,t.endDTS)}var d=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=i,t.minEndPTS=o,t.startDTS=n,t.endDTS=a,t.duration=i-r;var u,h,f,p=t.sn;if(!e||p<e.startSN||p>e.endSN)return 0;for(u=p-e.startSN,(h=e.fragments)[u]=t,f=u;0<f;f--)c(h,f,f-1);for(f=u;f<h.length-1;f++)c(h,f,f+1);return e.PTSKnown=!0,d}function h(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var r,i=0;if(f(e,t,function(e,n){i=e.cc-n.cc,Object(ae.isFiniteNumber)(e.startPTS)&&(n.start=n.startPTS=e.startPTS,n.endPTS=e.endPTS,n.duration=e.duration,n.backtracked=e.backtracked,n.dropped=e.dropped,r=n),t.PTSKnown=!0}),t.PTSKnown){if(i){oe.logger.log("discontinuity sliding from playlist, take drift into account");for(var n=t.fragments,a=0;a<n.length;a++)n[a].cc+=i}r?u(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):function(e,t){var r=t.startSN-e.startSN,i=e.fragments,n=t.fragments;if(!(r<0||r>i.length))for(var a=0;a<n.length;a++)n[a].start+=i[r].start}(e,t),t.PTSKnown=e.PTSKnown}}function f(e,t,r){if(e&&t)for(var i=Math.max(e.startSN,t.startSN)-t.startSN,n=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,s=i;s<=n;s++){var o=e.fragments[a+s],l=t.fragments[s];if(!o||!l)break;r(o,l,s)}}function p(e,t,r){var i=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),n=i/2;return e&&t.endSN===e.endSN&&(i=n),r&&(i=Math.max(n,i-(window.performance.now()-r))),Math.round(i)}function g(e,t){var r=e.fragments,i=t.fragments;if(i.length&&r.length){var n=function(e,t){for(var r=null,i=0;i<e.length;i+=1){var n=e[i];if(n&&n.cc===t){r=n;break}}return r}(r,i[0].cc);if(n&&(!n||n.startPTS))return n;oe.logger.log("No frag in previous level to align on")}else oe.logger.log("No fragments to align")}function m(e,t){t.fragments.forEach(function(t){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}}),t.PTSKnown=!0}function v(e,t,r){!function(e,t,r){if(function(e,t,r){var i=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(i=!0),i}(e,r,t)){var i=g(r.details,t);i&&(oe.logger.log("Adjusting PTS using last level due to CC increase within current level"),m(i.start,t))}}(e,r,t),!r.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=t.fragments[0].programDateTime,i=(e.fragments[0].programDateTime-r)/1e3+t.fragments[0].start;Object(ae.isFiniteNumber)(i)&&(oe.logger.log("adjusting PTS using programDateTime delta, sliding:"+i.toFixed(3)),m(i,e))}}(r,t.details)}function y(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!Object(ae.isFiniteNumber)(t))return null;var i,n,a,s,o;if(t<(e[0].programDateTime||0))return null;if((e[e.length-1].endProgramDateTime||0)<=t)return null;r=r||0;for(var l=0;l<e.length;++l){var d=e[l];if(i=t,n=r,a=d,s=1e3*Math.min(n,a.duration+(a.deltaPTS?a.deltaPTS:0)),o=a.endProgramDateTime||0,i<o-s)return d}return null}function E(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=null;return e?n=t[e.sn-t[0].sn+1]:0===r&&0===t[0].start&&(n=t[0]),n&&0===b(r,i,n)?n:Me.search(t,b.bind(null,r,i))||n}function b(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=e?1:r.start-i>e&&r.start?-1:0}function T(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function A(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _(e,t){var r;try{r=new Event("addtrack")}catch($){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function S(e){if(null==e?void 0:e.cues)for(;0<e.cues.length;)e.removeCue(e.cues[0])}function w(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function R(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function k(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function L(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function D(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new kt,this.regionList=[]}function C(){this.values=Object.create(null)}function x(e,t,r,i){var n=i?e.split(i):[e];for(var a in n)if("string"==typeof n[a]){var s=n[a].split(r);2===s.length&&t(s[0],s[1])}}function I(e,t,r){function i(){var t=function(e){function t(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):59<r[1]?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+a);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function n(){e=e.replace(/^\s+/,"")}var a=e;if(n(),t.startTime=i(),n(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+a);e=e.substr(3),n(),t.endTime=i(),n(),function(e,t){var i=new C;x(e,function(e,t){switch(e){case"region":for(var n=r.length-1;0<=n;n--)if(r[n].id===t){i.set(e,r[n].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];i.integer(e,s),i.percent(e,s)&&i.set("snapToLines",!1),i.alt(e,s,["auto"]),2===a.length&&i.alt("lineAlign",a[1],["start",Dt,"end"]);break;case"position":a=t.split(","),i.percent(e,a[0]),2===a.length&&i.alt("positionAlign",a[1],["start",Dt,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",Dt,"end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");var n=i.get("line","auto");"auto"===n&&-1===Lt.line&&(n=-1),t.line=n,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",Dt);var a=i.get("position","auto");"auto"===a&&50===Lt.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function O(e){return e.replace(/<br(?: \/)?>/gi,"\n")}function P(e,t,r,i){for(var n,a,s,o,l,d=[],c=window.VTTCue||TextTrackCue,u=0;u<i.rows.length;u++)if(s=!0,o=0,l="",!(n=i.rows[u]).isEmpty()){for(var h=0;h<n.chars.length;h++)n.chars[h].uchar.match(/\s/)&&s?o++:(l+=n.chars[h].uchar,s=!1);(n.cueStartTime=t)===r&&(r+=1e-4),a=new c(t,r,O(l.trim())),16<=o?o--:o++,navigator.userAgent.match(/Firefox\//)?a.line=u+1:a.line=7<u?u-2:u+1,a.align="left",a.position=Math.max(0,Math.min(100,o/32*100)),d.push(a),e&&e.addCue(a)}return d}function M(e,t,r){r.a=e,r.b=t}function F(e,t,r){return r.a===e&&r.b===t}function N(){return{a:null,b:null}}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,"new":!1}}}function G(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function j(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];"subtitles"===i.kind&&i.label&&t.push(e[r])}return t}function V(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach(function(t){Y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach(function(t){W(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function J(e,t,r){return t&&Q(e.prototype,t),r&&Q(e,r),e}r.r(t),r.d(t,"default",function(){return ur});var $={};r.r($),r.d($,"newCue",function(){return P});var Z,ee,te,re,ie=r("./node_modules/url-toolkit/src/url-toolkit.js"),ne=r("./src/errors.ts"),ae=r("./src/polyfills/number.js"),se=r("./src/events.js"),oe=r("./src/utils/logger.js"),le={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},de=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(le[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){var i=function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)};try{i.call(this,e,t).call()}catch(r){oe.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.OTHER_ERROR,details:ne.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:r})}},e}();(ee=Z=Z||{}).MANIFEST="manifest",ee.LEVEL="level",ee.AUDIO_TRACK="audioTrack",ee.SUBTITLE_TRACK="subtitleTrack",(re=te=te||{}).MAIN="main",re.AUDIO="audio",re.SUBTITLE="subtitle";var ce,ue,he=r("./src/demux/mp4demuxer.js"),fe=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}return function(e,t,r){t&&i(e.prototype,t),r&&i(e,r)}(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(ie.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}();(ue=ce=ce||{}).AUDIO="audio",ue.VIDEO="video";var pe,ge=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[ce.AUDIO]=!1,e[ce.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t=e.prototype;return t.setByteRange=function(e,t){var r=e.split("@",2),i=[];1===r.length?i[0]=t?t.byteRangeEndOffset:0:i[0]=parseInt(r[1]),i[1]=parseInt(r[0])+i[0],this._byteRange=i},t.addElementaryStream=function(e){this._elementaryStreams[e]=!0},t.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},t.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},t.setDecryptDataFromLevelKey=function(e,t){var r=e;return(null==e?void 0:e.method)&&e.uri&&!e.iv&&((r=new fe(e.baseuri,e.reluri)).method=e.method,r.iv=this.createInitializationVector(t)),r},function(e,t,r){t&&n(e.prototype,t),r&&n(e,r)}(e,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(ie.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&oe.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(ae.isFiniteNumber)(this.programDateTime))return null;var e=Object(ae.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}]),e}(),me=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}return function(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}(e,[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(ae.isFiniteNumber)(this.fragments[0].programDateTime))}}]),e}(),ve=/^(\d+)x(\d+)$/,ye=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,Ee=function(){function e(t){for(var r in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?Infinity:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?Infinity:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=ve.exec(this[e]);return null===t?undefined:{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,r={};for(ye.lastIndex=0;null!==(t=ye.exec(e));){var i=t[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),r[t[1]]=i}return r},e}(),be={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}},Te=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,Ae=/#EXT-X-MEDIA:(.*)/g,_e=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),Se=/\.(mp4|m4s|m4v|m4a)$/i,we=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var i=e[r];if(i.id===t)return i}},e.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return 2<r.length?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return ie.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,r){var i,n=[],a={},s=!1;for(Te.lastIndex=0;null!=(i=Te.exec(t));)if(i[1]){var o={},l=o.attrs=new Ee(i[1]);o.url=e.resolve(i[2],r);var d=l.decimalResolution("RESOLUTION");d&&(o.width=d.width,o.height=d.height),o.bitrate=l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),o.name=l.NAME,function(e,t){["video","audio"].forEach(function(r){var i=e.filter(function(e){return function(e,t){var r=be[t];return!!r&&!0===r[e.slice(0,4)]}(e,r)});if(i.length){var n=i.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});t[r+"Codec"]=0<n.length?n[0]:i[0],e=e.filter(function(e){return-1===i.indexOf(e)})}}),t.unknownCodecs=e}([].concat((l.CODECS||"").split(/[ ,]+/)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=e.convertAVC1ToAVCOTI(o.videoCodec)),n.push(o)}else if(i[3]){var c=new Ee(i[3]);c["DATA-ID"]&&(s=!0,a[c["DATA-ID"]]=c)}return{levels:n,sessionData:s?a:null}},e.parseMasterPlaylistMedia=function(t,r,i,n){var a;void 0===n&&(n=[]);var s=[],o=0;for(Ae.lastIndex=0;null!==(a=Ae.exec(t));){var l=new Ee(a[1]);if(l.TYPE===i){var d={attrs:l,id:o++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE,type:i,"default":"YES"===l.DEFAULT,autoselect:"YES"===l.AUTOSELECT,forced:"YES"===l.FORCED,lang:l.LANGUAGE};if(l.URI&&(d.url=e.resolve(l.URI,r)),n.length){var c=e.findGroup(n,d.groupId);d.audioCodec=c?c.codec:n[0].codec}s.push(d)}}return s},e.parseLevelPlaylist=function(e,t,r,i,n){var a,s,l,d=0,c=0,u=new me(t),h=0,f=null,p=new ge,g=null;for(_e.lastIndex=0;null!==(a=_e.exec(e));){var m=a[1];if(m){p.duration=parseFloat(m);var v=(" "+a[2]).slice(1);p.title=v||null,p.tagList.push(v?["INF",m,v]:["INF",m])}else if(a[3]){if(Object(ae.isFiniteNumber)(p.duration)){var y=d++;p.type=i,p.start=c,l&&(p.levelkey=l),p.sn=y,p.level=r,p.cc=h,p.urlId=n,p.baseurl=t,p.relurl=(" "+a[3]).slice(1),o(p,f),u.fragments.push(p),c+=(f=p).duration,p=new ge}}else if(a[4]){var E=(" "+a[4]).slice(1);f?p.setByteRange(E,f):p.setByteRange(E)}else if(a[5])p.rawProgramDateTime=(" "+a[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),null===g&&(g=u.fragments.length);else{if(!(a=a[0].match(/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/))){oe.logger.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<a.length&&"undefined"==typeof a[s];s++);var b=(" "+a[s+1]).slice(1),T=(" "+a[s+2]).slice(1);switch(a[s]){case"#":p.tagList.push(T?[b,T]:[b]);break;case"PLAYLIST-TYPE":u.type=b.toUpperCase();break;case"MEDIA-SEQUENCE":d=u.startSN=parseInt(b);break;case"TARGETDURATION":u.targetduration=parseFloat(b);break;case"VERSION":u.version=parseInt(b);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"DIS":h++,p.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":h=parseInt(b);break;case"KEY":var A=new Ee(b),_=A.enumeratedString("METHOD"),S=A.URI,w=A.hexadecimalInteger("IV");if("com.apple.streamingkeydelivery"===(A.KEYFORMAT||"identity")){oe.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}_&&(l=new fe(t,S),S&&0<=["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(_)&&(l.method=_,l.key=null,l.iv=w));break;case"START":var R=new Ee(b).decimalFloatingPoint("TIME-OFFSET");Object(ae.isFiniteNumber)(R)&&(u.startTimeOffset=R);break;case"MAP":var k=new Ee(b);p.relurl=k.URI,k.BYTERANGE&&p.setByteRange(k.BYTERANGE),p.baseurl=t,p.level=r,p.type=i,p.sn="initSegment",u.initSegment=p,(p=new ge).rawProgramDateTime=u.initSegment.rawProgramDateTime;break;default:oe.logger.warn("line parsed but not handled: "+a)}}}return(p=f)&&!p.relurl&&(u.fragments.pop(),c-=p.duration),u.totalduration=c,u.averagetargetduration=c/u.fragments.length,u.endSN=d-1,u.startCC=u.fragments[0]?u.fragments[0].cc:0,u.endCC=h,!u.initSegment&&u.fragments.length&&u.fragments.every(function(e){return Se.test(e.relurl)})&&(oe.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(p=new ge).relurl=u.fragments[0].relurl,p.baseurl=t,p.level=r,p.type=i,p.sn="initSegment",u.initSegment=p,u.needSidxRanges=!0),g&&function(e,t){for(var r=e[t],i=t-1;0<=i;i--){var n=e[i];n.programDateTime=r.programDateTime-1e3*n.duration,r=n}}(u.fragments,g),u},e}(),Re=window.performance,ke=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].MANIFEST_LOADING,se["default"].LEVEL_LOADING,se["default"].AUDIO_TRACK_LOADING,se["default"].SUBTITLE_TRACK_LOADING)||this).loaders={},r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e),t.canHaveQualityLevels=function(e){return e!==Z.AUDIO_TRACK&&e!==Z.SUBTITLE_TRACK},t.mapContextToLevelType=function(e){switch(e.type){case Z.AUDIO_TRACK:return te.AUDIO;case Z.SUBTITLE_TRACK:return te.SUBTITLE;default:return te.MAIN}},t.getResponseUrl=function(e,t){var r=e.url;return r!==undefined&&0!==r.indexOf("data:")||(r=t.url),r};var r=t.prototype;return r.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,i=t.loader,n=new(r||i)(t);return e.loader=n,this.loaders[e.type]=n},r.getInternalLoader=function(e){return this.loaders[e.type]},r.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},r.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},r.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},r.onManifestLoading=function(e){this.load({url:e.url,type:Z.MANIFEST,level:0,id:null,responseType:"text"})},r.onLevelLoading=function(e){this.load({url:e.url,type:Z.LEVEL,level:e.level,id:e.id,responseType:"text"})},r.onAudioTrackLoading=function(e){this.load({url:e.url,type:Z.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},r.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:Z.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},r.load=function(e){var t=this.hls.config;oe.logger.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var r,i,n,a,s=this.getInternalLoader(e);if(s){var o=s.context;if(o&&o.url===e.url)return oe.logger.trace("playlist request ongoing"),!1;oe.logger.warn("aborting previous loader for type: "+e.type),s.abort()}switch(e.type){case Z.MANIFEST:r=t.manifestLoadingMaxRetry,i=t.manifestLoadingTimeOut,n=t.manifestLoadingRetryDelay,a=t.manifestLoadingMaxRetryTimeout;break;case Z.LEVEL:n=a=r=0,i=t.levelLoadingTimeOut;break;default:r=t.levelLoadingMaxRetry,i=t.levelLoadingTimeOut,n=t.levelLoadingRetryDelay,a=t.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(e);var l={timeout:i,maxRetry:r,retryDelay:n,maxRetryDelay:a},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return oe.logger.debug("Calling internal loader delegate for URL: "+e.url),s.load(e,l,d),!0},r.loadsuccess=function(e,t,r,i){if(void 0===i&&(i=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,i);if(this.resetInternalLoader(r.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var n=e.data;t.tload=Re.now(),0===n.indexOf("#EXTM3U")?0<n.indexOf("#EXTINF:")||0<n.indexOf("#EXT-X-TARGETDURATION:")?this._handleTrackOrLevelPlaylist(e,t,r,i):this._handleMasterPlaylist(e,t,r,i):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",i)},r.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},r.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},r._handleMasterPlaylist=function(e,r,i,n){var a=this.hls,s=e.data,o=t.getResponseUrl(e,i),l=we.parseMasterPlaylist(s,o),d=l.levels,c=l.sessionData;if(d.length){
var u=d.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),h=we.parseMasterPlaylistMedia(s,o,"AUDIO",u),f=we.parseMasterPlaylistMedia(s,o,"SUBTITLES"),p=we.parseMasterPlaylistMedia(s,o,"CLOSED-CAPTIONS");if(h.length){var g=!1;h.forEach(function(e){e.url||(g=!0)}),!1===g&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(oe.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main","default":!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}a.trigger(se["default"].MANIFEST_LOADED,{levels:d,audioTracks:h,subtitles:f,captions:p,url:o,stats:r,networkDetails:n,sessionData:c})}else this._handleManifestParsingError(e,i,"no level found in manifest",n)},r._handleTrackOrLevelPlaylist=function(e,r,i,n){var a=this.hls,s=i.id,o=i.level,l=i.type,d=t.getResponseUrl(e,i),c=Object(ae.isFiniteNumber)(s)?s:0,u=Object(ae.isFiniteNumber)(o)?o:c,h=t.mapContextToLevelType(i),f=we.parseLevelPlaylist(e.data,d,u,h,c);if(f.tload=r.tload,f.fragments.length){if(l===Z.MANIFEST){var p={url:d,details:f};a.trigger(se["default"].MANIFEST_LOADED,{levels:[p],audioTracks:[],url:d,stats:r,networkDetails:n,sessionData:null})}if(r.tparsed=Re.now(),f.needSidxRanges){var g=f.initSegment.url;this.load({url:g,isSidxRequest:!0,type:l,level:o,levelDetails:f,id:s,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else i.levelDetails=f,this._handlePlaylistLoaded(e,r,i,n)}else a.trigger(se["default"].ERROR,{type:ne.ErrorTypes.NETWORK_ERROR,details:ne.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:d,reason:"no fragments found in level",level:"number"==typeof i.level?i.level:undefined})},r._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var r=he["default"].parseSegmentIndex(new Uint8Array(e.data));if(r){var i=r.references,n=t.levelDetails;i.forEach(function(e,t){var r=e.info;if(n){var i=n.fragments[t];0===i.byteRange.length&&i.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}}),n&&n.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},r._handleManifestParsingError=function(e,t,r,i){this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.NETWORK_ERROR,details:ne.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:i})},r._handleNetworkError=function(e,t,r,i){var n,a;void 0===r&&(r=!1),void 0===i&&(i=null),oe.logger.info("A network error occured while loading a "+e.type+"-type playlist");var s=this.getInternalLoader(e);switch(e.type){case Z.MANIFEST:n=r?ne.ErrorDetails.MANIFEST_LOAD_TIMEOUT:ne.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case Z.LEVEL:n=r?ne.ErrorDetails.LEVEL_LOAD_TIMEOUT:ne.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case Z.AUDIO_TRACK:n=r?ne.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ne.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;default:a=!1}s&&(s.abort(),this.resetInternalLoader(e.type));var o={type:ne.ErrorTypes.NETWORK_ERROR,details:n,fatal:a,url:e.url,loader:s,context:e,networkDetails:t};i&&(o.response=i),this.hls.trigger(se["default"].ERROR,o)},r._handlePlaylistLoaded=function(e,r,i,n){var a=i.type,s=i.level,o=i.id,l=i.levelDetails;if(l&&l.targetduration)if(t.canHaveQualityLevels(i.type))this.hls.trigger(se["default"].LEVEL_LOADED,{details:l,level:s||0,id:o||0,stats:r,networkDetails:n});else switch(a){case Z.AUDIO_TRACK:this.hls.trigger(se["default"].AUDIO_TRACK_LOADED,{details:l,id:o,stats:r,networkDetails:n});break;case Z.SUBTITLE_TRACK:this.hls.trigger(se["default"].SUBTITLE_TRACK_LOADED,{details:l,id:o,stats:r,networkDetails:n})}else this._handleManifestParsingError(e,i,"invalid target duration",n)},t}(de),Le=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].FRAG_LOADING)||this).loaders={},r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){var t=this.loaders;for(var r in t){var i=t[r];i&&i.destroy()}this.loaders={},e.prototype.destroy.call(this)},r.onFragLoading=function(e){var t=e.frag,r=t.type,i=this.loaders,n=this.hls.config,a=n.fLoader,s=n.loader;t.loaded=0;var o,l,d,c=i[r];c&&(oe.logger.warn("abort previous fragment loader for type: "+r),c.abort()),c=i[r]=t.loader=n.fLoader?new a(n):new s(n),o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var u=t.byteRangeStartOffset,h=t.byteRangeEndOffset;Object(ae.isFiniteNumber)(u)&&Object(ae.isFiniteNumber)(h)&&(o.rangeStart=u,o.rangeEnd=h),l={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},c.load(o,l,d)},r.loadsuccess=function(e,t,r,i){void 0===i&&(i=null);var n=e.data,a=r.frag;a.loader=undefined,this.loaders[a.type]=undefined,this.hls.trigger(se["default"].FRAG_LOADED,{payload:n,frag:a,stats:t,networkDetails:i})},r.loaderror=function(e,t,r){void 0===r&&(r=null);var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=undefined,this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.NETWORK_ERROR,details:ne.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},r.loadtimeout=function(e,t,r){void 0===r&&(r=null);var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=undefined,this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.NETWORK_ERROR,details:ne.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},r.loadprogress=function(e,t,r,i){void 0===i&&(i=null);var n=t.frag;n.loaded=e.loaded,this.hls.trigger(se["default"].FRAG_LOAD_PROGRESS,{frag:n,stats:e,networkDetails:i})},t}(de),De=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].KEY_LOADING)||this).loaders={},r.decryptkey=null,r.decrypturl=null,r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){for(var t in this.loaders){var r=this.loaders[t];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},r.onKeyLoading=function(e){var t=e.frag,r=t.type,i=this.loaders[r];if(t.decryptdata){var n=t.decryptdata.uri;if(n!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(i&&(oe.logger.warn("abort previous key loader for type:"+r),i.abort()),!n)return void oe.logger.warn("key uri is falsy");t.loader=this.loaders[r]=new a.loader(a),this.decrypturl=n,this.decryptkey=null;var s={url:n,frag:t,responseType:"arraybuffer"},o={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(s,o,l)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(se["default"].KEY_LOADED,{frag:t}))}else oe.logger.warn("Missing decryption data on fragment in onKeyLoading")},r.loadsuccess=function(e,t,r){var i=r.frag;i.decryptdata?(this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=undefined,delete this.loaders[i.type],this.hls.trigger(se["default"].KEY_LOADED,{frag:i})):oe.logger.error("after key load, decryptdata unset")},r.loaderror=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),delete this.loaders[r.type],this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.NETWORK_ERROR,details:ne.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},r.loadtimeout=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),delete this.loaders[r.type],this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.NETWORK_ERROR,details:ne.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},t}(de),Ce="NOT_LOADED",xe="APPENDING",Ie="PARTIAL",Oe="OK",Pe=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].BUFFER_APPENDED,se["default"].FRAG_BUFFERED,se["default"].FRAG_LOADED)||this).bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=t.config,r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,de.prototype.destroy.call(this),e.prototype.destroy.call(this)},r.getBufferedFrag=function(e,t){var r=this.fragments,i=Object.keys(r).filter(function(i){var n=r[i];if(n.body.type!==t)return!1;if(!n.buffered)return!1;var a=n.body;return a.startPTS<=e&&e<=a.endPTS});if(0===i.length)return null;var n=i.pop();return r[n].body},r.detectEvictedFragments=function(e,t){var r=this;Object.keys(this.fragments).forEach(function(i){var n=r.fragments[i];if(n&&n.buffered){var a=n.range[e];if(a)for(var s=a.time,o=0;o<s.length;o++){var l=s[o];if(!r.isTimeBuffered(l.startPTS,l.endPTS,t)){r.removeFragment(n.body);break}}}})},r.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),i=this.fragments[r];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){if(e.hasElementaryStream(r)){var n=t.timeRanges[r];i.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,n)}}))},r.getBufferedTimes=function(e,t,r){for(var i,n,a=[],s=!1,o=0;o<r.length;o++){if(i=r.start(o)-this.bufferPadding,n=r.end(o)+this.bufferPadding,i<=e&&t<=n){a.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))});break}if(e<n&&i<t)a.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))}),s=!0;else if(t<=i)break}return{time:a,partial:s}},r.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},r.getPartialFragment=function(e){var t,r,i,n=this,a=null,s=0;return Object.keys(this.fragments).forEach(function(o){var l=n.fragments[o];n.isPartial(l)&&(r=l.body.startPTS-n.bufferPadding,i=l.body.endPTS+n.bufferPadding,r<=e&&e<=i&&(t=Math.min(e-r,i-e),s<=t&&(a=l.body,s=t)))}),a},r.getState=function(e){var t=this.getFragmentKey(e),r=this.fragments[t],i=Ce;return r!==undefined&&(i=r.buffered?!0===this.isPartial(r)?Ie:Oe:xe),i},r.isPartial=function(e){return!0===e.buffered&&(e.range.video!==undefined&&!0===e.range.video.partial||e.range.audio!==undefined&&!0===e.range.audio.partial)},r.isTimeBuffered=function(e,t,r){for(var i,n,a=0;a<r.length;a++){if(i=r.start(a)-this.bufferPadding,n=r.end(a)+this.bufferPadding,i<=e&&t<=n)return!0;if(t<=i)return!1}return!1},r.onFragLoaded=function(e){var t=e.frag;Object(ae.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},r.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)})},r.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},r.hasFragment=function(e){var t=this.getFragmentKey(e);return this.fragments[t]!==undefined},r.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},r.removeAllFragments=function(){this.fragments=Object.create(null)},t}(de),Me={search:function(e,t){for(var r=0,i=e.length-1,n=null,a=null;r<=i;){var s=t(a=e[n=(r+i)/2|0]);if(0<s)r=n+1;else{if(!(s<0))return a;i=n-1}}return null}},Fe=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(ee){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var i,n=e.buffered,a=[];for(i=0;i<n.length;i++)a.push({start:n.start(i),end:n.end(i)});return this.bufferedInfo(a,t,r)}}catch(re){}return{len:0,start:t,end:t,nextStart:undefined}},e.bufferedInfo=function(e,t,r){e.sort(function(e,t){return e.start-t.start||t.end-e.end});var i=[];if(r)for(var n=0;n<e.length;n++){var a=i.length;if(a){var s=i[a-1].end;e[n].start-s<r?e[n].end>s&&(i[a-1].end=e[n].end):i.push(e[n])}else i.push(e[n])}else i=e;for(var o,l=0,d=t,c=t,u=0;u<i.length;u++){var h=i[u].start,f=i[u].end;if(h<=t+r&&t<f)d=h,l=(c=f)-t;else if(t+r<h){o=h;break}}return{len:l,start:d,end:c,nextStart:o}},e}(),Ne=r("./node_modules/eventemitter3/index.js"),Ue=r("./node_modules/webworkify-webpack/index.js"),Be=r("./src/demux/demuxer-inline.js"),Ge=r("./src/utils/get-self-scope.js"),je=function(e){function t(){return e.apply(this,arguments)||this}return function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e),t.prototype.trigger=function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.emit.apply(this,[e,e].concat(r))},t}(Ne.EventEmitter),Ve=Object(Ge.getSelfScope)(),Ke=l()||{isTypeSupported:function(){return!1}},He=function(){function e(e,t){var r=this;this.hls=e,this.id=t;var i=this.observer=new je,n=e.config,a=function(t,i){(i=i||{}).frag=r.frag,i.id=r.id,e.trigger(t,i)};i.on(se["default"].FRAG_DECRYPTED,a),i.on(se["default"].FRAG_PARSING_INIT_SEGMENT,a),i.on(se["default"].FRAG_PARSING_DATA,a),i.on(se["default"].FRAG_PARSED,a),i.on(se["default"].ERROR,a),i.on(se["default"].FRAG_PARSING_METADATA,a),i.on(se["default"].FRAG_PARSING_USERDATA,a),i.on(se["default"].INIT_PTS_FOUND,a);var s={mp4:Ke.isTypeSupported("video/mp4"),mpeg:Ke.isTypeSupported("audio/mpeg"),mp3:Ke.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;if(n.enableWorker&&"undefined"!=typeof Worker){var l;oe.logger.log("demuxing in webworker");try{l=this.w=Ue("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),l.addEventListener("message",this.onwmsg),l.onerror=function(t){e.trigger(se["default"].ERROR,{type:ne.ErrorTypes.OTHER_ERROR,details:ne.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},l.postMessage({cmd:"init",typeSupported:s,vendor:o,id:t,config:JSON.stringify(n)})}catch(de){oe.logger.warn("Error in worker:",de),oe.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),l&&Ve.URL.revokeObjectURL(l.objectURL),this.demuxer=new Be["default"](i,s,n,o),this.w=undefined}}else this.demuxer=new Be["default"](i,s,n,o)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.push=function(e,t,r,i,n,a,s,o){var l=this.w,d=Object(ae.isFiniteNumber)(n.startPTS)?n.startPTS:n.start,c=n.decryptdata,u=this.frag,h=!(u&&n.cc===u.cc),f=!(u&&n.level===u.level),p=u&&n.sn===u.sn+1,g=!f&&p;if(h&&oe.logger.log(this.id+":discontinuity detected"),f&&oe.logger.log(this.id+":switch detected"),this.frag=n,l)l.postMessage({cmd:"demux",data:e,decryptdata:c,initSegment:t,audioCodec:r,videoCodec:i,timeOffset:d,discontinuity:h,trackSwitch:f,contiguous:g,duration:a,accurateTimeOffset:s,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var m=this.demuxer;m&&m.push(e,c,t,r,i,d,h,f,g,a,s,o)}},t.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":Ve.URL.revokeObjectURL(this.w.objectURL);break;case se["default"].FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},e}(),Ye={toString:function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i).toFixed(3)+","+e.end(i).toFixed(3)+"]";return t}},ze=function(){function e(e,t,r,i){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=i,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,r=this.media,i=this.stalled,n=r.currentTime,a=r.seeking,s=this.seeking&&!a,o=!this.seeking&&a;if(this.seeking=a,n===e){if((o||s)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&r.buffered.length){var l=Fe.bufferInfo(r,n,0),d=0<l.len,c=l.nextStart||0;if(d||c){if(a){var u=2<l.len,h=!c||2<c-n&&!this.fragmentTracker.getPartialFragment(n);if(u||h)return;this.moved=!1}if(!this.moved&&this.stalled){var f=Math.max(c,l.start||0)-n;if(0<f&&f<=2)return void this._trySkipBufferHole(null)}var p=self.performance.now();if(null!==i){var g=p-i;!a&&250<=g&&this._reportStall(l.len);var m=Fe.bufferInfo(r,n,t.maxBufferHole);this._tryFixBufferStall(m,g)}else this.stalled=p}}}else if(this.moved=!0,null!==i){if(this.stallReported){var v=self.performance.now()-i;oe.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(v)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var r=this.config,i=this.fragmentTracker,n=this.media.currentTime,a=i.getPartialFragment(n);a&&this._trySkipBufferHole(a)||e.len>r.maxBufferHole&&t>1e3*r.highBufferWatchdogPeriod&&(oe.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,oe.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer (buffer="+e+")"),t.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:ne.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,r=this.hls,i=this.media,n=i.currentTime,a=0,s=0;s<i.buffered.length;s++){var o=i.buffered.start(s);if(n+t.maxBufferHole>=a&&n<o){var l=Math.max(o+.05,i.currentTime+.1);return oe.logger.warn("skipping hole, adjusting currentTime from "+n+" to "+l),this.moved=!0,this.stalled=null,i.currentTime=l,e&&r.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:ne.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+l,frag:e}),l}a=i.buffered.end(s)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,i=r.currentTime,n=(this.nudgeRetry||0)+1;if((this.nudgeRetry=n)<e.nudgeMaxRetry){var a=i+n*e.nudgeOffset;oe.logger.warn("Nudging 'currentTime' from "+i+" to "+a),r.currentTime=a,t.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:ne.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else oe.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:ne.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}(),qe=function(e){function t(t){for(var r,i=arguments.length,n=new Array(1<i?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return(r=e.call.apply(e,[this,t].concat(n))||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},r.hasInterval=function(){return!!this._tickInterval},r.hasNextTick=function(){return!!this._tickTimer},r.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},r.clearInterval=function(){return!(!this._tickInterval||(self.clearInterval(this._tickInterval),this._tickInterval=null))},r.clearNextTick=function(){return!(!this._tickTimer||(self.clearTimeout(this._tickTimer),this._tickTimer=null))},r.tick=function(){1===++this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},r.doTick=function(){},t}(de),We="STOPPED",Xe="STARTING",Qe="IDLE",Je="KEY_LOADING",$e="FRAG_LOADING",Ze="FRAG_LOADING_WAITING_RETRY",et="WAITING_TRACK",tt="PARSING",rt="PARSED",it="BUFFER_FLUSHING",nt="ENDED",at="ERROR",st="WAITING_INIT_PTS",ot="WAITING_LEVEL",lt=function(e){function t(){return e.apply(this,arguments)||this}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.doTick=function(){},r.startLoad=function(){},r.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=We},r._streamEnded=function(e,t){var r=this.fragCurrent,i=this.fragmentTracker;if(t.live||!r||r.backtracked||r.sn!==t.endSN||e.nextStart)return!1;var n=i.getState(r);return n===Ie||n===Oe},r.onMediaSeeking=function(){var e=this.config,t=this.media,r=this.mediaBuffer,i=this.state,n=t?t.currentTime:null,a=Fe.bufferInfo(r||t,n,this.config.maxBufferHole);if(oe.logger.log("media seeking to "+(Object(ae.isFiniteNumber)(n)?n.toFixed(3):n)),i===$e){var s=this.fragCurrent;if(0===a.len&&s){var o=e.maxFragLookUpTolerance,l=s.start-o,d=s.start+s.duration+o;n<l||d<n?(s.loader&&(oe.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=Qe):oe.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else i===nt&&(0===a.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=Qe);t&&(this.lastCurrentTime=n),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=n),this.tick()},r.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},r.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},r.onHandlerDestroyed=function(){this.state=We,this.fragmentTracker=null},r.computeLivePosition=function(e,t){var r=this.config.liveSyncDuration!==undefined?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},t}(qe),dt=function(e){function t(t,r){var i;return(i=e.call(this,t,se["default"].MEDIA_ATTACHED,se["default"].MEDIA_DETACHING,se["default"].MANIFEST_LOADING,se["default"].MANIFEST_PARSED,se["default"].LEVEL_LOADED,se["default"].LEVELS_UPDATED,se["default"].KEY_LOADED,se["default"].FRAG_LOADED,se["default"].FRAG_LOAD_EMERGENCY_ABORTED,se["default"].FRAG_PARSING_INIT_SEGMENT,se["default"].FRAG_PARSING_DATA,se["default"].FRAG_PARSED,se["default"].ERROR,se["default"].AUDIO_TRACK_SWITCHING,se["default"].AUDIO_TRACK_SWITCHED,se["default"].BUFFER_CREATED,se["default"].BUFFER_APPENDED,se["default"].BUFFER_FLUSHED)||this).fragmentTracker=r,i.config=t.config,i.audioCodecSwap=!1,i._state=We,i.stallReported=!1,i.gapController=null,i.altAudio=!1,i.audioOnly=!1,i.bitrateTest=!1,i}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=r.startLevel;-1===i&&(r.config.testBandwidth?(i=0,this.bitrateTest=!0):i=r.nextAutoLevel),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}0<t&&-1===e&&(oe.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=Qe,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=We},r.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},r.doTick=function(){switch(this.state){case it:this.fragLoadError=0;break;case Qe:this._doTickIdle();break;case ot:var e=this.levels[this.level];e&&e.details&&(this.state=Qe);break;case Ze:var t=window.performance.now(),r=this.retryDate;(!r||r<=t||this.media&&this.media.seeking)&&(oe.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=Qe)}this._checkBuffer(),this._checkFragmentChanged()},r._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(this.levelLastLoaded!==undefined&&(r||!this.startFragRequested&&t.startFragPrefetch))if(this.altAudio&&this.audioOnly)this.demuxer.frag=null;else{var i;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var n=e.nextLoadLevel,a=this.levels[n];if(a){var s,o=a.bitrate;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=i<t.maxBufferHole?Math.max(2,t.maxBufferHole):t.maxBufferHole,d=Fe.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,l),c=d.len;if(!(s<=c)){oe.logger.trace("buffer length of "+c.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=n;var u=a.details;if(!u||u.live&&this.levelLastLoaded!==n)this.state=ot;else{if(this._streamEnded(d,u)){var h={};return this.altAudio&&(h.type="video"),this.hls.trigger(se["default"].BUFFER_EOS,h),void(this.state=nt)}this._fetchPayloadOrEos(i,d,u)}}}}},r._fetchPayloadOrEos=function(e,t,r){var i=this.fragPrevious,n=(this.level,r.fragments),a=n.length;if(0!==a){var s,o=n[0].start,l=n[a-1].start+n[a-1].duration,d=t.end;if(r.initSegment&&!r.initSegment.data)s=r.initSegment;else if(r.live){var c=this.config.initialLiveManifestSize;if(a<c)return void oe.logger.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+c);if(null===(s=this._ensureFragmentAtLivePoint(r,d,o,l,i,n)))return}else d<o&&(s=n[0]);(s=s||this._findFragment(o,i,a,n,d,l,r))&&(s.encrypted?this._loadKey(s,r):this._loadFragment(s,r,e,d))}},r._ensureFragmentAtLivePoint=function(e,t,r,i,n,a){var s,o=this.hls.config,l=this.media,d=Infinity;if(o.liveMaxLatencyDuration!==undefined?d=o.liveMaxLatencyDuration:Object(ae.isFiniteNumber)(o.liveMaxLatencyDurationCount)&&(d=o.liveMaxLatencyDurationCount*e.targetduration),t<Math.max(r-o.maxFragLookUpTolerance,i-d)){var c=this.liveSyncPosition=this.computeLivePosition(r,e);t=c,l&&!l.paused&&l.readyState&&l.duration>c&&c>l.currentTime&&(oe.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),l.currentTime=c),this.nextLoadPosition=c}if(e.PTSKnown&&i<t&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown&&n)if(e.hasProgramDateTime)oe.logger.log("live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),s=y(a,n.endProgramDateTime,o.maxFragLookUpTolerance);else{var u=n.sn+1;if(u>=e.startSN&&u<=e.endSN){var h=a[u-e.startSN];n.cc===h.cc&&(s=h,oe.logger.log("live playlist, switching playlist, load frag with next SN: "+s.sn))}s||(s=Me.search(a,function(e){return n.cc-e.cc}))&&oe.logger.log("live playlist, switching playlist, load frag with same CC: "+s.sn)}return s},r._findFragment=function(e,t,r,i,n,a,s){var o,l=this.hls.config;if(o=n<a?E(t,i,n,n>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance):i[r-1]){var d=o.sn-s.startSN,c=t&&o.level===t.level,u=i[d-1],h=i[1+d];if(t&&o.sn===t.sn)if(c&&!o.backtracked)if(o.sn<s.endSN){var f=t.deltaPTS;f&&f>l.maxBufferHole&&t.dropped&&d?(o=u,oe.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(o=h,this.fragmentTracker.getState(o)!==Oe&&oe.logger.log("Re-loading fragment with SN: "+o.sn))}else o=null;else o.backtracked&&(h&&h.backtracked?(oe.logger.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+h.sn),o=h):(oe.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,u?(o=u).backtracked=!0:d&&(o=null)))}return o},r._loadKey=function(e,t){oe.logger.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level),this.state=Je,this.hls.trigger(se["default"].KEY_LOADING,{frag:e})},r._loadFragment=function(e,t,r,i){var n=this.fragmentTracker.getState(e);"initSegment"!==(this.fragCurrent=e).sn&&(this.startFragRequested=!0),Object(ae.isFiniteNumber)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||n===Ce||n===Ie?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,oe.logger.log("Loading "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(r.toFixed(3))+", bufferEnd: "+parseFloat(i.toFixed(3))),this.hls.trigger(se["default"].FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new He(this.hls,"main")),this.state=$e):n===xe&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},r.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,te.MAIN)},r.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},r._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),Fe.isBuffered(r,t)?e=this.getBufferedFrag(t):Fe.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var i=e;if(i!==this.fragPlaying){this.hls.trigger(se["default"].FRAG_CHANGED,{frag:i});var n=i.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(se["default"].LEVEL_SWITCHED,{level:n}),this.fragPlaying=i}}},r.immediateLevelSwitch=function(){if(oe.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused)||t.pause():e=!0,this.previouslyPaused=e}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},r.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,0<e.currentTime&&Fe.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},r.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,r=this.getBufferedFrag(e.currentTime);if(r&&1<r.startPTS&&this.flushMainBuffer(0,r.startPTS-1),e.paused)t=0;else{var i=this.hls.nextLoadLevel,n=this.levels[i],a=this.fragLastKbps;t=a&&this.fragCurrent?this.fragCurrent.duration*n.bitrate/(1e3*a)+1:0}var s=this.getBufferedFrag(e.currentTime+t);if(s){var o=this.followingBufferedFrag(s);if(o){var l=this.fragCurrent;l&&l.loader&&l.loader.abort(),this.fragCurrent=null;var d=Math.max(s.endPTS,o.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,o.duration));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}},r.flushMainBuffer=function(e,t){this.state=it;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(se["default"].BUFFER_FLUSHING,r)},r.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new ze(r,t,this.fragmentTracker,this.hls)},r.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(oe.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=undefined})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},r.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:undefined;Object(ae.isFiniteNumber)(t)&&oe.logger.log("media seeked to "+t.toFixed(3)),this.tick()},r.onManifestLoading=function(){oe.logger.log("trigger BUFFER_RESET"),this.hls.trigger(se["default"].BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},r.onManifestParsed=function(e){var t,r=!1,i=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),
-1!==t.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=r&&i,this.audioCodecSwitch&&oe.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},r.onLevelLoaded=function(e){var t=e.details,r=e.level,i=this.levels[this.levelLastLoaded],n=this.levels[r],a=t.totalduration,s=0;if(oe.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live||n.details&&n.details.live){var o=n.details;o&&0<t.fragments.length?(h(o,t),s=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,o),t.PTSKnown&&Object(ae.isFiniteNumber)(s)?oe.logger.log("live playlist sliding:"+s.toFixed(3)):(oe.logger.log("live playlist - outdated PTS, unknown sliding"),v(this.fragPrevious,i,t))):(oe.logger.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,v(this.fragPrevious,i,t))}else t.PTSKnown=!1;if(n.details=t,this.levelLastLoaded=r,this.hls.trigger(se["default"].LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var l=t.startTimeOffset;Object(ae.isFiniteNumber)(l)?(l<0&&(oe.logger.log("negative start time offset "+l+", count from end of last fragment"),l=s+a+l),oe.logger.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l):t.live?(this.startPosition=this.computeLivePosition(s,t),oe.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===ot&&(this.state=Qe),this.tick()},r.onKeyLoaded=function(){this.state===Je&&(this.state=Qe,this.tick())},r.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,i=this.levels,n=this.media,a=e.frag;if(this.state===$e&&t&&"main"===a.type&&a.level===t.level&&a.sn===t.sn){var s=e.stats,o=i[t.level],l=o.details;if(this.bitrateTest=!1,this.stats=s,oe.logger.log("Loaded "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level),a.bitrateTest&&r.nextLoadLevel)this.state=Qe,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),r.trigger(se["default"].FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===a.sn)this.state=Qe,s.tparsed=s.tbuffered=window.performance.now(),l.initSegment.data=e.payload,r.trigger(se["default"].FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{oe.logger.log("Parsing "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level+", cc "+t.cc),this.state=tt,this.pendingBuffering=!0,this.appended=!1,a.bitrateTest&&(a.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:a}));var d=!(n&&n.seeking)&&(l.PTSKnown||!l.live),c=l.initSegment?l.initSegment.data:[],u=this._getAudioCodec(o);(this.demuxer=this.demuxer||new He(this.hls,"main")).push(e.payload,c,u,o.videoCodec,t,l.totalduration,d)}}this.fragLoadError=0},r.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===tt){var i,n,a=e.tracks;if(this.audioOnly=a.audio&&!a.video,this.altAudio&&!this.audioOnly&&delete a.audio,n=a.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(oe.logger.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==n.container&&(s="mp4a.40.2",oe.logger.log("Android: force audio codec to "+s)),n.levelCodec=s,n.id=e.id}for(i in(n=a.video)&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=e.id),this.hls.trigger(se["default"].BUFFER_CODECS,a),a){n=a[i],oe.logger.log("main track:"+i+",container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var l=n.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(se["default"].BUFFER_APPENDING,{type:i,data:l,parent:"main",content:"initSegment"}))}this.tick()}},r.onFragParsingData=function(e){var t=this,r=this.fragCurrent,i=e.frag;if(r&&"main"===e.id&&i.sn===r.sn&&i.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===tt){var n=this.levels[this.level],a=r;if(Object(ae.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),!0===e.hasAudio&&a.addElementaryStream(ce.AUDIO),!0===e.hasVideo&&a.addElementaryStream(ce.VIDEO),oe.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(a.dropped=e.dropped,a.dropped)if(a.backtracked)oe.logger.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var s=n.details;if(!s||a.sn!==s.startSN)return oe.logger.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=Qe,this.fragPrevious=a,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),void this.tick();oe.logger.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var o=u(n.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),l=this.hls;l.trigger(se["default"].LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(r){r&&r.length&&t.state===tt&&(t.appended=!0,t.pendingBuffering=!0,l.trigger(se["default"].BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))}),this.tick()}},r.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===tt&&(this.stats.tparsed=window.performance.now(),this.state=rt,this._checkAppendedParsed())},r.onAudioTrackSwitching=function(e){var t=this.altAudio,r=!!e.url,i=e.id;if(!r){if(this.mediaBuffer!==this.media){oe.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(oe.logger.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=Qe}var a=this.hls;t&&a.trigger(se["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),a.trigger(se["default"].AUDIO_TRACK_SWITCHED,{id:i})}},r.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(oe.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},r.onBufferCreated=function(e){var t,r,i=e.tracks,n=!1;for(var a in i){var s=i[a];"main"===s.id?(t=s,"video"===(r=a)&&(this.videoBuffer=i[a].buffer)):n=!0}n&&t?(oe.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},r.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==tt&&t!==rt||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},r._checkAppendedParsed=function(){if(!(this.state!==rt||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;oe.logger.log("main buffered : "+Ye.toString(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(se["default"].FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=Qe}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},r.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=!!this.media&&Fe.isBuffered(this.media,this.media.currentTime)&&Fe.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case ne.ErrorDetails.FRAG_LOAD_ERROR:case ne.ErrorDetails.FRAG_LOAD_TIMEOUT:case ne.ErrorDetails.KEY_LOAD_ERROR:case ne.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);oe.logger.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=window.performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=Ze}else oe.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=at;break;case ne.ErrorDetails.LEVEL_LOAD_ERROR:case ne.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==at&&(e.fatal?(this.state=at,oe.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==ot||(this.state=Qe));break;case ne.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==tt&&this.state!==rt||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=Qe):(oe.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},r._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,oe.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},r._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},r.onFragLoadEmergencyAborted=function(){this.state=Qe,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},r.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;if(e){var t=this.audioOnly?ce.AUDIO:ce.VIDEO;this.fragmentTracker.detectEvictedFragments(t,e.buffered)}this.state=Qe,this.fragPrevious=null},r.onLevelsUpdated=function(e){this.levels=e.levels},r.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},r._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=this.startPosition;if(t!==r&&0<=r){if(e.seeking)return void oe.logger.log("could not seek to "+r+", already seeking at "+t);var i=(e.buffered.length?e.buffered.start(0):0)-r;0<i&&i<this.config.maxBufferHole&&(oe.logger.log("adjusting start position by "+i+" to match buffer start"),r+=i,this.startPosition=r),oe.logger.log("seek to target start position "+r+" from current time "+t+". ready state "+e.readyState),e.currentTime=r}},r._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(oe.logger.log("swapping playlist audio codec"),t=t&&(-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},function(e,t,r){t&&T(e.prototype,t),r&&T(e,r)}(t,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,oe.logger.log("main stream-controller: "+t+"->"+e),this.hls.trigger(se["default"].STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(lt),ct=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].MANIFEST_LOADED,se["default"].LEVEL_LOADED,se["default"].AUDIO_TRACK_SWITCHED,se["default"].FRAG_LOADED,se["default"].ERROR)||this).canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,pe=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},r.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},r.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=undefined)}),null!==this.timer&&this.loadLevel()},r.stopLoad=function(){this.canload=!1},r.onManifestLoaded=function(e){var t,r=[],i=[],n={},a=null,o=!1,l=!1;if(e.levels.forEach(function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,o=o||!!e.videoCodec,l=l||!!e.audioCodec,pe&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=undefined),(a=n[e.bitrate])?a.url.push(e.url):(e.url=[e.url],e.urlId=0,n[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&d(a||e,"audio",t.AUDIO),t.SUBTITLES&&d(a||e,"text",t.SUBTITLES))}),o&&l&&(r=r.filter(function(e){return!!e.videoCodec})),r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||s(t,"audio"))&&(!r||s(r,"video"))}),e.audioTracks&&(i=e.audioTracks.filter(function(e){return!e.audioCodec||s(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),0<r.length){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var c=0;c<r.length;c++)if(r[c].bitrate===t){this._firstLevel=c,oe.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}var u=l&&!o;this.hls.trigger(se["default"].MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:e.stats,audio:l,video:o,altAudio:!u&&i.some(function(e){return!!e.url})})}else this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:ne.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},r.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(0<=e&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){oe.logger.log("switching to level "+e);var i=t[this.currentLevelIndex=e];i.level=e,r.trigger(se["default"].LEVEL_SWITCHING,i)}var n=t[e],a=n.details;if(!a||a.live){var s=n.urlId;r.trigger(se["default"].LEVEL_LOADING,{url:n.url[s],level:e,id:s})}}else r.trigger(se["default"].ERROR,{type:ne.ErrorTypes.OTHER_ERROR,details:ne.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},r.onError=function(e){if(e.fatal)e.type===ne.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,i=!1;switch(e.details){case ne.ErrorDetails.FRAG_LOAD_ERROR:case ne.ErrorDetails.FRAG_LOAD_TIMEOUT:case ne.ErrorDetails.KEY_LOAD_ERROR:case ne.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,i=!0;break;case ne.ErrorDetails.LEVEL_LOAD_ERROR:case ne.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case ne.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,r=!0}t!==undefined&&this.recoverLevel(e,t,r,i)}},r.recoverLevel=function(e,t,r,i){var n,a,s,o=this,l=this.hls.config,d=e.details,c=this._levels[t];if(c.loadError++,c.fragmentError=i,r){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return oe.logger.error("level controller, cannot recover from "+d+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return o.loadLevel()},a),e.levelRetry=!0,this.levelRetryCount++,oe.logger.warn("level controller, "+d+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(r||i)&&(1<(n=c.url.length)&&c.loadError<n?(c.urlId=(c.urlId+1)%n,c.details=undefined,oe.logger.warn("level controller, "+d+" for level "+t+": switching to redundant URL-id "+c.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,oe.logger.warn("level controller, "+d+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):i&&(oe.logger.warn("level controller, "+d+": reload a fragment"),this.currentLevelIndex=null))},r.onFragLoaded=function(e){var t=e.frag;if(t!==undefined&&"main"===t.type){var r=this._levels[t.level];r!==undefined&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},r.onLevelLoaded=function(e){var t=this,r=e.level,i=e.details;if(r===this.currentLevelIndex){var n=this._levels[r];if(n.fragmentError||(n.loadError=0,this.levelRetryCount=0),i.live){var a=p(n.details,i,e.stats.trequest);oe.logger.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},a)}else this.clearTimer()}},r.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var i=-1,n=0;n<r.audioGroupIds.length;n++)if(r.audioGroupIds[n]===t){i=n;break}i!==r.urlId&&(r.urlId=i,this.startLoad())}},r.loadLevel=function(){if(oe.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&0<e.url.length){var t=this.currentLevelIndex,r=e.urlId,i=e.url[r];oe.logger.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(se["default"].LEVEL_LOADING,{url:i,level:t,id:r})}}},r.removeLevel=function(e,t){var r=this.levels.filter(function(r,i){return i!==e||1<r.url.length&&t!==undefined&&(r.url=r.url.filter(function(e,r){return r!==t}),!(r.urlId=0))}).map(function(e,t){var r=e.details;return r&&r.fragments&&r.fragments.forEach(function(e){e.level=t}),e});this._levels=r,this.hls.trigger(se["default"].LEVELS_UPDATED,{levels:r})},function(e,t,r){t&&A(e.prototype,t),r&&A(e,r)}(t,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,this._startLevel===undefined&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(this._startLevel!==undefined)return this._startLevel;var e=this.hls.config.startLevel;return e!==undefined?e:this._firstLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),t}(de),ut=r("./src/demux/id3.js"),ht=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].MEDIA_ATTACHED,se["default"].MEDIA_DETACHING,se["default"].FRAG_PARSING_METADATA,se["default"].LIVE_BACK_BUFFER_REACHED)||this).id3Track=undefined,r.media=undefined,r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){de.prototype.destroy.call(this)},r.onMediaAttached=function(e){this.media=e.media,this.media},r.onMediaDetaching=function(){S(this.id3Track),this.id3Track=undefined,this.media=undefined},r.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return _(r,this.media),r}return this.media.addTextTrack("metadata","id3")},r.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<r.length;n++){var a=ut["default"].getID3Frames(r[n].data);if(a){var s=Math.max(r[n].pts,0),o=n<r.length-1?r[n+1].pts:t.endPTS;(o=o||t.start+t.duration)-s<=0&&(o=s+.25);for(var l=0;l<a.length;l++){var d=a[l];if(!ut["default"].isTimeStampFrame(d)){var c=new i(s,o,"");c.value=d,this.id3Track.addCue(c)}}}}},r.onLiveBackBufferReached=function(e){var t=e.bufferEnd,r=this.id3Track;if(r&&r.cues&&r.cues.length){var i=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var r=0,i=e.length-1;r<=i;){var n=Math.floor((i+r)/2);if(t<e[n].endTime)i=n-1;else{if(!(t>e[n].endTime))return e[n];r=n+1}}return e[r].endTime-t<t-e[i].endTime?e[r]:e[i]}(r.cues,t);if(i)for(;r.cues[0]!==i;)r.removeCue(r.cues[0])}},t}(de),ft=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),pt=function(){function e(e,t,r,i){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new ft(t),this.fast_=new ft(r)}var t=e.prototype;return t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/r;this.fast_.sample(r,i),this.slow_.sample(r,i)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}(),gt=window.performance,mt=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].FRAG_LOADING,se["default"].FRAG_LOADED,se["default"].FRAG_BUFFERED,se["default"].ERROR)||this).lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=t,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){this.clearTimer(),de.prototype.destroy.call(this)},r.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r,i,n=this.hls,a=n.config,s=t.level;i=n.levels[s].details.live?(r=a.abrEwmaFastLive,a.abrEwmaSlowLive):(r=a.abrEwmaFastVoD,a.abrEwmaSlowVoD),this._bwEstimator=new pt(n,i,r,a.abrEwmaDefaultEstimate)}},r._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var i=r.loader;if(!i||i.stats&&i.stats.aborted)return oe.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var n=i.stats;if(t&&n&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var a=gt.now()-n.trequest,s=Math.abs(t.playbackRate);if(a>500*r.duration/s){var o=e.levels,l=Math.max(1,n.bw?n.bw/8:1e3*n.loaded/a),d=o[r.level];if(!d)return;var c=d.realBitrate?Math.max(d.realBitrate,d.bitrate):d.bitrate,u=n.total?n.total:Math.max(n.loaded,Math.round(r.duration*c/8)),h=t.currentTime,f=(u-n.loaded)/l,p=(Fe.bufferInfo(t,h,e.config.maxBufferHole).end-h)/s;if(p<2*r.duration/s&&p<f){var g,m=e.minAutoLevel;for(g=r.level-1;m<g;g--){var v=o[g].realBitrate?Math.max(o[g].realBitrate,o[g].bitrate):o[g].bitrate;if(r.duration*v/(6.4*l)<p)break}void 0<f&&(oe.logger.warn("loading too slow, abort fragment loading and switch to level "+g+":fragLoadedDelay["+g+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+f.toFixed(1)+":"+p.toFixed(1)),e.nextLoadLevel=g,this._bwEstimator.sample(a,n.loaded),i.abort(),this.clearTimer(),e.trigger(se["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:n}))}}}}},r.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(ae.isFiniteNumber)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],i=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,n=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:i,duration:n},r.realBitrate=Math.round(8*i/n)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},r.onFragBuffered=function(e){var t=e.stats,r=e.frag;if(!0!==t.aborted&&"main"===r.type&&Object(ae.isFiniteNumber)(r.sn)&&(!r.bitrateTest||t.tload===t.tbuffered)){var i=t.tparsed-t.trequest;oe.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(i,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},r.onError=function(e){switch(e.details){case ne.ErrorDetails.FRAG_LOAD_ERROR:case ne.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},r.clearTimer=function(){clearInterval(this.timer),this.timer=null},r._findBestLevel=function(e,t,r,i,n,a,s,o,l){for(var d=n;i<=d;d--){var c=l[d];if(c){var u=c.details,h=u?u.totalduration/u.fragments.length:t,f=!!u&&u.live,p=void 0;p=d<=e?s*r:o*r;var g=l[d].realBitrate?Math.max(l[d].realBitrate,l[d].bitrate):l[d].bitrate,m=g*h/p;if(oe.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+d+"/"+Math.round(p)+"/"+g+"/"+h+"/"+a+"/"+m),g<p&&(!m||f&&!this.bitrateTestDelay||m<a))return d}}return-1},function(e,t,r){t&&w(e.prototype,t),r&&w(e,r)}(t,[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,i=e.config,n=e.minAutoLevel,a=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,d=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,u=(Fe.bufferInfo(a,l,i.maxBufferHole).end-l)/d,h=this._findBestLevel(s,o,c,n,t,u,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(0<=h)return h;oe.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var f=o?Math.min(o,i.maxStarvationDelay):i.maxStarvationDelay,p=i.abrBandWidthFactor,g=i.abrBandWidthUpFactor;if(0==u){var m=this.bitrateTestDelay;m&&(f=(o?Math.min(o,i.maxLoadingDelay):i.maxLoadingDelay)-m,oe.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),p=g=1)}return h=this._findBestLevel(s,o,c,n,t,u+f,p,g,r),Math.max(h,0)}}]),t}(de),vt=l(),yt=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].MEDIA_ATTACHING,se["default"].MEDIA_DETACHING,se["default"].MANIFEST_PARSED,se["default"].BUFFER_RESET,se["default"].BUFFER_APPENDING,se["default"].BUFFER_CODECS,se["default"].BUFFER_EOS,se["default"].BUFFER_FLUSHING,se["default"].LEVEL_PTS_UPDATED,se["default"].LEVEL_UPDATED)||this)._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r._needsFlush=!1,r._needsEos=!1,r.config=void 0,r.audioTimestampOffset=void 0,r.bufferCodecEventsExpected=0,r._bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.segments=[],r.parent=void 0,r.appending=!1,r.appended=0,r.appendError=0,r.flushBufferCounter=0,r.tracks={},r.pendingTracks={},r.sourceBuffer={},r.flushRange=[],r._onMediaSourceOpen=function(){oe.logger.log("media source opened"),r.hls.trigger(se["default"].MEDIA_ATTACHED,{media:r.media});var e=r.mediaSource;e&&e.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},r._onMediaSourceClose=function(){oe.logger.log("media source closed")},r._onMediaSourceEnded=function(){oe.logger.log("media source ended")},r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var e=r.sourceBuffer.audio;oe.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+r.audioTimestampOffset),e.timestampOffset=r.audioTimestampOffset,delete r.audioTimestampOffset}r._needsFlush&&r.doFlush(),r._needsEos&&r.checkEos(),r.appending=!1;var t=r.parent,i=r.segments.reduce(function(e,r){return r.parent===t?e+1:e},0),n={},a=r.sourceBuffer;for(var s in a){var o=a[s];if(!o)throw Error("handling source buffer update end error: source buffer for "+s+" uninitilized and unable to update buffered TimeRanges.");n[s]=o.buffered}r.hls.trigger(se["default"].BUFFER_APPENDED,{parent:t,pending:i,timeRanges:n}),r._needsFlush||r.doAppending(),r.updateMediaElementDuration(),0===i&&r.flushLiveBackBuffer()},r._onSBUpdateError=function(e){oe.logger.error("sourceBuffer error:",e),r.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:ne.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.config=t.config,r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){de.prototype.destroy.call(this)},r.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var i=this.sourceBuffer.audio;if(!i)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(.1<Math.abs(i.timestampOffset-e.start)){var n=i.updating;try{i.abort()}catch(te){oe.logger.warn("can not abort audio buffer: "+te)}n?this.audioTimestampOffset=e.start:(oe.logger.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+e.start),i.timestampOffset=e.start)}}},r.onManifestParsed=function(e){var t=2;(!e.audio||e.video)&&e.altAudio||(t=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=t,oe.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},r.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&vt){var r=this.mediaSource=new vt;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},r.onMediaDetaching=function(){oe.logger.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(e){oe.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):oe.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(se["default"].MEDIA_DETACHED)},r.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},r.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this._onSBUpdateEnd),r.removeEventListener("error",this._onSBUpdateError))}catch($){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},r.onBufferCodecs=function(e){var t=this
;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach(function(r){t.pendingTracks[r]=e[r]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},r.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var i in e)if(!t[i]){var n=e[i];if(!n)throw Error("source buffer exists for track "+i+", however track does not");var a=n.levelCodec||n.codec,s=n.container+";codecs="+a;oe.logger.log("creating sourceBuffer("+s+")");try{var o=t[i]=r.addSourceBuffer(s);o.addEventListener("updateend",this._onSBUpdateEnd),o.addEventListener("error",this._onSBUpdateError),this.tracks[i]={buffer:o,codec:a,id:n.id,container:n.container,levelCodec:n.levelCodec}}catch(le){oe.logger.error("error while trying to add sourceBuffer:"+le.message),this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:ne.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:le,mimeType:s})}}this.hls.trigger(se["default"].BUFFER_CREATED,{tracks:this.tracks})},r.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},r.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var r=this.sourceBuffer[t];r&&!r.ended&&(r.ended=!0,oe.logger.log(t+" sourceBuffer now EOS"))}this.checkEos()},r.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var i=e[r];if(i){if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}}oe.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(ee){oe.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},r.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},r.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,r=this.sourceBuffer,i=Object.keys(r),n=t-Math.max(e,this._levelTargetDuration),a=i.length-1;0<=a;a--){var s=i[a],o=r[s];if(o){var l=o.buffered;0<l.length&&n>l.start(0)&&this.removeBufferRange(s,o,0,n)&&this.hls.trigger(se["default"].LIVE_BACK_BUFFER_REACHED,{bufferEnd:n})}}else oe.logger.error("flushLiveBackBuffer called without attaching media")}},r.onLevelUpdated=function(e){var t=e.details;0<t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},r.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var i=this.sourceBuffer[r];if(i&&!0===i.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(oe.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=Infinity):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(ae.isFiniteNumber)(e))&&(oe.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},r.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var i in r){var n=r[i];n&&(t+=n.buffered.length)}}catch(te){oe.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(se["default"].BUFFER_FLUSHED)}},r.doAppending=function(){var e=this.config,t=this.hls,r=this.segments,i=this.sourceBuffer;if(Object.keys(i).length){if(!this.media||this.media.error)return this.segments=[],void oe.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var n=r.shift();if(n)try{var a=i[n.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void r.unshift(n);a.ended=!1,this.parent=n.parent,a.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0}catch(ie){oe.logger.error("error while trying to append buffer:"+ie.message),r.unshift(n);var s={type:ne.ErrorTypes.MEDIA_ERROR,parent:n.parent,details:"",fatal:!1};22===ie.code?(this.segments=[],s.details=ne.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,s.details=ne.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(oe.logger.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0)),t.trigger(se["default"].ERROR,s)}}}},r.flushBuffer=function(e,t,r){var i=this.sourceBuffer;if(!Object.keys(i).length)return!0;var n="null";if(this.media&&(n=this.media.currentTime.toFixed(3)),oe.logger.log("flushBuffer,pos/start/end: "+n+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return oe.logger.warn("abort flushing too many retries"),!0;var a=i[r];if(a){if(a.ended=!1,a.updating)return oe.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(r,a,e,t))return this.flushBufferCounter++,!1}return oe.logger.log("buffer flushed"),!0},r.removeBufferRange=function(e,t,r,i){try{for(var n=0;n<t.buffered.length;n++){var a=t.buffered.start(n),s=t.buffered.end(n),o=Math.max(a,r),l=Math.min(s,i);if(.5<Math.min(l,s)-o){var d="null";return this.media&&(d=this.media.currentTime.toString()),oe.logger.log("sb remove "+e+" ["+o+","+l+"], of ["+a+","+s+"], pos:"+d),t.remove(o,l),!0}}}catch(he){oe.logger.warn("removeBufferRange failed",he)}return!1},t}(de),Et=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].FPS_DROP_LEVEL_CAPPING,se["default"].MEDIA_ATTACHING,se["default"].MANIFEST_PARSED,se["default"].LEVELS_UPDATED,se["default"].BUFFER_CODECS,se["default"].MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,r.firstLevel=null,r.levels=[],r.media=null,r.restrictedLevels=[],r.timer=null,r.clientRect=null,r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},r.onFpsDropLevelCapping=function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},r.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},r.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},r.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},r.onLevelsUpdated=function(e){this.levels=e.levels},r.onMediaDetaching=function(){this.stopCapping()},r.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},r.getMaxLevel=function(e){var r=this;if(!this.levels)return-1;var i=this.levels.filter(function(i,n){return t.isLevelAllowed(n,r.restrictedLevels)&&n<=e});return this.clientRect=null,t.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},r.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},r.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},r.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t},t.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},t.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var i=e.length-1,n=0;n<e.length;n+=1){var a=e[n];if((a.width>=t||a.height>=r)&&function(e,t){return!t||e.width!==t.width||e.height!==t.height}(a,e[n+1])){i=n;break}}return i},function(e,t,r){t&&R(e.prototype,t),r&&R(e,r)}(t,[{key:"mediaWidth",get:function(){return this.getDimensions().width*t.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*t.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(t){}return e}}]),t}(de),bt=window.performance,Tt=function(e){function t(t){return e.call(this,t,se["default"].MEDIA_ATTACHING)||this}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},r.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},r.checkFPS=function(e,t,r){var i=bt.now();if(t){if(this.lastTime){var n=i-this.lastTime,a=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*a/n,l=this.hls;if(l.trigger(se["default"].FPS_DROP,{currentDropped:a,currentDecoded:s,totalDroppedFrames:r}),0<o&&a>l.config.fpsDroppedMonitoringThreshold*s){var d=l.currentLevel;oe.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),0<d&&(-1===l.autoLevelCapping||l.autoLevelCapping>=d)&&(--d,l.trigger(se["default"].FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:l.currentLevel}),l.autoLevelCapping=d,l.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},r.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},t}(de),At=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new window.XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(e,t.url)}catch(ee){e.open("GET",t.url,!0),i(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(ee){return void this.callbacks.onError({code:e.status,text:ee.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,i=this.stats,n=this.context,a=this.config;if(!i.aborted&&2<=r)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(window.performance.now(),i.trequest)),4===r){var s=t.status;if(200<=s&&s<300){var o,l;i.tload=Math.max(i.tfirst,window.performance.now()),l="arraybuffer"===n.responseType?(o=t.response).byteLength:(o=t.responseText).length,i.loaded=i.total=l;var d={url:t.responseURL,data:o};this.callbacks.onSuccess(d,i,n,t)}else i.retry>=a.maxRetry||400<=s&&s<499?(oe.logger.error(s+" while loading "+n.url),this.callbacks.onError({code:s,text:t.statusText},n,t)):(oe.logger.warn(s+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},t.loadtimeout=function(){oe.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,t)},e}(),_t=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].MANIFEST_LOADING,se["default"].MANIFEST_PARSED,se["default"].AUDIO_TRACK_LOADED,se["default"].AUDIO_TRACK_SWITCHED,se["default"].LEVEL_LOADED,se["default"].ERROR)||this)._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},r.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(se["default"].AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},r.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)oe.logger.warn("Invalid audio track id:",e.id);else{if(oe.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},r.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},r.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},r.onError=function(e){e.type===ne.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===ne.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(oe.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},r._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)oe.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)oe.logger.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];oe.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var r=t.url,i=t.type,n=t.id;this.hls.trigger(se["default"].AUDIO_TRACK_SWITCHING,{id:n,type:i,url:r}),this._loadTrackDetailsIfNeeded(t)}},r.doTick=function(){this._updateTrack(this._trackId)},r._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var r=t.audioGroupIds[t.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},r._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var r=this.tracks[this._trackId],i=null;if(r&&(i=r.name),this._selectDefaultTrack){var n=t.filter(function(e){return e["default"]});n.length?t=n:oe.logger.warn("No default audio tracks defined")}var a=!1,s=function(){t.forEach(function(t){a||e.audioGroupId&&t.groupId!==e.audioGroupId||i&&i!==t.name||(e._setAudioTrack(t.id),a=!0)})};s(),a||(i=null,s()),a||(oe.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:ne.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},r._needsTrackLoading=function(e){var t=e.details,r=e.url;return!(t&&!t.live||!r)},r._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,r=e.id;oe.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(se["default"].AUDIO_TRACK_LOADING,{url:t,id:r})}},r._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,oe.logger.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},r._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,i=t.language,n=t.groupId;oe.logger.warn("Loading failed on audio track id: "+e+", group-id: "+n+', name/language: "'+r+'" / "'+i+'"');for(var a=e,s=0;s<this.tracks.length;s++)if(!this.trackIdBlacklist[s]&&this.tracks[s].name===r){a=s;break}a!==e?(oe.logger.log("Attempting audio-track fallback id:",a,"group-id:",this.tracks[a].groupId),this._setAudioTrack(a)):oe.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+i+'"')},function(e,t,r){t&&k(e.prototype,t),r&&k(e,r)}(t,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}]),t}(qe),St=window.performance,wt=function(e){function t(t,r){var i;return(i=e.call(this,t,se["default"].MEDIA_ATTACHED,se["default"].MEDIA_DETACHING,se["default"].AUDIO_TRACKS_UPDATED,se["default"].AUDIO_TRACK_SWITCHING,se["default"].AUDIO_TRACK_LOADED,se["default"].KEY_LOADED,se["default"].FRAG_LOADED,se["default"].FRAG_PARSING_INIT_SEGMENT,se["default"].FRAG_PARSING_DATA,se["default"].FRAG_PARSED,se["default"].ERROR,se["default"].BUFFER_RESET,se["default"].BUFFER_CREATED,se["default"].BUFFER_APPENDED,se["default"].BUFFER_FLUSHED,se["default"].INIT_PTS_FOUND)||this).fragmentTracker=r,i.config=t.config,i.audioCodecSwap=!1,i._state=We,i.initPTS=[],i.waitingFragment=null,i.videoTrackCC=null,i.waitingVideoCC=null,i}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.onInitPtsFound=function(e){var t=e.id,r=e.frag.cc,i=e.initPTS;"main"===t&&(this.initPTS[r]=i,this.videoTrackCC=r,oe.logger.log("InitPTS for cc: "+r+" found from main: "+i),this.state===st&&this.tick())},r.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),(this.fragLoadError=0)<t&&-1===e?(oe.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=Qe):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=Xe),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=We},r.doTick=function(){var e,t,r,i=this.hls,n=i.config;switch(this.state){case at:case"PAUSED":case it:break;case Xe:this.state=et,this.loadedmetadata=!1;break;case Qe:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!n.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if((e=this.nextLoadPosition)===undefined)break;var s=this.mediaBuffer?this.mediaBuffer:this.media,o=this.videoBuffer?this.videoBuffer:this.media,l=e<n.maxBufferHole?Math.max(2,n.maxBufferHole):n.maxBufferHole,d=Fe.bufferInfo(s,e,l),c=Fe.bufferInfo(o,e,l),u=d.len,h=d.end,f=this.fragPrevious,p=Math.min(n.maxBufferLength,n.maxMaxBufferLength),g=Math.max(p,c.len),m=this.audioSwitch,v=this.trackId;if((u<g||m)&&v<a.length){if(void 0===(r=a[v].details)){this.state=et;break}if(!m&&this._streamEnded(d,r))return this.hls.trigger(se["default"].BUFFER_EOS,{type:"audio"}),void(this.state=nt);var y,E=r.fragments,T=E.length,A=E[0].start,_=E[T-1].start+E[T-1].duration;if(m)if(r.live&&!r.PTSKnown)oe.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),h=0;else if(h=e,r.PTSKnown&&e<A){if(!(d.end>A||d.nextStart))return;oe.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=A+.05}if(r.initSegment&&!r.initSegment.data)y=r.initSegment;else if(h<=A){if(y=E[0],null!==this.videoTrackCC&&y.cc!==this.videoTrackCC&&(y=function(e,t){return Me.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})}(E,this.videoTrackCC)),r.live&&y.loadIdx&&y.loadIdx===this.fragLoadIdx){var S=d.nextStart?d.nextStart:A;return oe.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(S+.05)),void(this.media.currentTime=S+.05)}}else{var w,R=n.maxFragLookUpTolerance,k=f?E[f.sn-E[0].sn+1]:undefined;(w=h<_?(_-R<h&&(R=0),k&&!b(h,R,k)?k:Me.search(E,function(e){return b(h,R,e)})):E[T-1])&&(A=(y=w).start,f&&y.level===f.level&&y.sn===f.sn&&(y.sn<r.endSN?(y=E[y.sn+1-r.startSN],this.fragmentTracker.getState(y)!==Oe&&oe.logger.log("SN just loaded, load next one: "+y.sn)):y=null))}y&&(y.encrypted?(oe.logger.log("Loading key for "+y.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+v),this.state=Je,i.trigger(se["default"].KEY_LOADING,{frag:y})):(this.fragCurrent=y,!m&&this.fragmentTracker.getState(y)!==Ce||(oe.logger.log("Loading "+y.sn+", cc: "+y.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+v+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+e+", bufferEnd: "+h.toFixed(3)),"initSegment"!==y.sn&&(this.startFragRequested=!0),Object(ae.isFiniteNumber)(y.sn)&&(this.nextLoadPosition=y.start+y.duration),i.trigger(se["default"].FRAG_LOADING,{frag:y}),this.state=$e)))}break;case et:(t=this.tracks[this.trackId])&&t.details&&(this.state=Qe);break;case Ze:var L=St.now(),D=this.retryDate,C=(s=this.media)&&s.seeking;(!D||D<=L||C)&&(oe.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=Qe);break;case st:var x=this.waitingFragment;if(x){var I=x.frag.cc;if(this.initPTS[I]!==undefined)this.waitingFragment=null,this.state=$e,this.onFragLoaded(x);else if(this.videoTrackCC!==this.waitingVideoCC)oe.logger.log("Waiting fragment cc ("+I+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var O=Fe.bufferInfo(this.mediaBuffer,this.media.currentTime,n.maxBufferHole);b(O.end,n.maxFragLookUpTolerance,x.frag)<0&&(oe.logger.log("Waiting fragment cc ("+I+") @ "+x.frag.start+" cancelled because another fragment at "+O.end+" is needed"),this.clearWaitingFragment())}}else this.state=Qe}},r.clearWaitingFragment=function(){var e=this.waitingFragment;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=Qe)},r.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},r.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(oe.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},r.onAudioTracksUpdated=function(e){oe.logger.log("audio tracks updated"),this.tracks=e.audioTracks},r.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state="PAUSED",t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=Qe),this.tick()},r.onAudioTrackLoaded=function(e){var t=e.details,r=e.id,i=this.tracks[r],n=i.details,a=t.totalduration,s=0;if(oe.logger.log("track "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live||n&&n.live?n&&0<t.fragments.length?(h(n,t),s=t.fragments[0].start,t.PTSKnown?oe.logger.log("live audio playlist sliding:"+s.toFixed(3)):oe.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,oe.logger.log("live audio playlist - first load, unknown sliding")):t.PTSKnown=!1,i.details=t,!this.startFragRequested){if(-1===this.startPosition){var o=t.startTimeOffset;Object(ae.isFiniteNumber)(o)?(oe.logger.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):t.live?(this.startPosition=this.computeLivePosition(s,t),oe.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===et&&(this.state=Qe),this.tick()},r.onKeyLoaded=function(){this.state===Je&&(this.state=Qe,this.tick())},r.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===$e&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var i=this.tracks[this.trackId],n=i.details,a=n.totalduration,s=t.level,o=t.sn,l=t.cc,d=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",c=this.stats=e.stats;if("initSegment"===o)this.state=Qe,c.tparsed=c.tbuffered=St.now(),n.initSegment.data=e.payload,this.hls.trigger(se["default"].FRAG_BUFFERED,{stats:c,frag:t,id:"audio"}),this.tick();else{this.state=tt,this.appended=!1,this.demuxer||(this.demuxer=new He(this.hls,"audio"));var u=this.initPTS[l],h=n.initSegment?n.initSegment.data:[];u!==undefined?(this.pendingBuffering=!0,oe.logger.log("Demuxing "+o+" of ["+n.startSN+" ,"+n.endSN+"],track "+s),this.demuxer.push(e.payload,h,d,null,t,a,!1,u)):(oe.logger.log("Unknown video PTS for cc "+l+", waiting for video PTS before demuxing audio frag "+o+" of ["+n.startSN+" ,"+n.endSN+"],track "+s),this.waitingFragment=e,this.waitingVideoCC=this.videoTrackCC,this.state=st)}}this.fragLoadError=0},r.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===tt){var i,n=e.tracks;if(n.video&&delete n.video,i=n.audio){i.levelCodec=i.codec,i.id=e.id,this.hls.trigger(se["default"].BUFFER_CODECS,n),oe.logger.log("audio track:audio,container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var a=i.initSegment;if(a){var s={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(se["default"].BUFFER_APPENDING,s))}this.tick()}}},r.onFragParsingData=function(e){var t=this,r=this.fragCurrent,i=e.frag;if(r&&"audio"===e.id&&"audio"===e.type&&i.sn===r.sn&&i.level===r.level&&this.state===tt){var n=this.trackId,a=this.tracks[n],s=this.hls;Object(ae.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),r.addElementaryStream(ce.AUDIO),oe.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),u(a.details,r,e.startPTS,e.endPTS);var o=this.media,l=!1;if(this.audioSwitch)if(o&&o.readyState){var d=o.currentTime;oe.logger.log("switching audio track : currentTime:"+d),d>=e.startPTS&&(oe.logger.log("switching audio track : flushing all audio"),this.state=it,s.trigger(se["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),l=!0,this.audioSwitch=!1,s.trigger(se["default"].AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,s.trigger(se["default"].AUDIO_TRACK_SWITCHED,{id:n});var c=this.pendingData;if(!c)return oe.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(se["default"].ERROR,{type:ne.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach(function(t){t&&t.length&&c.push({type:e.type,data:t,parent:"audio",content:"data"})}),!l&&c.length&&(c.forEach(function(e){t.state===tt&&(t.pendingBuffering=!0,t.hls.trigger(se["default"].BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},r.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===tt&&(this.stats.tparsed=St.now(),this.state=rt,this._checkAppendedParsed())},r.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},r.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},r.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==tt&&t!==rt||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},r._checkAppendedParsed=function(){if(!(this.state!==rt||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=St.now(),r.trigger(se["default"].FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;i&&oe.logger.log("audio buffered : "+Ye.toString(i.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(se["default"].AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=Qe}this.tick()}},r.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case ne.ErrorDetails.FRAG_LOAD_ERROR:case ne.ErrorDetails.FRAG_LOAD_TIMEOUT:var r=e.frag;if(r&&"audio"!==r.type)break;if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var n=this.config;if(i<=n.fragLoadingMaxRetry){this.fragLoadError=i;var a=Math.min(Math.pow(2,i-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);oe.logger.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=St.now()+a,this.state=Ze}else oe.logger.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=at}break;case ne.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ne.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ne.ErrorDetails.KEY_LOAD_ERROR:case ne.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==at&&(this.state=e.fatal?at:Qe,oe.logger.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case ne.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===tt||this.state===rt)){var s=this.mediaBuffer,o=this.media.currentTime;if(s&&Fe.isBuffered(s,o)&&Fe.isBuffered(s,o+.5)){var l=this.config;l.maxMaxBufferLength>=l.maxBufferLength&&(l.maxMaxBufferLength/=2,oe.logger.warn("AudioStreamController: reduce max buffer length to "+l.maxMaxBufferLength+"s")),this.state=Qe}else oe.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=it,this.hls.trigger(se["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},r.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(oe.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach(function(t){e.hls.trigger(se["default"].BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=rt):(this.state=Qe,this.fragPrevious=null,this.tick())},function(e,t,r){t&&L(e.prototype,t),r&&L(e,r)}(t,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,oe.logger.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}]),t}(lt),Rt=function(){function e(e){return"string"==typeof e&&!!n[e.toLowerCase()]&&e.toLowerCase()}function t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]=r[i]}return e}function r(r,n,a){var s=this,o={enumerable:!0};s.hasBeenReset=!1
;var l="",d=!1,c=r,u=n,h=a,f=null,p="",g=!0,m="auto",v="start",y=50,E="middle",b=50,T="middle";Object.defineProperty(s,"id",t({},o,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(s,"pauseOnExit",t({},o,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(s,"startTime",t({},o,{get:function(){return c},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",t({},o,{get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");u=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",t({},o,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",t({},o,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",t({},o,{get:function(){return p},set:function(e){var t=function(e){return"string"==typeof e&&!!i[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",t({},o,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",t({},o,{get:function(){return m},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",t({},o,{get:function(){return v},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");v=r,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",t({},o,{get:function(){return y},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",t({},o,{get:function(){return E},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");E=r,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",t({},o,{get:function(){return b},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",t({},o,{get:function(){return T},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");T=r,this.hasBeenReset=!0}})),s.displayState=void 0}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var i={"":!0,lr:!0,rl:!0},n={start:!0,middle:!0,end:!0,left:!0,right:!0};return r.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},r}(),kt=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};C.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var Lt=new Rt(0,0,0),Dt="middle"===Lt.align?"middle":"center";D.prototype={parse:function(e){function t(){var e=r.buffer,t=0;for(e=O(e);t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var i=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,r.buffer=e.substr(t),i}var r=this;e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===r.state){if(!/\r\n|\n/.test(r.buffer))return this;var n=(i=t()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");r.state="HEADER"}for(var a=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(a?a=!1:i=t(),r.state){case"HEADER":/:/.test(i)?x(i,function(e,t){},/:/):i||(r.state="ID");continue;case"NOTE":i||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){r.state="NOTE";break}if(!i)continue;if(r.cue=new Rt(0,0,""),r.state="CUE",-1===i.indexOf("--\x3e")){r.cue.id=i;continue}case"CUE":try{I(i,r.cue,r.regionList)}catch(ie){r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var s=-1!==i.indexOf("--\x3e");if(!i||s&&(a=!0)){r.oncue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}r.cue.text&&(r.cue.text+="\n"),r.cue.text+=i;continue;case"BADCUE":i||(r.state="ID");continue}}}catch(ie){"CUETEXT"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state="INITIAL"===r.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),!this.cue&&"HEADER"!==this.state||(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var Ct,xt,It=D,Ot={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Pt=function(e){var t=e;return Ot.hasOwnProperty(e)&&(t=Ot[e]),String.fromCharCode(t)},Mt=100,Ft={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Nt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ut={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Bt={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Gt=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(xt=Ct=Ct||{})[xt.ERROR=0]="ERROR",xt[xt.TEXT=1]="TEXT",xt[xt.WARNING=2]="WARNING",xt[xt.INFO=2]="INFO",xt[xt.DEBUG=3]="DEBUG",xt[xt.DATA=3]="DATA";var jt,Vt,Kt=function(){function e(){this.time=null,this.verboseLevel=Ct.ERROR}return e.prototype.log=function(e,t){this.verboseLevel>=e&&oe.logger.log(this.time+" ["+e+"] "+t)},e}(),Ht=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},Yt=function(){function e(e,t,r,i,n){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=i||"black",this.flash=n||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),zt=function(){function e(e,t,r,i,n,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Yt(t,r,i,n,a)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),qt=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<Mt;t++)this.chars.push(new zt);this.logger=e,this.pos=0,this.currPenState=new Yt}var t=e.prototype;return t.equals=function(e){for(var t=!0,r=0;r<Mt;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<Mt;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<Mt;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(Ct.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>Mt&&(this.logger.log(Ct.DEBUG,"Too large cursor position "+this.pos),this.pos=Mt)},t.moveCursor=function(e){var t=this.pos+e;if(1<e)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){144<=e&&this.backSpace();var t=Pt(e);this.pos>=Mt?this.logger.log(Ct.ERROR,"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<Mt;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<Mt;r++){var i=this.chars[r].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Wt=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<15;t++)this.rows.push(new qt(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(Ct.INFO,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(Ct.INFO,"pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<15;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var a=n.rows[i].cueStartTime,s=this.logger.time;if(a&&null!==s&&a<s)for(var o=0;o<this.nrRollUpRows;o++)this.rows[t-this.nrRollUpRows+o+1].copy(n.rows[i+o])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var d=e.indent,c=Math.max(d-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var u={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(u)},t.setBkgData=function(e){this.logger.log(Ct.INFO,"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(Ct.TEXT,this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(Ct.INFO,"Rolling up")}else this.logger.log(Ct.DEBUG,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",i=-1,n=0;n<15;n++){var a=this.rows[n].getTextString();a&&(i=n+1,e?t.push("Row "+i+": '"+a+"'"):t.push(a.trim()))}return 0<t.length&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),Xt=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Wt(r),this.nonDisplayedMemory=new Wt(r),this.lastOutputScreen=new Wt(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(Ct.INFO,"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(Ct.INFO,r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(Ct.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(Ct.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(Ct.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(Ct.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(Ct.INFO,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(Ct.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(Ct.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(Ct.INFO,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(Ct.INFO,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(Ct.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(Ct.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(Ct.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(this.logger.log(Ct.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(Ct.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(Ct.INFO,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=46<=e,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(Ct.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),Qt=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var i=new Kt;this.channels=[null,new Xt(e,t,i),new Xt(e+1,r,i)],this.cmdHistory=N(),this.logger=i}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var r,i,n,a=!1;this.logger.time=e;for(var s=0;s<t.length;s+=2)if(i=127&t[s],n=127&t[s+1],0!=i||0!=n){if(this.logger.log(Ct.DATA,"["+Ht([t[s],t[s+1]])+"] -> ("+Ht([i,n])+")"),!(r=(r=(r=(r=this.parseCmd(i,n))||this.parseMidrow(i,n))||this.parsePAC(i,n))||this.parseBackgroundAttributes(i,n))&&(a=this.parseChars(i,n))){var o=this.currentChannel;o&&0<o?this.channels[o].insertChars(a):this.logger.log(Ct.WARNING,"No channel found yet. TEXT-MODE?")}r||a||this.logger.log(Ct.WARNING,"Couldn't parse cleaned data "+Ht([i,n])+" orig: "+Ht([t[s],t[s+1]]))}},t.parseCmd=function(e,t){var r=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return!1;if(F(e,t,r))return M(null,null,r),this.logger.log(Ct.DEBUG,"Repeated command ("+Ht([e,t])+") is dropped"),!0;var i=20===e||21===e||23===e?1:2,n=this.channels[i];return 20===e||21===e||28===e||29===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),M(e,t,r),this.currentChannel=i,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&32<=t&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(Ct.ERROR,"Mismatch channel in midrow parsing"),!1;var i=this.channels[r];return!!i&&(i.ccMIDROW(t),this.logger.log(Ct.DEBUG,"MIDROW ("+Ht([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var r,i=this.cmdHistory;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return!1;if(F(e,t,i))return M(null,null,i),!0;var n=e<=23?1:2;r=64<=t&&t<=95?1==n?Ft[e]:Ut[e]:1==n?Nt[e]:Bt[e];var a=this.channels[n];return!!a&&(a.setPAC(this.interpretPAC(r,t)),M(e,t,i),this.currentChannel=n,!0)},t.interpretPAC=function(e,t){var r=t,i={color:null,italics:!1,indent:null,underline:!1,row:e};return r=95<t?t-96:t-64,i.underline=1==(1&r),r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i},t.parseChars=function(e,t){var r,i=null,n=null;if(17<=(n=25<=e?(r=2,e-8):(r=1,e))&&n<=19){var a=t;a=17===n?t+80:18===n?t+112:t+144,this.logger.log(Ct.INFO,"Special char '"+Pt(a)+"' in channel "+r),i=[a]}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var s=Ht(i);this.logger.log(Ct.DEBUG,"Char codes =  "+s.join(",")),M(e,t,this.cmdHistory)}return i},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47))return!1;var i={};16===e||24===e?(r=Math.floor((t-32)/2),i.background=Gt[r],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));var n=e<=23?1:2;return this.channels[n].setBkgData(i),M(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory=N()},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}(),Jt=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[]},e}(),$t=function(e,t,r){return e.substr(r||0,t.length)===t},Zt=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()},er=function(e,t,r){var i=e[t],n=e[i.prevCC];if(!n||!n["new"]&&i["new"])return e.ccOffset=e.presentationOffset=i.start,void(i["new"]=!1);for(;n&&n["new"];)e.ccOffset+=i.start-n.start,i["new"]=!1,n=e[(i=n).prevCC];e.presentationOffset=r},tr={parse:function(e,t,r,i,n,a){var s,o=Object(ut.utf8ArrayToStr)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),l="00:00.000",d=0,c=0,u=0,h=[],f=!0,p=!1,g=new It;g.oncue=function(e){var t=r[i],n=r.ccOffset;t&&t["new"]&&(c!==undefined?n=r.ccOffset=t.start:er(r,i,u)),u&&(n=u-r.presentationOffset),p&&(e.startTime+=n-c,e.endTime+=n-c),e.id=Zt(e.startTime.toString())+Zt(e.endTime.toString())+Zt(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),0<e.endTime&&h.push(e)},g.onparsingerror=function(e){s=e},g.onflush=function(){s&&a?a(s):n(h)},o.forEach(function(e){if(f){if($t(e,"X-TIMESTAMP-MAP=")){p=!(f=!1),e.substr(16).split(",").forEach(function(e){$t(e,"LOCAL:")?l=e.substr(6):$t(e,"MPEGTS:")&&(d=parseInt(e.substr(7)))});try{t+(9e4*r[i].start||0)<0&&(t+=8589934592),d-=t,c=function(e){var t=parseInt(e.substr(-3)),r=parseInt(e.substr(-6,2)),i=parseInt(e.substr(-9,2)),n=9<e.length?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(ae.isFiniteNumber)(t)&&Object(ae.isFiniteNumber)(r)&&Object(ae.isFiniteNumber)(i)&&Object(ae.isFiniteNumber)(n)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,t+=6e4*i,t+=36e5*n}(l)/1e3,u=d/9e4}catch(n){p=!1,s=n}return}""===e&&(f=!1)}g.parse(e+"\n")}),g.flush()}},rr=function(e){function t(t){var r;if((r=e.call(this,t,se["default"].MEDIA_ATTACHING,se["default"].MEDIA_DETACHING,se["default"].FRAG_PARSING_USERDATA,se["default"].FRAG_DECRYPTED,se["default"].MANIFEST_LOADING,se["default"].MANIFEST_LOADED,se["default"].FRAG_LOADED,se["default"].INIT_PTS_FOUND)||this).media=null,r.config=void 0,r.enabled=!0,r.Cues=void 0,r.textTracks=[],r.tracks=[],r.initPTS=[],r.unparsedVttFrags=[],r.captionsTracks={},r.nonNativeCaptionsTracks={},r.captionsProperties=void 0,r.cea608Parser1=void 0,r.cea608Parser2=void 0,r.lastSn=-1,r.prevCC=-1,r.vttCCs=B(),r.hls=t,r.config=t.config,r.Cues=t.config.cueHandler,r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode},textTrack3:{label:r.config.captionsTextTrack3Label,languageCode:r.config.captionsTextTrack3LanguageCode},textTrack4:{label:r.config.captionsTextTrack4Label,languageCode:r.config.captionsTextTrack4LanguageCode}},r.config.enableCEA708Captions){var i=new Jt(U(r),"textTrack1"),n=new Jt(U(r),"textTrack2"),a=new Jt(U(r),"textTrack3"),s=new Jt(U(r),"textTrack4");r.cea608Parser1=new Qt(1,i,n),r.cea608Parser2=new Qt(3,a,s)}return r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.addCues=function(e,t,r,i,n){for(var a,s,o,l,d=!1,c=n.length;c--;){var u=n[c],h=(a=u[0],s=u[1],o=t,l=r,Math.min(s,l)-Math.max(a,o));if(0<=h&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],r),d=!0,.5<h/(r-t)))return}if(d||n.push([t,r]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],t,r,i);else{var f=this.Cues.newCue(null,t,r,i);this.hls.trigger(se["default"].CUES_PARSED,{type:"captions",cues:f,track:e})}},r.onInitPtsFound=function(e){var t=this,r=e.frag,i=e.id,n=e.initPTS,a=this.unparsedVttFrags;"main"===i&&(this.initPTS[r.cc]=n),a.length&&(this.unparsedVttFrags=[],a.forEach(function(e){t.onFragLoaded(e)}))},r.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var i=t.textTracks[r];if(i[e])return i}return null},r.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},r.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,i=this.media,n=t[e],a=n.label,s=n.languageCode,o=this.getExistingTrack(e);if(o)r[e]=o,S(r[e]),_(r[e],i);else{var l=this.createTextTrack("captions",a,s);l&&(l[e]=!0,r[e]=l)}}},r.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions","default":!!t.media&&!!t.media["default"],closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(se["default"].NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},r.createTextTrack=function(e,t,r){var i=this.media;if(i)return i.addTextTrack(e,t,r)},r.destroy=function(){e.prototype.destroy.call(this)},r.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},r.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(t){S(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}},r.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs=B(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},r._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)S(t[r])}},r.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var r=e.subtitles||[],i=this.tracks&&r&&this.tracks.length===r.length;if(this.tracks=e.subtitles||[],this.config.renderTextTracksNatively){var n=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,r){var i,a,s;if(r<n.length){for(var o=null,l=0;l<n.length;l++)if(a=n[l],s=e,a&&a.label===s.name&&!a.textTrack1&&!a.textTrack2){o=n[l];break}o&&(i=o)}i=i||t.createTextTrack("subtitles",e.name,e.lang),e["default"]?i.mode=t.hls.subtitleDisplay?"showing":"hidden":i.mode="disabled",t.textTracks.push(i)})}else if(!i&&this.tracks&&this.tracks.length){var a=this.tracks.map(function(e){return{label:e.name,kind:e.type.toLowerCase(),"default":e["default"],subtitleTrack:e}});this.hls.trigger(se["default"].NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(function(e){var r=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(r){var i="textTrack"+r[1],n=t.captionsProperties[i];n&&(n.label=e.name,e.lang&&(n.languageCode=e.lang),n.media=e)}})},r.onFragLoaded=function(e){var t=e.frag,r=e.payload,i=this.cea608Parser1,n=this.cea608Parser2,a=this.initPTS,s=this.lastSn,o=this.unparsedVttFrags;if("main"===t.type){var l=t.sn;t.sn!==s+1&&i&&n&&(i.reset(),n.reset()),this.lastSn=l}else if("subtitle"===t.type)if(r.byteLength){if(!Object(ae.isFiniteNumber)(a[t.cc]))return o.push(e),void(a.length&&this.hls.trigger(se["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var d=t.decryptdata;null!=d&&null!=d.key&&"AES-128"===d.method||this._parseVTTs(t,r)}else this.hls.trigger(se["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},r._parseVTTs=function(e,t){var r=this,i=this.hls,n=this.prevCC,a=this.textTracks,s=this.vttCCs;s[e.cc]||(s[e.cc]={start:e.start,prevCC:n,"new":!0},this.prevCC=e.cc),tr.parse(t,this.initPTS[e.cc],s,e.cc,function(t){if(r.config.renderTextTracksNatively){var n=a[e.level];if("disabled"===n.mode)return void i.trigger(se["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e});t.forEach(function(t){if(!n.cues.getCueById(t.id))try{if(n.addCue(t),!n.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(e){oe.logger.debug("Failed occurred on adding cues: "+e);var r=new window.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id,n.addCue(r)}})}else{var s=r.tracks[e.level]["default"]?"default":"subtitles"+e.level;i.trigger(se["default"].CUES_PARSED,{type:"subtitles",cues:t,track:s})}i.trigger(se["default"].SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(t){oe.logger.log("Failed to parse VTT cue: "+t),i.trigger(se["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})})},r.onFragDecrypted=function(e){var t=e.frag,r=e.payload;if("subtitle"===t.type){if(!Object(ae.isFiniteNumber)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,r)}},r.onFragParsingUserdata=function(e){var t=this.cea608Parser1,r=this.cea608Parser2;if(this.enabled&&t&&r)for(var i=0;i<e.samples.length;i++){var n=e.samples[i].bytes;if(n){var a=this.extractCea608Data(n);t.addData(e.samples[i].pts,a[0]),r.addData(e.samples[i].pts,a[1])}}},r.extractCea608Data=function(e){for(var t=31&e[0],r=2,i=[[],[]],n=0;n<t;n++){var a=e[r++],s=127&e[r++],o=127&e[r++],l=3&a;0==s&&0==o||0!=(4&a)&&(0!=l&&1!=l||(i[l].push(s),i[l].push(o)))}return i},t}(de),ir=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].MEDIA_ATTACHED,se["default"].MEDIA_DETACHING,se["default"].MANIFEST_LOADED,se["default"].SUBTITLE_TRACK_LOADED)||this).tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r.queuedDefaultTrack=null,r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.destroy=function(){de.prototype.destroy.call(this)},r.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(ae.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},r.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(ae.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),j(this.media.textTracks).forEach(function(e){S(e)}),this.subtitleTrack=-1,this.media=null)},r.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(se["default"].SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(e){e["default"]&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},r.onSubtitleTrackLoaded=function(e){var t=this,r=e.id,i=e.details,n=this.trackId,a=this.tracks,s=a[n];if(r>=a.length||r!==n||!s||this.stopped)this._clearReloadTimer();else if(oe.logger.log("subtitle track "+r+" loaded"),i.live){var o=p(s.details,i,e.stats.trequest);oe.logger.log("Reloading live subtitle playlist in "+o+"ms"),
this.timer=setTimeout(function(){t._loadCurrentTrack()},o)}else this._clearReloadTimer()},r.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},r.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},r._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},r._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,r=this.hls,i=t[e];e<0||!i||i.details&&!i.details.live||(oe.logger.log("Loading subtitle track "+e),r.trigger(se["default"].SUBTITLE_TRACK_LOADING,{url:i.url,id:e}))},r._toggleTrackModes=function(e){var t=this.media,r=this.subtitleDisplay,i=this.trackId;if(t){var n=j(t.textTracks);if(-1===e)[].slice.call(n).forEach(function(e){e.mode="disabled"});else{var a=n[i];a&&(a.mode="disabled")}var s=n[e];s&&(s.mode=r?"showing":"hidden")}},r._setSubtitleTrackInternal=function(e){var t=this.hls,r=this.tracks;!Object(ae.isFiniteNumber)(e)||e<-1||e>=r.length||(this.trackId=e,oe.logger.log("Switching to subtitle track "+e),t.trigger(se["default"].SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},r._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=j(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack=e}},function(e,t,r){t&&G(e.prototype,t),r&&G(e,r)}(t,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}]),t}(de),nr=r("./src/crypt/decrypter.js"),ar=window.performance,sr=function(e){function t(t,r){var i;return(i=e.call(this,t,se["default"].MEDIA_ATTACHED,se["default"].MEDIA_DETACHING,se["default"].ERROR,se["default"].KEY_LOADED,se["default"].FRAG_LOADED,se["default"].SUBTITLE_TRACKS_UPDATED,se["default"].SUBTITLE_TRACK_SWITCH,se["default"].SUBTITLE_TRACK_LOADED,se["default"].SUBTITLE_FRAG_PROCESSED,se["default"].LEVEL_UPDATED)||this).fragmentTracker=r,i.config=t.config,i.state=We,i.tracks=[],i.tracksBuffered=[],i.currentTrackId=-1,i.decrypter=new nr["default"](t,t.config),i.lastAVStart=0,i._onMediaSeeking=i.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.startLoad=function(){this.stopLoad(),this.state=Qe;var e=this.tracks[this.currentTrackId];e&&e.details&&(this.setInterval(500),this.tick())},r.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=Qe,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var n,a=t.start,s=0;s<i.length;s++)if(a>=i[s].start&&a<=i[s].end){n=i[s];break}var o=t.start+t.duration;n?n.end=o:(n={start:a,end:o},i.push(n))}}},r.onMediaAttached=function(e){var t=e.media;(this.media=t).addEventListener("seeking",this._onMediaSeeking),this.state=Qe},r.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach(function(t){e.tracksBuffered[t.id]=[]}),this.media=null,this.state=We)},r.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=Qe)},r.onSubtitleTracksUpdated=function(e){var t=this;oe.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]})},r.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},r.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,i=this.currentTrackId,n=this.tracks,a=n[i];t>=n.length||t!==i||!a||(r.live&&function(e,t,r){void 0===r&&(r=0);var i=-1;f(e,t,function(e,t,r){t.start=e.start,i=r});var n=t.fragments;if(i<0)n.forEach(function(e){e.start+=r});else for(var a=i+1;a<n.length;a++)n[a].start=n[a-1].start+n[a-1].duration}(a.details,r,this.lastAVStart),a.details=r,this.setInterval(500))},r.onKeyLoaded=function(){this.state===Je&&(this.state=Qe)},r.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag.decryptdata,i=e.frag,n=this.hls;if(this.state===$e&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&0<e.payload.byteLength&&r&&r.key&&"AES-128"===r.method){var a=ar.now();this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,function(e){var t=ar.now();n.trigger(se["default"].FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:a,tdecrypt:t}})})}},r.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},r.doTick=function(){if(this.media)switch(this.state){case Qe:var e=this.config,t=this.currentTrackId,r=this.fragmentTracker,i=this.media,n=this.tracks;if(!n||!n[t]||!n[t].details)break;var a,s=e.maxBufferHole,o=e.maxFragLookUpTolerance,l=Math.min(e.maxBufferLength,e.maxMaxBufferLength),d=Fe.bufferedInfo(this._getBuffered(),i.currentTime,s),c=d.end,u=d.len,h=n[t].details,f=h.fragments,p=f.length,g=f[p-1].start+f[p-1].duration;if(l<u)return;var m=this.fragPrevious;(a=c<g?(m&&h.hasProgramDateTime&&(a=y(f,m.endProgramDateTime,o)),a||E(m,f,c,o)):f[p-1])&&a.encrypted?(oe.logger.log("Loading key for "+a.sn),this.state=Je,this.hls.trigger(se["default"].KEY_LOADING,{frag:a})):a&&r.getState(a)===Ce&&(this.fragCurrent=a,this.state=$e,this.hls.trigger(se["default"].FRAG_LOADING,{frag:a}))}else this.state=Qe},r.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,e.prototype.stopLoad.call(this)},r._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},r.onMediaSeeking=function(){if(this.fragCurrent){var e=this.media?this.media.currentTime:0,t=this.config.maxFragLookUpTolerance,r=this.fragCurrent.start-t,i=this.fragCurrent.start+this.fragCurrent.duration+t;(e<r||i<e)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=Qe,this.tick())}},t}(lt);(Vt=jt=jt||{}).WIDEVINE="com.widevine.alpha",Vt.PLAYREADY="com.microsoft.playready";var or="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null,lr=function(e,t,r){var i={audioCapabilities:[],videoCapabilities:[]};return e.forEach(function(e){i.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:r.audioRobustness||""})}),t.forEach(function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:r.videoRobustness||""})}),[i]},dr=function(e){function t(t){var r;return(r=e.call(this,t,se["default"].MEDIA_ATTACHED,se["default"].MEDIA_DETACHED,se["default"].MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,r._licenseXhrSetup=void 0,r._emeEnabled=void 0,r._requestMediaKeySystemAccess=void 0,r._drmSystemOptions=void 0,r._config=void 0,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._requestLicenseFailureCount=0,r.mediaKeysPromise=null,r._onMediaEncrypted=function(e){if(oe.logger.log('Media is encrypted using "'+e.initDataType+'" init data type'),!r.mediaKeysPromise)return oe.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void r.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var t=function(t){r._media&&(r._attemptSetMediaKeys(t),r._generateRequestWithPreferredKeySession(e.initDataType,e.initData))};r.mediaKeysPromise.then(t)["catch"](t)},r._config=t.config,r._widevineLicenseUrl=r._config.widevineLicenseUrl,r._licenseXhrSetup=r._config.licenseXhrSetup,r._emeEnabled=r._config.emeEnabled,r._requestMediaKeySystemAccess=r._config.requestMediaKeySystemAccessFunc,r._drmSystemOptions=t.config.drmSystemOptions,r}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var r=t.prototype;return r.getLicenseServerUrl=function(e){switch(e){case jt.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},r._attemptKeySystemAccess=function(e,t,r){var i=this,n=function(e,t,r,i){switch(e){case jt.WIDEVINE:return lr(t,r,i);default:throw new Error("Unknown key-system: "+e)}}(e,t,r,this._drmSystemOptions);oe.logger.log("Requesting encrypted media key-system access");var a=this.requestMediaKeySystemAccess(e,n);this.mediaKeysPromise=a.then(function(t){return i._onMediaKeySystemAccessObtained(e,t)}),a["catch"](function(t){oe.logger.error('Failed to obtain key-system "'+e+'" access:',t)})},r._onMediaKeySystemAccessObtained=function(e,t){var r=this;oe.logger.log('Access for key-system "'+e+'" obtained');var i={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(i);var n=Promise.resolve().then(function(){return t.createMediaKeys()}).then(function(t){return i.mediaKeys=t,oe.logger.log('Media-keys created for key-system "'+e+'"'),r._onMediaKeysCreated(),t});return n["catch"](function(e){oe.logger.error("Failed to create media-keys:",e)}),n},r._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))})},r._onNewMediaKeySession=function(e){var t=this;oe.logger.log("New key-system session "+e.sessionId),e.addEventListener("message",function(r){t._onKeySessionMessage(e,r.message)},!1)},r._onKeySessionMessage=function(e,t){oe.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(t){oe.logger.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)})},r._attemptSetMediaKeys=function(e){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return oe.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});oe.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},r._generateRequestWithPreferredKeySession=function(e,t){var r=this,i=this._mediaKeysList[0];if(!i)return oe.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(i.mediaKeysSessionInitialized)oe.logger.warn("Key-Session already initialized but requested again");else{var n=i.mediaKeysSession;if(!n)return oe.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return oe.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});oe.logger.log('Generating key-session request for "'+e+'" init data type'),i.mediaKeysSessionInitialized=!0,n.generateRequest(e,t).then(function(){oe.logger.debug("Key-session generation succeeded")})["catch"](function(e){oe.logger.error("Error generating key-session request:",e),r.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},r._createLicenseXhr=function(e,t,r){var i=new XMLHttpRequest,n=this._licenseXhrSetup;try{if(n)try{n(i,e)}catch(te){i.open("POST",e,!0),n(i,e)}i.readyState||i.open("POST",e,!0)}catch(te){throw new Error("issue setting up KeySystem license XHR "+te)}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,e,t,r),i},r._onLicenseRequestReadyStageChange=function(e,t,r,i){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,oe.logger.log("License request succeeded"),"arraybuffer"!==e.responseType&&oe.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),i(e.response);else{if(oe.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),3<++this._requestLicenseFailureCount)return void this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var n=3-this._requestLicenseFailureCount+1;oe.logger.warn("Retrying license request, "+n+" attempts left"),this._requestLicense(r,i)}}},r._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case jt.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},r._requestLicense=function(e,t){oe.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return oe.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var i=this.getLicenseServerUrl(r.mediaKeySystemDomain),n=this._createLicenseXhr(i,e,t);oe.logger.log("Sending license request to URL: "+i);var a=this._generateLicenseRequestChallenge(r,e);n.send(a)}catch(re){oe.logger.error("Failure requesting DRM license: "+re),this.hls.trigger(se["default"].ERROR,{type:ne.ErrorTypes.KEY_SYSTEM_ERROR,details:ne.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},r.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;(this._media=t).addEventListener("encrypted",this._onMediaEncrypted)}},r.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close()["catch"](function(){})})).then(function(){return e.setMediaKeys(null)})["catch"](function(){}))},r.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map(function(e){return e.audioCodec}),r=e.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(jt.WIDEVINE,t,r)}},function(e,t,r){t&&V(e.prototype,t),r&&V(e,r)}(t,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),t}(de),cr=H(H({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:Infinity,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:At,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:mt,bufferController:yt,capLevelController:Et,fpsController:Tt,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:or,testBandwidth:!0},function(){return{cueHandler:$,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}()),{},{subtitleStreamController:sr,subtitleTrackController:ir,timelineController:rr,audioStreamController:wt,audioTrackController:_t,emeController:dr}),ur=function(e){function t(r){var i;void 0===r&&(r={}),(i=e.call(this)||this).config=void 0,i._autoLevelCapping=void 0,i.abrController=void 0,i.capLevelController=void 0,i.levelController=void 0,i.streamController=void 0,i.networkControllers=void 0,i.audioTrackController=void 0,i.subtitleTrackController=void 0,i.emeController=void 0,i.coreComponents=void 0,i.media=null,i.url=null;var n=t.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");i.config=q(q({},n),r);var a=X(i).config;if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==a.liveMaxLatencyDuration&&(void 0===a.liveSyncDuration||a.liveMaxLatencyDuration<=a.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(oe.enableLogs)(a.debug),i._autoLevelCapping=-1;var s=i.abrController=new a.abrController(X(i)),o=new a.bufferController(X(i)),l=i.capLevelController=new a.capLevelController(X(i)),d=new a.fpsController(X(i)),c=new ke(X(i)),u=new Le(X(i)),h=new De(X(i)),f=new ht(X(i)),p=i.levelController=new ct(X(i)),g=new Pe(X(i)),m=[p,i.streamController=new dt(X(i),g)],v=a.audioStreamController;v&&m.push(new v(X(i),g)),i.networkControllers=m;var y=[c,u,h,s,o,l,d,f,g];if(v=a.audioTrackController){var E=new v(X(i));i.audioTrackController=E,y.push(E)}if(v=a.subtitleTrackController){var b=new v(X(i));i.subtitleTrackController=b,m.push(b)}if(v=a.emeController){var T=new v(X(i));i.emeController=T,y.push(T)}return(v=a.subtitleStreamController)&&m.push(new v(X(i),g)),(v=a.timelineController)&&y.push(new v(X(i))),i.coreComponents=y,i}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e),t.isSupported=function(){return function(){var e=l();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!i}()},J(t,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return se["default"]}},{key:"ErrorTypes",get:function(){return ne.ErrorTypes}},{key:"ErrorDetails",get:function(){return ne.ErrorDetails}},{key:"DefaultConfig",get:function(){return t.defaultConfig?t.defaultConfig:cr},set:function(e){t.defaultConfig=e}}]);var r=t.prototype;return r.destroy=function(){oe.logger.log("destroy"),this.trigger(se["default"].DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},r.attachMedia=function(e){oe.logger.log("attachMedia"),this.media=e,this.trigger(se["default"].MEDIA_ATTACHING,{media:e})},r.detachMedia=function(){oe.logger.log("detachMedia"),this.trigger(se["default"].MEDIA_DETACHING),this.media=null},r.loadSource=function(e){e=ie.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),oe.logger.log("loadSource:"+e),this.url=e,this.trigger(se["default"].MANIFEST_LOADING,{url:e})},r.startLoad=function(e){void 0===e&&(e=-1),oe.logger.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})},r.stopLoad=function(){oe.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},r.swapAudioCodec=function(){oe.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},r.recoverMediaError=function(){oe.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},r.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},J(t,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){oe.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){oe.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){oe.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){oe.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){oe.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){oe.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,i=0;i<r;i++)if(t<(e[i].realBitrate?Math.max(e[i].realBitrate,e[i].bitrate):e[i].bitrate))return i;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),t}(je);ur.defaultConfig=void 0},"./src/polyfills/number.js":function(e,t,r){"use strict";r.r(t),r.d(t,"isFiniteNumber",function(){return i}),r.d(t,"MAX_SAFE_INTEGER",function(){return n});var i=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},n=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(e,t,r){"use strict";function i(){return"undefined"==typeof window?self:window}r.r(t),r.d(t,"getSelfScope",function(){return i})},"./src/utils/logger.js":function(e,t,r){"use strict";function i(){}function n(e){var t=l.console[e];return t?function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];i[0]&&(i[0]=function(e,t){return t="["+e+"] > "+t}(e,i[0])),t.apply(l.console,i)}:i}r.r(t),r.d(t,"enableLogs",function(){return d}),r.d(t,"logger",function(){return c});var a=r("./src/utils/get-self-scope.js"),s={trace:i,debug:i,log:i,warn:i,info:i,error:i},o=s,l=Object(a.getSelfScope)(),d=function(e){if(l.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];r.forEach(function(t){o[t]=e[t]?e[t].bind(e):n(t)})}(e,"debug","log","info","warn","error");try{o.log()}catch(t){o=s}}else o=s},c=o}},e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:i})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var n in t)e.d(i,n,function(e){return t[e]}.bind(null,n));return i},e.n=function(t){var r=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(r,"a",r),r},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="/dist/",e(e.s="./src/hls.ts"))["default"];var t,r},e.exports=i())},function(e,t,r){"use strict";function i(e){this.options=e,this.el=n.createEl("div",{"class":"mptcfe-player__control"}),this.progressIns=new a.Progress(e),this.opareIns=new s.Opare(e),n.appendChildren(this.el,[this.progressIns.el,this.opareIns.el])}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=r(27),s=r(28),o=(i.prototype.dispose=function(){},i);t.ControlBar=o},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.isMousedownProgressBall=!1,t.options=e,t.el=o.createEl("div",{"class":"progress-bar hover"}),t.defaultProgressEL=o.createEl("div",{"class":"progress-bar__line progress-bar__default"}),t.loadedProgressEL=o.createEl("div",{"class":"progress-bar__line progress-bar__loaded"}),t.playingProgressEL=o.createEl("div",{"class":"progress-bar__line progress-bar__ing"}),t.progressBallEL=o.createEl("span",{"class":"progress-bar__ball"}),t.progressBallEL.innerHTML='<span class="dot"></span>',o.appendChildren(t.playingProgressEL,[t.progressBallEL]),o.appendChildren(t.el,[t.defaultProgressEL,t.loadedProgressEL,t.playingProgressEL]),t.onEvent(),setTimeout(function(){t.bindEvent()},200),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=r(2),c=(s=l.Component,a(i,s),i.prototype.onEvent=function(){var e=this;this.on(this.VIDEO_EVENT_MAP.TIMEUPDATE,function(t){e.isMousedownProgressBall||e.setProgressCurrent(t.currentRatio)}),this.on(this.VIDEO_EVENT_MAP.BUFFERUPDATE,this.setProgressBuffer.bind(this))},i.prototype.bindEvent=function(){this.handleClickProgress(),this.handleDragProgressBall()},i.prototype.handleClickProgress=function(){var e=this;this.el.addEventListener("click",function(t){var r={el:e.el,event:t,left:e.el.offsetLeft,length:e.el.clientWidth};e.emit(d.ACTION_EVENT_MAP.CHANGE_PROGRESS,r)})},i.prototype.handleDragProgressBall=function(){var e=this;this.progressBallEL.addEventListener("mousedown",function(t){e.isMousedownProgressBall=!0}),document.addEventListener("mousemove",function(t){if(e.isMousedownProgressBall){var r={el:e.el,event:t,left:e.el.offsetLeft,length:e.el.clientWidth},i=o.getPointerPosition(e.el,event);e.setProgressCurrent(i.x),clearTimeout(e.mousemoveTimer),e.mousemoveTimer=setTimeout(function(){e.emit(d.ACTION_EVENT_MAP.CHANGE_PROGRESS,r)},200)}}),document.addEventListener("mouseup",function(t){e.isMousedownProgressBall&&(e.isMousedownProgressBall=!1)})},i.prototype.setProgressCurrent=function(e){this.playingProgressEL.style.width=100*e+"%"},i.prototype.setProgressBuffer=function(e){this.loadedProgressEL.style.width=100*e.bufferedRatio+"%"},i.prototype.dispose=function(){},i);t.Progress=c},function(e,t,r){"use strict";function i(e){this.options=e,this.el=n.createEl("div",{"class":"mptcfe-player__opare"}),this.playBtnIns=new a.PlayBtn(e),this.TimeIns=new s.Time(e),this.FullScreenBtnIns=new o.FullScreenBtn(e),this.VolumeBtnIns=new l.VolumeBtn(e),n.appendChildren(this.el,[this.playBtnIns.el,this.TimeIns.el,this.FullScreenBtnIns.el,this.VolumeBtnIns.el])}Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=r(29),s=r(30),o=r(31),l=r(32),d=(i.prototype.dispose=function(){},i);t.Opare=d},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.options=e,t.el=o.createEl("div",{"class":"control-play-btn"}),t.playEl=o.createEl("span",{"class":"play-icon"}),t.playEl.innerHTML='\n        <span class="control-play-tip">\n            播放\n        </span>',t.pauseEl=o.createEl("span",{"class":"pause-icon"}),t.pauseEl.innerHTML='\n        <span class="control-play-tip">\n            暂停\n        </span>',o.appendChildren(t.el,[t.playEl,t.pauseEl]),t.init(),t.onEvent(),setTimeout(function(){t.bindEvent()},150),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=(s=l.Component,a(i,s),i.prototype.init=function(){this.transPlayBtn({isPlay:1===window.SOHU_MPTCFE_PLAYER.state})},i.prototype.onEvent=function(){var e=this;this.on(this.VIDEO_EVENT_MAP.PLAY,function(){e.transPlayBtn({isPlay:!0})}),this.on(this.ACTION_EVENT_MAP.PLAY_REPEAT,function(){e.transPlayBtn({isPlay:!0})}),this.on(this.VIDEO_EVENT_MAP.PAUSE,function(){e.transPlayBtn({isPlay:!1})}),this.on(this.VIDEO_EVENT_MAP.ENDED,function(){e.transPlayBtn({isPlay:!1})})},i.prototype.bindEvent=function(){var e=this;this.el.addEventListener("click",function(t){0===window.SOHU_MPTCFE_PLAYER.state?(e.transPlayBtn({isPlay:!0}),e.emit(e.ACTION_EVENT_MAP.PLAY)):1===window.SOHU_MPTCFE_PLAYER.state&&(e.emit(e.ACTION_EVENT_MAP.PAUSE),e.transPlayBtn({isPlay:!1}))})},i.prototype.transPlayBtn=function(e){void 0===e&&(e={isPlay:!0}),e.isPlay?(this.show(this.pauseEl),this.hide(this.playEl)):(this.show(this.playEl),this.hide(this.pauseEl))},i.prototype.dispose=function(){},i);t.PlayBtn=d},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.options=e,t.el=o.createEl("div",{"class":"control-time"}),t.timeCurrentEl=o.createEl("span",{"class":"control-time-current"},"00:00"),t.TimeSplitEl=o.createEl("span",{"class":"control-time-split"},"/"),t.TimeDurationEl=o.createEl("span",{"class":"control-time-duration"},"00:00"),
o.appendChildren(t.el,[t.timeCurrentEl,t.TimeSplitEl,t.TimeDurationEl]),t.onEvent(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=(s=l.Component,a(i,s),i.prototype.onEvent=function(){var e=this;this.on(this.VIDEO_EVENT_MAP.LOADED,function(t){e.TimeDurationEl.innerHTML=e.formatTime(t.duration)}),this.on(this.VIDEO_EVENT_MAP.TIMEUPDATE,function(t){e.timeCurrentEl.innerHTML=e.formatTime(t.el.currentTime)})},i.prototype.formatTime=function(e){var t=Math.floor(e);return 59<t?(9<Math.floor(t/60)?Math.floor(t/60):"0"+Math.floor(t/60))+":"+(9<t%60?t%60:"0"+t%60):"00:"+(9<t?t:"0"+t)},i.prototype.dispose=function(){},i);t.Time=d},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.isFullScreen=!1,t.options=e,t.el=o.createEl("div",{"class":"control-fullscreen-btn"}),t.fullEl=o.createEl("span",{"class":"full-icon"}),t.shrinklEl=o.createEl("span",{"class":"shrinkl-icon"}),o.appendChildren(t.el,[t.fullEl,t.shrinklEl]),t.onEvent(),setTimeout(function(){t.bindEvent()},150),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=(s=l.Component,a(i,s),i.prototype.onEvent=function(){var e=this;this.on(this.ACTION_EVENT_MAP.TOGGLE_FULLSCREEN,function(t){e.transFullScreenBtn({isFullScreen:t==undefined?!e.isFullScreen:t})}),window.onresize=function(t){e.isFullScreen&&(clearTimeout(e.timer),e.timer=setTimeout(function(){e.checkFull()||e.transFullScreenBtn({isFullScreen:!1})},300))}},i.prototype.checkFull=function(){return window.document.isFullScreen||window.document.mozFullScreen||window.document.webkitIsFullScreen||window.document.msFullscreenElement},i.prototype.bindEvent=function(){var e=this;this.el.addEventListener("click",function(t){e.isFullScreen?e.transFullScreenBtn({isFullScreen:!1}):e.transFullScreenBtn({isFullScreen:!0})})},i.prototype.transFullScreenBtn=function(e){void 0===e&&(e={isFullScreen:!0}),this.options.Video.el;try{if(e.isFullScreen){var t=document.body;this.emit(this.VIDEO_EVENT_MAP.FULLSCREEN),this.hide(this.fullEl),this.show(this.shrinklEl),t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():t.oRequestFullscreen?t.oRequestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullScreen(),this.isFullScreen=!0}e.isFullScreen||(t=document,this.emit(this.VIDEO_EVENT_MAP.EXITFULLSCREEN),this.show(this.fullEl),this.hide(this.shrinklEl),t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.oRequestFullscreen?t.oCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen(),this.isFullScreen=!1)}catch(r){}},i.prototype.dispose=function(){},i);t.FullScreenBtn=d},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;t.isMousedownVolumeBall=!1,t.options=e,t.el=o.createEl("div",{"class":"control-volume-btn"}),t.volumeBtnEl=o.createEl("span",{"class":"volume-icon"}),t.volumeDefaultEl=o.createEl("span",{"class":"volume-icon-default"}),t.volumeMuteEl=o.createEl("span",{"class":"volume-icon-mute"}),t.volumeBoxEl=o.createEl("div",{"class":"volume-box"}),t.mainVolumeBoxEl=o.createEl("div",{"class":"volume-main-box"}),t.volumeBoxLineEl=o.createEl("div",{"class":"volume-line-wrapper"});var r=o.createEl("div",{"class":"volume-line"});return t.volumeBoxLineIngEl=o.createEl("div",{"class":"volume-line__ing"}),t.volumeBoxLineBallEl=o.createEl("span",{"class":"volume-line__ball"}),o.appendChildren(t.volumeBoxLineIngEl,[t.volumeBoxLineBallEl]),o.appendChildren(t.volumeBoxLineEl,[r,t.volumeBoxLineIngEl]),o.appendChildren(t.mainVolumeBoxEl,[t.volumeBoxLineEl]),o.appendChildren(t.volumeBoxEl,[t.mainVolumeBoxEl]),o.appendChildren(t.volumeBtnEl,[t.volumeMuteEl,t.volumeDefaultEl]),o.appendChildren(t.el,[t.volumeBtnEl,t.volumeBoxEl]),t.init(),setTimeout(function(){t.bindEvent()},100),t.onEvent(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(2),d=r(1),c=(s=d.Component,a(i,s),i.prototype.init=function(){this.setVolume(window.SOHU_MPTCFE_PLAYER.muted?0:1)},i.prototype.onEvent=function(){var e=this;this.on(l.VIDEO_EVENT_MAP.LOADED,function(t){var r=t.volume;e.volumeBoxLineIngEl.style.height=100*r+"%"})},i.prototype.bindEvent=function(){var e=this;this.volumeBtnEl.addEventListener("click",function(t){window.SOHU_MPTCFE_PLAYER.muted?(e.setVolume(1),e.sendAction(8985)):(e.setVolume(0),e.sendAction(8986))}),this.volumeBoxLineEl.addEventListener("click",function(t){var r=o.getPointerPosition(e.volumeBoxLineEl,t);e.sendAction(8987,"num: "+100*r.y+"%"),e.setVolume(r.y)}),this.handleDragVolumeBall()},i.prototype.setVolume=function(e){var t=this;this.volumeBoxLineIngEl.style.height=100*e+"%",0==e?(this.hide(this.volumeDefaultEl),this.show(this.volumeMuteEl)):(this.show(this.volumeDefaultEl),this.hide(this.volumeMuteEl)),clearTimeout(this.mousemoveTimer),this.mousemoveTimer=setTimeout(function(){t.emit(l.ACTION_EVENT_MAP.CHANGE_VOLUME,e)},50)},i.prototype.handleDragVolumeBall=function(){var e=this;this.volumeBoxLineBallEl.addEventListener("mousedown",function(t){e.isMousedownVolumeBall=!0}),document.addEventListener("mousemove",function(t){if(e.isMousedownVolumeBall){var r=o.getPointerPosition(e.mainVolumeBoxEl,t);e.setVolume(r.y)}}),document.addEventListener("mouseup",function(t){e.isMousedownVolumeBall&&(e.isMousedownVolumeBall=!1)})},i.prototype.sendAction=function(e,t){var r=this.options.spmParams&&this.options.spmParams.spm,i=(this.options.spmParams&&this.options.spmParams.clkParam)+(t?";"+t:"");window.sohuSpm&&"function"==typeof window.sohuSpm.sendAction&&window.sohuSpm.sendAction({acode:e,clkParam:i,spm:r})},i.prototype.dispose=function(){},i);t.VolumeBtn=c},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.options=e,t.el=o.createEl("div",{"class":"mptcfe-layer-conatiner"}),t.posterIns=new d.Poster(t.options),t.loaderLayerIns=new c.LoaderLayer(t.options),t.warnLayerIns=new u.WarnLayer(t.options),o.appendChildren(t.el,[t.posterIns.el,t.loaderLayerIns.el,t.warnLayerIns.el]),t.onEvent(),t.bindEvent(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=r(34),c=r(35),u=r(36),h=(s=l.Component,a(i,s),i.prototype.onEvent=function(){},i.prototype.bindEvent=function(){var e=this;this.el.addEventListener("dblclick",function(t){clearTimeout(e.clickTimer),e.emit(e.ACTION_EVENT_MAP.TOGGLE_FULLSCREEN)}),this.el.addEventListener("click",function(t){clearTimeout(e.clickTimer),e.clickTimer=setTimeout(function(){0===window.SOHU_MPTCFE_PLAYER.state?e.emit(e.ACTION_EVENT_MAP.PLAY):1===window.SOHU_MPTCFE_PLAYER.state&&e.emit(e.ACTION_EVENT_MAP.PAUSE)},300)})},i.prototype.dispose=function(){},i);t.LayerConatiner=h},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.repeatFlag=!1,t.endedClass="endedClass",t.opts=e,t.init(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=(s=l.Component,a(i,s),i.prototype.init=function(){this.el=o.createEl("div",{"class":"mptcfe-poster-logo",style:"background-image:url("+this.opts.poster+")"}),this.repeatBtn=o.createEl("span",{"class":"mptcfe-repeat-btn"},"重播"),this.isEdge()&&o.addClass(this.el,"removeFilter");var e=[];this.opts.isHiddenReplayButton||e.push(this.repeatBtn),o.appendChildren(this.el,e),this.onEvent()},i.prototype.isEdge=function(){return-1<window.navigator.userAgent.indexOf("Edge")},i.prototype.onEvent=function(){var e=this;this.on(this.ACTION_EVENT_MAP.PLAY,function(){e.hide(e.el),e.hide(e.repeatBtn),e.repeatFlag&&(e.repeatFlag=!1,e.emit(e.ACTION_EVENT_MAP.PLAY_REPEAT))}),this.on(this.ACTION_EVENT_MAP.CHANGE_PROGRESS,function(){e.hide(e.el),e.hide(e.repeatBtn),e.repeatFlag&&(e.repeatFlag=!1,e.emit(e.ACTION_EVENT_MAP.PLAY_REPEAT))}),this.on(this.VIDEO_EVENT_MAP.PLAY,function(){o.removeClass(e.el,e.endedClass),e.hide(e.el),e.hide(e.repeatBtn)}),this.on(this.VIDEO_EVENT_MAP.ENDED,function(){o.addClass(e.el,e.endedClass),e.show(e.el),e.show(e.repeatBtn),e.repeatFlag=!0})},i);t.Poster=d},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.options=e,t.el=o.createEl("div",{"class":"mptcfe-loading-layer"}),t.el.innerHTML='\n            <div class="loading-container">\n                <p>加载中...</p>\n                <div class="loading-tip">\n                    <div class="spinner1">\n                        <div class="bounce1"></div>\n                        <div class="bounce2"></div>\n                        <div class="bounce3"></div>\n                    </div>\n                </div>\n            </div>',t.onEvent(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=r(2),c=(s=l.Component,a(i,s),i.prototype.onEvent=function(){var e=this;this.on(d.VIDEO_EVENT_MAP.PLAY,function(){e.netReadyMonitor()})},i.prototype.netReadyMonitor=function(){var e=this;clearInterval(this.timer),this.timer=setInterval(function(){4!=e.options.Video.el.readyState&&1==window.SOHU_MPTCFE_PLAYER.state?e.show(e.el):e.hide(e.el)},300)},i);t.LoaderLayer=c},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.options=e,t.el=o.createEl("div",{"class":"mptcfe-warn-layer__box"}),t.errorLayerEl=o.createEl("div",{"class":"mptcfe-error-layer"}),t.errorLayerEl.innerHTML='\n            <p>视频加载失败，可以 <a data-role="reload" href="javascript:location.reload();" >刷新</a> 试试</p>\n        ',o.appendChildren(t.el,[t.errorLayerEl]),t.onEvent(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=(s=l.Component,a(i,s),i.prototype.onEvent=function(){var e=this;this.on(this.VIDEO_EVENT_MAP.ERROR,function(){e.show(e.el),e.show(e.errorLayerEl)}),this.on(this.ACTION_EVENT_MAP.PLAY,function(){e.hide(e.el),e.hide(e.errorLayerEl)})},i);t.WarnLayer=d},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.options=e,t.el=o.createEl("div",{"class":"mptcfe-nosupport__box"}),t.noSupportLayerEl=o.createEl("div",{"class":"mptcfe-nosupport-layer"}),t.noSupportLayerEl.innerHTML='\n            <p>您的浏览器不兼容此播放器，可以去下载 <a href="https://ie.sogou.com/" target="_blank">搜狗浏览器</a> 试试</p>\n        ',o.appendChildren(t.el,[t.noSupportLayerEl]),t.onEvent(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(0),l=r(1),d=(s=l.Component,a(i,s),i.prototype.onEvent=function(){var e=this;this.on(this.VIDEO_EVENT_MAP.NOT_SUPPORT_VIDEO,function(){e.show(e.el),e.show(e.noSupportLayerEl),console.log("不兼容")})},i);t.NoSupport=d},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.options=e,t.bindEvent(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(1),l=(s=o.Component,a(i,s),i.prototype.bindEvent=function(){var e=this;document.addEventListener("keydown",function(t){"Space"==t.code&&(event.preventDefault(),event.stopPropagation(),0===window.SOHU_MPTCFE_PLAYER.state?e.emit(e.ACTION_EVENT_MAP.PLAY):1===window.SOHU_MPTCFE_PLAYER.state&&e.emit(e.ACTION_EVENT_MAP.PAUSE))})},i.prototype.dispose=function(){},i);t.KeyBoard=l},function(e,t,r){"use strict";function i(e){var t=s.call(this)||this;return t.isFirstPlayFlag=!0,t.heartbeat=NaN,t.options=e,t.spmMap={play:{code:3020,firstPlayKey:"s;0",continuePlayKey:"s;1"},continuePaly:{code:8947},pauseEnd:{code:3052,pauseKey:"s:0;",endKey:"s:1"},endPlay:{code:8322},seek:{code:3053},fullscreen:{code:8984,exitFullKey:"s;1",fullKey:"s:0"},noSupport:{code:3056},error:{code:3055},heartCode:{code:3054,peroid:3e3}},t.options.spmParams&&t.onEvent(),t}var n,a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s,o=r(1),l=(s=o.Component,a(i,s),i.prototype.onEvent=function(){var e=this;this.on(this.VIDEO_EVENT_MAP.PLAY,function(){e.isFirstPlayFlag?e.sendAction(e.spmMap.play.code):e.sendAction(e.spmMap.continuePaly.code),e.isFirstPlayFlag=!1,e.heartbeatEvent()}),this.on(this.ACTION_EVENT_MAP.PAUSE,function(t){clearInterval(e.heartbeat),e.sendAction(e.spmMap.pauseEnd.code)}),this.on(this.VIDEO_EVENT_MAP.ENDED,function(t){clearInterval(e.heartbeat)}),this.on(this.ACTION_EVENT_MAP.CHANGE_PROGRESS,function(){e.sendAction(e.spmMap.seek.code,e.spmMap.pauseEnd.endKey)}),this.on(this.VIDEO_EVENT_MAP.FULLSCREEN,function(){e.sendAction(e.spmMap.fullscreen.code,e.spmMap.fullscreen.fullKey)}),this.on(this.VIDEO_EVENT_MAP.EXITFULLSCREEN,function(){e.sendAction(e.spmMap.fullscreen.code,e.spmMap.fullscreen.exitFullKey)}),this.on(this.VIDEO_EVENT_MAP.NOT_SUPPORT_VIDEO,function(){e.sendAction(e.spmMap.noSupport.code)}),this.on(this.VIDEO_EVENT_MAP.ERROR,function(t){var r=t.error;e.sendAction(e.spmMap.error.code,"code:"+r.code+";message:"+r.message+";src:"+e.options.url)}),this.on(this.VIDEO_EVENT_MAP.NINETY_PERCENTY,function(){e.sendAction(e.spmMap.endPlay.code)})},i.prototype.sendAction=function(e,t){var r=this.options.spmParams&&this.options.spmParams.spm,i=(this.options.spmParams&&this.options.spmParams.clkParam)+(t?";"+t:"");console.log("上报action: ",e,i),window.sohuSpm&&"function"==typeof window.sohuSpm.sendAction&&window.sohuSpm.sendAction({acode:e,clkParam:i,spm:r})},i.prototype.heartbeatEvent=function(){var e=this;this.heartbeat!==NaN&&clearInterval(this.heartbeat),this.heartbeat=setInterval(function(){e.sendAction(e.spmMap.heartCode.code)},this.spmMap.heartCode.peroid)},i);t.SpmActions=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(41);t.formatTime=function(e){var t=Math.floor(e);return 59<t?(9<Math.floor(t/60)?Math.floor(t/60):"0"+Math.floor(t/60))+":"+(9<t%60?t%60:"0"+t%60):"00:"+(9<t?t:"0"+t)},t.isSupportVideoType=function(e){var t=document.createElement("video");if(!t||!t.canPlayType)return!1;var r=e.url,n=i.getMimetype(r);return""!==t.canPlayType(n)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(42);t.MimetypesKind={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},t.getMimetype=function(e){void 0===e&&(e="");var r=i.getFileExtension(e);return t.MimetypesKind[r.toLowerCase()]||""}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileExtension=function(e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(e);return t?t.pop().toLowerCase():""}}],e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:i})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var n in t)e.d(i,n,function(e){return t[e]}.bind(null,n));return i},e.n=function(t){var r=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(r,"a",r),r},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=3);var t,r})},function(e,t){e.exports='<div class="insert-rec insert-shop-card shop-house <%=expiredClass%>" >  \n    <a href="javascript:void(0);" class="insert-box" data-spm-data="h" data-spm-content="<%=dataSpmContent%>">\n        <div class="img-box img-do">\n            <img class="insert-article__img" data-src="<%=image%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="配图">\n        </div>\n        <div class="insert-content">\n            <h5 class="insert-rec__title"><%=title%></h5>\n            <div class="footer">\n                <% if (p1) {%>\n                    <p><%=p1%></p>\n                <% } %>\n\n                <% if (p2) {%>\n                    <p><%=p2%></p>\n                <% } %>\n\n                <% if (p3) {%>\n                    <p><%=p3%></p>\n                <% } %>\n            </div>\n        </div>\n\n        <div style="clear: both;"></div>\n        <div class="shop-house-opare">\n            <div class="input-box name-input-box">\n                <span class="col-title">姓名</span>\n                <input class="col-input" type="text" placeholder="请输入姓名"/>\n            </div>\n            <div class="input-box telephone-input-box">\n                <span class="col-title">手机</span>\n                <input class="col-input" type="text"  maxlength="11" placeholder="请输入手机号"/>\n            </div>\n            <div class="input-box code-input-box">\n                <span class="col-title">验证码</span>\n                <input class="col-input" type="text" placeholder="请输入验证码" maxlength="6" />\n                <span class="get-code-btn"><span class="btn-text">获取验证码</span></span>\n            </div>\n        </div>\n\n        <span class="error-tip">请输入姓名</span>\n\n        <%if(isOverdue) { %>\n            <div class="insert-btn enroll-btn enroll-btn-done fixPosition">报名结束</div>\n        <%} else { %>\n            <div class="insert-btn enroll-btn show-enroll-btn fixPosition">立即报名</div>\n        <% } %>\n        \n    </a>\n    <div style="clear: both"></div>\n\n    <div class="dialog-tip">报名成功</div>\n    <% if (accountName && avatar) {%>\n    <div class="rec">\n        <div class="rec-avator"><img src="<%= avatar %>"/></div>\n        <div class="rec-text"><%= accountName %>推荐</div>\n        <% if (status === 4 || status === 3) {%>\n        <div class="rec-expired-tag">已失效</div>\n        <% } %>\n    </div>\n    <%}%>\n</div>'},function(e,t){e.exports='<div class="insert-rec insert-shop-card shop-telephone <%=expiredClass%>">  \n    <a href="javascript:void(0);" class="insert-box" data-spm-data="t" data-spm-content="<%=dataSpmContent%>">\n        <div class="img-box img-do">\n            <img class="insert-article__img" data-src="<%=image%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="配图">\n        </div>\n        <div class="insert-content">\n            <h5 class="insert-rec__title"><%=title%></h5>\n            <div class="footer">\n                <% if (p1) {%>\n                    <p><%=p1%></p>\n                <% } %>\n                <% if (p2) {%>\n                    <p><%=p2%></p>\n                <% } %>\n\n                <% if (price) {%>\n                    <p class="price-number"><%=price%></p>\n                <% } %>\n            </div>\n        </div>\n\n        <div class="insert-btn telphone">\n            <i class="telephone-icon"></i>\n            <%=phoneNum%><% if (extPhoneNum) {%> 转 <%=extPhoneNum%> <% } %></div>\n    <div style="clear: both;"></div>\n    </a>\n    <% if (accountName && avatar) {%>\n    <div class="rec">\n        <div class="rec-avator"><img src="<%= avatar %>"/></div>\n        <div class="rec-text"><%= accountName %>推荐</div>\n        <% if (status === 4 || status === 3) {%>\n        <div class="rec-expired-tag">已失效</div>\n        <% } %>\n    </div>\n    <%}%>\n</div>'},function(e,t){e.exports='<div class="insert-rec insert-shop-card shop-house <%=expiredClass%>" >\n    <a href="<%=linkUrl %>" class="insert-box sendAction" data-spm-data="g" data-spm-content="<%=dataSpmContent%>" target="_blank" data-acode = "8890">\n        <div class="img-box img-do">\n            <img class="insert-article__img" data-src="<%=image%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="配图">\n        </div>\n        <div class="insert-content">\n            <h5 class="insert-rec__title"><%=title%></h5>\n            <div class="external-footer fixMargin">\n                <%=desc%>\n            </div>\n        </div>\n        <%if(btnText) { %>\n            <div class="insert-btn"><%=btnText%></div>\n        <%}%>\n        \n    </a>\n    <% if (accountName && avatar) {%>\n    <div class="rec">\n        <div class="rec-avator"><img src="<%= avatar %>"/></div>\n        <div class="rec-text"><%= accountName %>推荐</div>\n        <% if (status === 4 || status === 3) {%>\n        <div class="rec-expired-tag">已失效</div>\n        <% } %>\n    </div>\n    <%}%>\n</div>'},function(e,t){e.exports='<div class="insert-rec insert-shop-card <%=expiredClass%>" >  \n    <a href="<%=linkUrl %>" class="insert-box sendAction padding-zero" data-spm-data="p" data-spm-content="<%=dataSpmContent%>" target="_blank" data-acode = "8886">\n        <div class="external-poster">\n            <% if(type === 35) { %>\n                <div class="text-detail border-bottom-zero">\n                    <h5 class="title"><%=title%></h5>\n                    <% if (desc) {%>\n                        <div class="content">\n                            <%=desc%>\n                        </div>\n                    <% } %>\n                    <%if(btnText) { %>\n                        <div class="insert-btn-fix fix-position"><%= btnText %></div>\n                    <%}%>\n                </div>\n                <img data-src="<%=image%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="配图" class="cover">\n            <% } else { %>\n                <img data-src="<%=image%>" src="//statics.itc.cn/web/static/images/pic/preload.png" alt="配图" class="cover">\n                <div class="text-detail border-top-zero">\n                    <h5 class="title"><%=title%></h5>\n                    <% if (desc) {%>\n                        <div class="content">\n                            <%=desc%>\n                        </div>\n                    <% } %>\n                    <%if(btnText) { %>\n                        <div class="insert-btn-fix fix-position"><%= btnText %></div>\n                    <%}%>\n                </div>\n            <% } %>\n        </div>\n    </a>\n    <% if (accountName && avatar) {%>\n    <div class="rec">\n        <div class="rec-avator"><img src="<%= avatar %>"/></div>\n        <div class="rec-text"><%= accountName %>推荐</div>\n        <% if (status === 4 || status === 3) {%>\n        <div class="rec-expired-tag">已失效</div>\n        <% } %>\n    </div>\n    <%}%>\n</div>'},function(e,t){e.exports='<div class="insert-rec insert-shop-card <%=expiredClass%>" >  \n    <a href="<%=linkUrl%>" class="insert-box sendAction padding-zero" data-spm-data="v" data-spm-content="<%=dataSpmContent%>" target="_blank" data-acode = "8888">\n        <div class="external-video">\n            <% if(type === 37) { %>\n                <div class="video-detail border-bottom-zero">\n                    <% if (title) {%>\n                        <h5 class="title"><%=title%></h5>\n                    <% } %>\n                    <% if (desc) {%>\n                        <div class="content">\n                            <%=desc%>\n                        </div>\n                    <% } %>\n                    <%if(btnText) { %>\n                        <div class="insert-btn-fix fix-position"><%=btnText%></div>\n                    <%}%>\n                </div>\n                <div class="sohu-video-container">\n                    <img src="<%=image%>" class="bg-video play-video" class="play-logo play-video" data-videoUrl="<%=videoUrl%>"/>\n                    <div class="play-logo play-video" data-videoUrl="<%=videoUrl%>"/>\n                </div>\n            <% } else if(type === 38) { %>\n                <div class="sohu-video-container">\n                    <img src="<%=image%>" class="bg-video play-video" class="play-logo play-video" data-videoUrl="<%=videoUrl%>"/>\n                    <div class="play-logo play-video" data-videoUrl="<%=videoUrl%>"/>\n                </div>\n                <div class="video-detail border-top-zero">\n                    <% if (title) {%>\n                        <h5 class="title"><%=title%></h5>\n                    <% } %>\n                    <% if (desc) {%>\n                        <div class="content">\n                            <%=desc%>\n                        </div>\n                    <% } %>\n                    <%if(btnText) { %>\n                        <div class="insert-btn-fix fix-position"><%=btnText%></div>\n                    <%}%>\n                </div>\n            <% } else { %>\n                <div class="sohu-video-container">\n                    <img src="<%=image%>" class="bg-video play-video" class="play-logo play-video" data-videoUrl="<%=videoUrl%>"/>\n                    <div class="play-logo play-video" data-videoUrl="<%=videoUrl%>"/>\n                </div>\n            <% } %>\n        </div>\n    </a>\n    <% if (accountName && avatar) {%>\n    <div class="rec rec-widthFix">\n        <div class="rec-avator"><img src="<%= avatar %>"/></div>\n        <div class="rec-text"><%= accountName %>推荐</div>\n        <% if (status === 4 || status === 3) {%>\n        <div class="rec-expired-tag">已失效</div>\n        <% } %>\n    </div>\n    <%}%>\n</div>'}]);